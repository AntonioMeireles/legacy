#
# Copyright (c) 2004-2006 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('rpmpackage')
class Setarch(RPMPackageRecipe, CPackageRecipe):
    name = 'setarch'
    version = '2.0'
    rpmRelease = '1.1'

    def setup(r):
        r.unpack()
        r.Run('%(cc)s -o setarch setarch.c %(mflags)s')

        r.MakeDirs('%(bindir)s', '%(mandir)s/man8')
        r.Install('setarch.8', '%(mandir)s/man8/')
        r.Install('setarch', '%(bindir)s/', mode=0755)
        links= [ 'linux32' ]
        if Arch.x86:
            links.append('i386')
        if Arch.x86_64:
            links.append('x86_64')

        for link in links:
            r.Symlink('setarch', '%(bindir)s/' + link)
            r.Symlink('setarch.8', '%(mandir)s/man8/'+ link + '.8', )
