#
# Copyright (c) 2004-2009 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('kdecorepackage')
class kdePIMLibs(kdeCorePackageRecipe):

    name = 'kdepimlibs'
    version = '4.4.4+r1135935'

    buildRequires = [
        'akonadi:devel', 'automoc:runtime', 'boost:devel', 'cyrus-sasl:devel',
        'dbus:devel', 'gpgme:devel', 'libgpg-error:devel', 'libical:devel',
        'libstdc++:devel', 'libxml2:runtime', 'openldap:devel'
    ]

    clearBuildReqs('kdepimlibs:devel')

    def postUnpack(r):

        r.addPatches(
            '03_hide_akonadi_progressbar.diff',
            'kubuntu_03_disable_doc.diff',
        )

    def policy(r):

        # Need it to make SASL logins work (kmail, etc)
        for c in ('gssapi', 'md5', 'plain'):
            r.Requires('cyrus-sasl:%s' % c, '%(libdir)s/libkpimutils.so.4')

