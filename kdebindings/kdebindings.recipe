#
# Copyright (c) 2004-2009 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('kdecorepackage')
class kdeBindings(kdeCorePackageRecipe):

    name = 'kdebindings'
    version = '4.3.0+r1006386'

    buildRequires = [
        'akonadi:devel', 'dbus-python:python', 'mono:cil', 'mono:devel',
        'mono:runtime', 'okular:devel', 'polkit-qt:devel', 'PyQt4:python',
        'python:devel', 'qimageblitz:devel', 'QScintilla2:devel',
        'QScintilla2:python', 'ruby:devellib', 'ruby:runtime', 'sip:devel',
        'sip:runtime', 'soprano:devel'
    ]

    modules = [
        ('smoke-qt',
            'smoke/qt',
            'smoke/qsci',
            'smoke/qtscript',
            'smoke/qttest',
            'smoke/qtuitools',
            'smoke/qtwebkit'),
        ('smoke-kde',
            'smoke'),
        ('pykde',
            'python/pykde4'),
        ('kross-python',
            'python/krosspython'),
        ('qyoto',
            'csharp/qyoto',
            'csharp/qtscript',
            'csharp/qttest',
            'csharp/qtuitools',
            'csharp/qtwebkit'),
        ('kimono',
            'csharp'),
        ('qtruby',
            'ruby/qtruby',
            'ruby/qtscript',
            'ruby/qttest',
            'ruby/qtuitools',
            'ruby/qtwebkit'),
        ('kross-ruby',
            'ruby/krossruby'),
        ('korundum',
            'ruby'),
    ]

    def postUnpack(r):

        # Ubuntu patches
        #r.addUbuntuPatches('k/kdebindings',
        #    'kubuntu_03_skip_nepomuk.patch',
        #)

        # installs into %(destdir)s/%(builddir)s
        r.Replace('add_subdirectory. examples .', '', 'csharp/plasma/CMakeLists.txt')

        # instals as %(bindir)s/pykdeuic4/pykdeuic4.{py,pyc}
        r.Replace(
            'PYTHON_INSTALL.pykdeuic4.py ..BIN_INSTALL_DIR./pykdeuic4.',
            'install(PROGRAMS pykdeuic4.py DESTINATION ${BIN_INSTALL_DIR} RENAME pykdeuic4 )',
            'python/pykde4/tools/pykdeuic4/CMakeLists.txt'
        )
        # disable soprano
        #r.Replace('macro_optional_find_package.Soprano.', '', 'CMakeLists.txt')
        #r.Replace('add_subdirectory.soprano.', '', 'smoke/CMakeLists.txt')
        #r.Replace('add_subdirectory. soprano .', '', 'ruby/CMakeLists.txt')
        #r.Replace('ADD_SUBDIRECTORY.soprano.', '', 'csharp/CMakeLists.txt')

        #r.Replace('add_subdirectory. nepomuk .', '', 'ruby/CMakeLists.txt')

