#
# Copyright (c) 2004-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Devlabel(CPackageRecipe):
    name = 'devlabel'
    version = '0.48.01'

    buildRequires = [ 'e2fsprogs:devel' ]

    def setup(r):
        r.addArchive('http://linux.dell.com/devlabel/', keyid='23B66A9D')

        # devlabel doesn't include a Makefile (!!!)
        r.Make('scsi_unique_id')
        r.Make('partition_uuid LDLIBS=-luuid')
        r.Install('devlabel', '%(essentialsbindir)s/', mode=0755)
        r.Install('scsi_unique_id', 'partition_uuid',
                  '%(bindir)s/', mode=0755)
        r.Install('devlabel.8*', '%(mandir)s/man8/', mode=0644)
        r.Install('sysconfig.devlabel', '%(sysconfdir)s/sysconfig/devlabel',
                  mode=0644)
        r.Install('ignore_list',
                  '%(sysconfdir)s/sysconfig/devlabel.d/ignore_list', mode=0644)
        r.Install('ignore_list',
                  '%(sysconfdir)s/sysconfig/devlabel.d/proc_partitions',
                  mode=0644)
