#
# Copyright (c) 2009 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('kdepackage')
class Synapse(kdePackageRecipe):

    name = 'synapse'
    version = '0.1+r359'

    buildRequires = [
        'autoconf:runtime', 'automake:runtime', 'gtk-sharp:cil',
        'gtk-sharp:devellib', 'libtool:runtime', 'mono-addins:devellib',
        'mono:cil', 'mono:devel', 'ndesk-dbus-glib:cil',
        'ndesk-dbus-glib:devellib', 'notify-sharp:cil', 'notify-sharp:devellib',
        'qyoto:cil', 'qyoto:devel'
    ]

    def unpack(r):

        r.addGitSnapshot('git://github.com/FireRabbit/synapse.git')

        r.Replace('/pixmaps', '/icons/hicolor/64x64/apps', 'Makefile.am')

        r.Remove('src/Synapse.Services/synapse-services.pc.in')
        r.Replace('@expanded_libdir@', '%(prefix)s/lib', 'src/*/*.pc.in')

    def build(r):

        r.Configure(' --libdir=%(prefix)s/lib ', configureName='autogen.sh')

        r.Make()

        r.MakeInstall()

    def policy(r):

        r.NormalizePkgConfig(exceptions='/')
        r.ComponentSpec('mono', '%(prefix)s/lib/')

