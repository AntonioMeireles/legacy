#
# Copyright (c) 2004 Specifix, Inc.
# All rights reserved
#

loadRecipe('gnomepackage.recipe')
class GConf(GnomePackageRecipe):
    
    buildRequires = [ 'libxml2:devel', 'ORBit2:devel', 'glib:devel',
                      'gtk:devel', 'pkgconfig:runtime', 'gettext:runtime' ]
                      
    name = 'GConf'
    version = '2.9.91'
    
    docs = ['COPYING', 'ChangeLog', 'NEWS', 'README']

    def setup(r):
        r.disableParallelMake()
        GnomePackageRecipe.setup(r)

    def install(r):
        GnomePackageRecipe.install(r)
        r.ComponentSpec('runtime', '%(libdir)s/GConf/2/.*\\.so')
        r.ComponentSpec('lib',
            '%(sysconfdir)s/gconf/2/path',
            '%(sysconfdir)s/gconf/gconf.xml.mandatory',
            '%(sysconfdir)s/gconf/gconf.xml.defaults')
	r.ExcludeDirectories(exceptions='%(sysconfdir)s/gconf/gconf.xml.*')
	r.addSource('gconf2schema.tagdescription', macros=True)
	r.addSource('gconf2schema.taghandler')
	r.Install('gconf2schema.tagdescription',
		  '%(tagdescriptiondir)s/gconf2schema')
	r.Install('gconf2schema.taghandler',
		  '%(taghandlerdir)s/gconf2schema', mode=0755)

	# this just makes the testgconf program
	r.Make('check', subDir='tests')
	r.TestSuiteFiles('testgconf')
	r.TestSuite('tests', './testgconf') 
