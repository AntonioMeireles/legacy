#
# Copyright (c) 2006-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadInstalled('icedtea')
class Ant(PackageRecipe):

    name = 'ant'
    version = '1.7.1'

    buildRequires = [
        'icedtea-jdk:runtime', 'perl:runtime'
    ]

    def setup(r):

        r.addArchive(
            'http://www.apache.org/dist'
            '/ant/source/apache-ant-%(version)s-src.tar.bz2'
        )

        r.Replace('depends=\"jars,test-jar\"', 'depends="jars"', 'build.xml')

        r.Run(' ./build.sh')

        # Useless
        r.Remove('dist/bin/*.{bat,cmd}')

        # Already has it
        r.Remove('dist/lib/xercesImpl.jar')
        # XXX:We need to package this probably
        #r.Remove('dist/lib/xml-apis.jar')

        r.Install('dist/bin/*', '%(bindir)s/')

        # %(bindir)s/* expects jars to be in ANT_HOME/lib
        r.Install('dist/lib/*.jar', '%(prefix)s/lib/')

