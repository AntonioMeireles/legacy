#
# Copyright (c) 2007-2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class ConsoleKit(AutoPackageRecipe):
    name = 'ConsoleKit'
    version = '0.2.6'

    buildRequires = [ 'chkconfig:runtime', 'dbus-glib:devel', 'dbus:devel',
        'glib:devel', 'libX11:devel', 'libXau:devel', 'libXdmcp:devel',
        'libxcb:devel', 'pkgconfig:devel', 'xmlto:runtime', 'pam:devel',
        'dbus:devellib', 'PolicyKit:devel', 'zlib:devel' ]

    def unpack(r):
        r.addArchive('http://people.freedesktop.org/~mccann/dist/')

    def configure(r):
         r.Configure('--with-pid-file=%(localstatedir)s/run/'
                     'console-kit-daemon.pid --enable-pam-module '
                     '--with-pam-module-dir=/%(lib)s/security')

    def policy(r):
        # get around missing trailing newsline
        r.Run('echo >> %(destdir)s/%(sysconfdir)s/ConsoleKit/seats.d/'
              '00-primary.seat')
