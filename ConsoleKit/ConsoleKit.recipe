#
# Copyright (c) 2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('rpmpackage')
class ConsoleKit(RPMPackageRecipe,AutoPackageRecipe):
    name = 'ConsoleKit'
    version = '0.2.3'
    rpmRelease = '2.fc9'
    buildRequires = ['chkconfig:runtime', 'dbus-glib:devel', 'dbus:devel', 'glib:devel', 'libX11:devel', 'libXau:devel', 'libXdmcp:devel', 'libxcb:devel', 'pkgconfig:devel', 'xmlto:runtime', 'pam:devel', 'dbus:devellib']
    rpmPatches = ['ConsoleKit-0.2.1-lsb.patch']


    def configure(r):
         r.Configure(' --with-pid-file=%(localstatedir)s/run/console-kit-daemon.pid --enable-pam-module --with-pam-module-dir=/%(lib)s/security')

    def policy(r):
        # get around missing trailing newsline
        r.Run(""" echo >> %(destdir)s/%(sysconfdir)s/ConsoleKit/seats.d/00-primary.seat""")
