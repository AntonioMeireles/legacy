#
# Copyright (c) 2004-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class dnsmasq(CPackageRecipe):
    name = 'dnsmasq'
    version = '2.38'

    def setup(r):
        r.addArchive('http://www.thekelleys.org.uk/%(name)s/')
        # Starts before sendmail & rmake but after openvpn.
        r.addSource('dnsmasq.init', dest='%(initdir)s/dnsmasq', mode=0755)

        r.Make()
        #Make install doesn't work quite right, so, since there are only a
        #handful of files, install them here
        r.Install('src/dnsmasq', '%(sbindir)s/', mode=0755)
        r.Install('man/dnsmasq.8', '%(mandir)s/man8/', mode=0644)
        r.Install('dnsmasq.conf.example', '%(sysconfdir)s/dnsmasq.conf',
                  mode=0644)
        r.Install('contrib/openvpn/dhclient-enter-hooks', '%(sysconfdir)s/',
                  mode=0644)
        r.TagSpec('initscript', '%(initdir)s/')
