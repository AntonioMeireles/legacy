#
# Copyright (c) 2004-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Valgrind(AutoPackageRecipe):
    name = 'valgrind'
    version = '3.3.0'

    buildRequires = ['gdb:runtime', 'perl:runtime', 'perl:lib']

    def unpack(r):
        r.addArchive('http://valgrind.org/downloads/')

    def policy(r):
        r.Strip(exceptions='%(libdir)s/valgrind/stage2')
        # this flavor exception should NOT be changed to %(libdir)s
        # because we explicitly do not want it to apply on 32-bit
        # builds.  These files don't really create a requirement;
        # they merely enable a capability if a requirement for
        # 32-bit libraries is fulfilled elsewhere.  On x86_64, at
        # least, this is a multi-arch *capable* trove that does
        # not itself *require* a multi-arch system.
        r.Flavor(exceptions='/usr/lib64/valgrind/x86-linux/')
