loadRecipe('bluezpkg.recipe', label='conary.rpath.com@rpl:devel')
class BluezUtils(BluezPkg):
    buildRequires = ['bluez-libs:devel','bison:runtime', 'chkconfig:runtime', 'dbus:devel', 'expat:devel', 'flex:runtime', 'libusb:devel', 'pkgconfig:devel']

    name = 'bluez-utils'
    version = '3.11'

    sources = ['bluetooth',
               'pand',
               'dund',
               'hidd']

    extraConfig = BluezPkg.extraConfig + (' --enable-dbus'
                                          ' --enable-cups'
                                          ' --enable-hid2hci'
                                          ' --enable-pcmcia'
                                          ' --enable-pie'
                                          ' --enable-debug')

    def unpack(r):
        BluezPkg.unpack(r)

        srpm = 'http://download.fedora.redhat.com/pub/fedora/linux/core/development/source/SRPMS/%(name)s-2.25-12.src.rpm'
        for src in r.sources:
            r.addSource('%s.init' % src, rpm=srpm)
            r.addSource('%s.conf' % src, rpm=srpm)

    def install(r):
        BluezPkg.install(r)

        r.MakeDirs('%(sysconfdir)s/init.d')
        r.MakeDirs('%(sysconfdir)s/sysconfig')
        for src in r.sources:
            r.Install('%s.init' % src, '%(sysconfdir)s/init.d/' + src, mode=0755)
            r.Install('%s.conf' % src, '%(sysconfdir)s/sysconfig/' + src, mode=0644)


