#
# Copyright (c) 2004 Specifix, Inc.
# All rights reserved
#
# FIXME make sure builddocs = True buildRequires is complete
# FIXME I brute-force-disabled builddocs here because something doesn't
#       seem to parse properly when building docs
#
# Search for GIL for current gil changes -
# GIL in a commented line usually means that line has just been removed

class Hal(PackageRecipe):
    buildRequires = [ 'expat:devel', 'glib:devel', 'dbus:devel', 
                      'hwdata:runtime', 'libcap:devel', 'popt:devel',
		      'dbus-glib:devellib', 'glibc:devel', 'libusb:devel' ]

    extraConfig = '--disable-docbook-docs --enable-hotplug-map --with-init-scripts=redhat --with-os-type=redhat --with-pid-file=%(localstatedir)s/run/haldaemon.pid --enable-sysfs-carrier --with-backend=linux2'
    
    extraConfig += '  --with-hal-user=root   --with-hal-group=root' 
    #workaround solong the conary group / user support is broken. Otherway the dbus will not start

    name = 'hal'
    version = '0.5.6'

    def setup(r):
	r.addArchive('http://freedesktop.org/~david/dist/%(name)s-%(version)s.tar.gz')
        r.addAction("sed -i '/# chkconfig:/s/ 98/ 09/g' hald/haldaemon.in")
        r.Configure(r.extraConfig)
        r.Make()
	r.MakeInstall()
	r.PackageSpec('hal-gnome', '%(datadir)s/%(name)s/device-manager/',
				'%(bindir)s/hal-device-manager')
	r.TagSpec('initscript', '%(initdir)s/')
