#
# Copyright (c) 2004-2008 rPath, Inc.
# Modified 2011 Foresightlinux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadRecipe('gnomepackage')
class LibSoup(GnomePackageRecipe):
    buildRequires = [ 'glib:devel', 'pkgconfig:devel', 'libxml2:devel',
                      'curl:runtime', 'gnutls:devel', 'libgcrypt:devel',
                      'libgpg-error:devel', 'httpd:runtime', 'libproxy:devel', 
                      'sqlite:devel', 'GConf:devel', 'libgnome-keyring:devel',
                      'gobject-introspection:devel']

    name = 'libsoup'
    version = '2.34.2'

    extraConfig = ' --disable-tls-check '
    docs =  ['README', 'COPYING', 'NEWS',
        'AUTHORS', ]
    patches = ['enable_tls.patch', 'fix_some_memory_leaks.patch',
               'always_send_keep_alive.patch',
               'deal_with_broken_apache_content_encoding.patch']

    def unpack(r):
        GnomePackageRecipe.unpack(r)
        r.Run('autoreconf -fi')

    def policy(r):
        r.Requires('glib-networking:lib', '%(libdir)s/libsoup-gnome-2.4.so.1')
