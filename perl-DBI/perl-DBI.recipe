# Copyright (c) 2004-2006 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('cpanpackage.recipe')
class PerlDBI(CPANPackageRecipe, CPackageRecipe):
    name = 'perl-DBI'
    version = '1.53'
    # Never add perl-DBD-MySQL or perl-DBD-Pg as build reqs,
    # because doing so creates a build dependency loop
    buildRequires = [ 'glibc:devel', ]

    def post(r):
        # we need to avoid a build loop by replacing automatic
        # perl dependencies with trove dependencies
        r.Requires(exceptDeps='perl: DBD::(mysql|Pg)')
        for trove in ('perl-DBD-MySQL:perl', 'perl-DBD-Pg:perl'):
            r.Requires(trove, '\*.pm')
