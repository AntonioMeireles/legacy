#
# Copyright (c) 2004-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadInstalled('python')
loadSuperClass('rpmpackage')
class Kudzu(RPMPackageRecipe, CPackageRecipe):
    name = 'kudzu'
    version = '1.2.79'
    rpmRelease = '1'
    distroVersion = '8'

    buildRequires = [ 'newt:devel', 'gettext:runtime', 'pciutils:devel',
        'python:devel', 'popt:devel', 'zlib:devel', ]

    def setup(r):
        r.pyver = Python.majversion
        r.unpack()
        r.addPatch('kudzu-python-version.patch')
        r.addAction("sed -i '/# chkconfig:/s/ 05/ 03/g' kudzu.init")

        r.Remove('po/kudzu.pot')
        r.Make('RPM_OPT_FLAGS="%(cflags)s -I." all kudzu')
        r.MakeInstall('install-program libdir=%(destdir)s/%(libdir)s')
        r.Move('/etc/rc.d/init.d/kudzu', '%(initdir)s/')
        r.TagSpec('initscript', '%(initdir)s/')
