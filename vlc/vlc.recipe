# vim:set ts=4 sw=4 et:
#
# Copyright (c) 2009 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class vlc(AutoPackageRecipe):
    buildRequires = [ 'GConf:devel',
                      'ORBit2:devel',
                      'SDL:devel',
                      'SDL_image:devel',
                      'aalib:devel',
                      'alsa-lib:devel',
                      'avahi:devel',
                      'dbus:devel',
                      'desktop-file-utils:runtime',
                      'faac:devel',
                      'faad2:devel',
                      'ffmpeg:devel',
                      'fluidsynth:devel',
                      'freetype:devel',
                      'fribidi:devel',
                      'glib:devel',
                      'gnome-vfs:devel',
                      'gnutls:devel',
                      'gsm:devel',
                      'hal:devel',
                      'lame:devel',
                      'libICE:devel',
                      'libSM:devel',
                      'libX11:devel',
                      'libXext:devel',
                      'libXinerama:devel',
                      'libXpm:devel',
                      'libXv:devel',
                      'libXxf86vm:devel',
                      'libgcrypt:devel',
                      'libgpg-error:devel',
                      'libjpeg:devel',
                      'libmad:devel',
                      'libmodplug:devel',
                      'libogg:devel',
                      'libpng:devel',
                      'libstdc++:devel',
                      'libtheora:devel',
                      'libtiff:devel',
                      'libupnp:devel',
                      'libva:devel',
                      'libvorbis:devel',
                      'libxml2:devel',
                      'pkgconfig:devel',
                      'samba-client:lib',
                      'sysfsutils:devel',
                      'wxGTK:devel',
                      'x264:devel', 
                      'xvidcore:devel',
                      'zlib:devel',
                      'libdvdnav:devel',
                      'libdvdread:devel',
                      'libavc1394:devel',
                      'libavc1394:devellib',
                      'libdvdcss:devel',
                      'libdvdcss:devellib',
                      'mpeg2dec:devel',
                      'mpeg2dec:devellib',
                      'ncurses:devel',
                      'gettext:devel',
                      'gettext:runtime',
                      'intltool:runtime',
                      'Mesa:devel',
                      'samba:devel',
                      'dbus-glib:devel',
                      'libXi:devel',
                      'libXrandr:devel',
                      'libnotify:devel',
                      'pulseaudio:devel',
                      'qt4-core:lib',
                      'qt4-gui:lib',
                      'qt4:devel',
                      'taglib:devel',
                      'flac:devel',
                      'speex:devel',
                      'twolame:devel',
                      'xcb-util:devel',
                      'a52dec:devel', 
                      'libcaca:devel', 
                      'libcddb:devel', 
                      'libdca:devel', 
                      'libdvbpsi:devel',
                      'libkate:devel', 
                      'libmpcdec:devel', 
                      'libmtp:devel', 
                      'liboil:devel', 
                      'librsvg:devel', 
                      'libshout:devel', 
                      'libusb:devel', 
                      'lua:devel', 
                      'lua:runtime', 
                      'portaudio:devel', 
                      'schroedinger:devel',
                      'autoconf:runtime',
                      'automake:runtime',
                      'libtool:runtime',
                      'libtool:devel',
                      'net-tools:runtime',
                      'libcdio:devel',
                      'udev:devel',
                      'libv4l:devel',
                      'xulrunner:devel',
                      'lua:runtime',
                      'xulrunner:devel'
                     ]

    name = "vlc"
    version = "1.1.10"

    packageSummary = 'VLC media player is a highly portable multimedia player'
    packageDescription = 'VLC media player is a highly portable multimedia player supporting most audio and video formats (H.264, Ogg, DivX, MKV, TS, MPEG-2, mp3, MPEG-4, aac, ...) from files, physical media (DVDs, VCD, Audio-CD), TV capture cards and many network streaming protocols.'

    def unpack(r):
        r.addArchive('http://download.videolan.org/pub/videolan/%(name)s/%(version)s/')
    #r.Replace('Werror', ' ', 'configure.ac')
    def configure(r):
        r.Run('rm aclocal.m4 m4/lib*.m4 m4/lt*.m4 ; ./bootstrap')
        r.macros.cflags += ' -L%(libdir)s/xorg.mesa.3d'
        r.Configure(' --disable-rpath ' 
                    ' --enable-a52 --disable-dbus --enable-telepathy --enable-run-as-root '
                    ' --enable-pulse --enable-glx --enable-opengl --enable-dvdread --enable-dvdnav '
                    ' --enable-dv --enable-faad  --enable-notify --enable-gnomevfs '
                    ' --enable-libcdio --enable-ffmpeg --enable-ogg --enable-mkv --enable-mod '
                    ' --enable-mad --enable-flac --enable-vorbis --enable-libmpeg2 --enable-x264 --enable-libva'
                    ' --with-ffmpeg-faac --with-ffmpeg-vorbis --with-ffmpeg-mp3lame '
                    ' --with-ffmpeg-theora --enable-libtar --enable-nls --enable-mozilla'
                    )
        r.Environment('LIBTOOL', '%(bindir)s/libtool')

    def policy(r):
        r.addSource('vlc.png')
        r.Install('vlc.png', '%(datadir)s/pixmaps/vlc.png')
