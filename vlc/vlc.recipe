# vim:set ts=4 sw=4 et:
#
# Copyright (c) 2009 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class vlc(AutoPackageRecipe):
    buildRequires = ['hal:devel', 'dbus:devel', 'lame:devel', 'libjpeg:devel',
                     'dbus-glib:devel', 'gettext:runtime', 'libdvdread:devel',
                     'libdca:devel', 'libgpg-error:devel', 'libmodplug:devel',
                     'samba:devel', 'gsm:devel', 'libSM:devel', 'libXi:devel',
                     'libvorbis:devel', 'libdvdcss:devel', 'libtool:runtime',
                     'autoconf:runtime', 'libmpcdec:devel', 'libxml2:devel',
                     'freetype:devel', 'mpeg2dec:devellib', 'libtiff:devel',
                     'schroedinger:devel', 'twolame:devel', 'qt4-core:lib',
                     'libcdio:devel', 'fribidi:devel', 'libavc1394:devel',
                     'libXxf86vm:devel', 'a52dec:devel', 'xcb-util:devel',
                     'libtool:devel', 'avahi:devel', 'net-tools:runtime',
                     'libcddb:devel', 'pulseaudio:devel', 'ffmpeg:devel',
                     'intltool:runtime', 'automake:runtime', 'SDL:devel',
                     'gnome-vfs:devel', 'libkate:devel', 'gnutls:devel',
                     'speex:devel', 'zlib:devel', 'libavc1394:devellib',
                     'libshout:devel', 'wxGTK:devel', 'libdvdnav:devel',
                     'sysfsutils:devel', 'qt4:devel', 'xulrunner:devel',
                     'libXv:devel', 'libXinerama:devel', 'libXpm:devel',
                     'libXrandr:devel', 'xulrunner:devel', 'x264:devel',
                     'samba-client:lib', 'liboil:devel', 'libpng:devel',
                     'portaudio:devel', 'libusb:devel', 'libmtp:devel',
                     'ncurses:devel', 'alsa-lib:devel', 'libv4l:devel',
                     'libdvdcss:devellib', 'glib:devel', 'lua:runtime',
                     'libgcrypt:devel', 'qt4-gui:lib', 'libcaca:devel',
                     'taglib:devel', 'libogg:devel', 'pkgconfig:devel',
                     'libICE:devel', 'GConf:devel', 'libnotify:devel',
                     'aalib:devel', 'SDL_image:devel', 'libX11:devel',
                     'xvidcore:devel', 'libstdc++:devel', 'lua:devel',
                     'faac:devel', 'libtheora:devel', 'libupnp:devel',
                     'ORBit2:devel', 'flac:devel', 'fluidsynth:devel',
                     'libdvbpsi:devel', 'hal:devel', 'librsvg:devel',
                     'Mesa:devel', 'mpeg2dec:devel', 'libXext:devel',
                     'libmad:devel', 'gettext:devel', 'udev:devel',
                     'lua:runtime', 'live555:devel', 'libva:devel',
                     'faad2:devel', 'desktop-file-utils:runtime']
    name = "vlc"
    version = "1.1.11"

    packageSummary = 'VLC media player is a highly portable multimedia player'
    packageDescription = 'VLC media player is a highly portable multimedia player supporting most audio and video formats (H.264, Ogg, DivX, MKV, TS, MPEG-2, mp3, MPEG-4, aac, ...) from files, physical media (DVDs, VCD, Audio-CD), TV capture cards and many network streaming protocols.'

    def unpack(r):
        r.addArchive('http://download.videolan.org/pub/videolan/%(name)s/%(version)s/')
    #r.Replace('Werror', ' ', 'configure.ac')
    def configure(r):
        r.Run('rm aclocal.m4 m4/lib*.m4 m4/lt*.m4 ; ./bootstrap')
        r.macros.cflags += ' -L%(libdir)s/xorg.mesa.3d'
        r.Configure(' --disable-rpath ' 
                    ' --enable-a52 --disable-dbus --enable-telepathy --enable-run-as-root '
                    ' --enable-pulse --enable-glx --enable-opengl --enable-dvdread --enable-dvdnav '
                    ' --enable-dv --enable-faad  --enable-notify --enable-gnomevfs '
                    ' --enable-libcdio --enable-ffmpeg --enable-ogg --enable-mkv --enable-mod '
                    ' --enable-mad --enable-flac --enable-vorbis --enable-libmpeg2 --enable-x264 --enable-libva'
                    ' --with-ffmpeg-faac --with-ffmpeg-vorbis --with-ffmpeg-mp3lame '
                    ' --with-ffmpeg-theora --enable-libtar --enable-nls --enable-mozilla'
                    )
        r.Environment('LIBTOOL', '%(bindir)s/libtool')

    def policy(r):
        r.addSource('vlc.png')
        r.Install('vlc.png', '%(datadir)s/pixmaps/vlc.png')
