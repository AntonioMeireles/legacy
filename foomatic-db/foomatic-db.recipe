#
# Copyright (c) 2005-2006 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class FoomaticDb(BuildPackageRecipe):

    name = 'foomatic-db'
    version = '3.0_20060706'

    buildRequires = [ 'libxml2:devel', 'wget:runtime', 'curl:devel',
                      'foomatic-filters:runtime' ]

    def setup(r):
        r.macros.upver = r.macros.version.replace('_', '-')
        r.macros.ppdsVersion = '20060706'
        r.addArchive('http://www.linuxprinting.org/download/foomatic/%(name)s-%(upver)s.tar.gz')
        r.addArchive('http://www.linuxprinting.org/download/foomatic/foomatic-filters-ppds-%(ppdsVersion)s.tar.gz')
        r.Remove('debian', recursive=True)
        r.Configure()
        r.Remove('db/source/driver/stp.xml')
        r.Run('find ../foomatic-filters-ppds-* -name "*gimp-print*" '
              '-or -name "*hpijs*" | xargs rm -f')

        r.MakeInstall()

        r.Remove('%(datadir)s/foomatic/db/source/printer/HP*')
        # Provided by foomatic-filters
        r.Remove('%(bindir)s/foomatic-*')
        r.Remove('%(mandir)s/man1/foomatic-*.1')
