#
# Copyright (c) 2005-2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class FoomaticDb(BuildPackageRecipe):

    name = 'foomatic-db'
    version = '3.0_20071218'

    buildRequires = [ 'libxml2:devel', 'wget:runtime', 'curl:devel',
                      'foomatic-filters:runtime', ]

    def setup(r):
        r.macros.archive_version = r.macros.version.replace('_', '-')
        #r.macros.ppdsVersion = '20071218'
        r.addArchive('http://www.linuxprinting.org/download/foomatic/')
        r.addSource('foomatic-cleanupdrivers')
        #r.addArchive('http://www.linuxprinting.org/download/foomatic/foomatic-filters-ppds-%(ppdsVersion)s.tar.gz')
        r.Remove('debian', recursive=True)
        r.Configure()

        r.MakeInstall()

        r.Run('perl foomatic-cleanupdrivers %(destdir)s%(datadir)s/foomatic')

        r.macros.foomatic = '%(datadir)s/foomatic/db/source'
        r.Remove('%(foomatic)s/printer/HP*')
        ## Provided by foomatic-filters
        #r.Remove('%(bindir)s/foomatic-*')
        #r.Remove('%(mandir)s/man1/foomatic-*.1')
        # Provided by foo2zjs
        r.Remove(
            '%(foomatic)s/printer/Generic-ZjStream_Printer.xml',
            '%(foomatic)s/printer/Samsung-CLX-3160.xml',
            '%(foomatic)s/printer/Samsung-CLP-{300,600}.xml',
            '%(foomatic)s/printer/Xerox-Phaser-{6115MFP,6110}.xml',
            '%(foomatic)s/printer/Minolta-Color_PageWorks_Pro_L.xml',
            '%(foomatic)s/printer/Minolta-magicolor_{2200,2300,2430}_DL.xml',
        )
