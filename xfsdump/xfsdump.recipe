#
# Copyright (C) 2009 - Joseph Tate
# License: MIT
#

class XFSDump(CPackageRecipe):
    name = 'xfsdump'
    version = '2.2.48_1'

    buildRequires = ['attr:devel', 'e2fsprogs:devel', 'gettext:runtime', 'libtool:runtime', 'makedepend:runtime', 'ncurses:devel', 'xfsprogs:devel']

    def setup(r):
        r.macros.upver = r.version.replace('_', '-')
        r.addArchive('http://www.kernel.org/pub/linux/utils/fs/xfs/xfsdump/%(name)s_%(upver)s.tar.bz2')

        r.Configure('--enable-shared=yes --enable-gettext=yes '
                    '--enable-readline=yes --enable-editline=no '
                    '--enable-shared-uuid=yes DEBUG=-DNDEBUG')

        r.Make()
        r.MakeInstall(rootVar='DIST_ROOT')

        # TODO: It seems like the binaries should be in /sbin and /usr/sbin
        # instead of /usr/sbin and /usr/bin
        r.Remove('%(docdir)s/xfsdump/', recursive=True)

