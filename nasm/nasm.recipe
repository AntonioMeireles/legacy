#
# Copyright (c) 2004-2005 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Nasm(CPackageRecipe):
    name = 'nasm'
    version = '0.98.39'

    buildRequires = [ 'install-info:runtime', 'perl:runtime',
                      'texinfo:runtime']
    #if Use.builddocs:
    #    buildRequires.extend(['espgs:runtime'])

    def setup(r):
        r.addArchive('mirror://sourceforge/nasm/')

        #if not Use.builddocs:
        # don't build .pdf file.
        r.Replace(('nasm.info nasmdoc.ps nasmdoc.pdf',
                   'nasm.info'),
                  ('nasmdoc.ps nasmdoc.pdf', ''),
                  'doc/Makefile.in')

        r.Configure()
        r.Make()
        r.MakeDirs('%(bindir)s', '%(mandir)s/man1', '%(infodir)s',
                   '%(thisdocdir)s')
        r.MakePathsInstall('docdir=%(destdir)s/%(thisdocdir)s',
                           installtarget='install_everything')
