#
# Copyright (c) 2008-2009 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('gnomepackage')
class Empathy(GnomePackageRecipe):

    name = 'empathy'
    version = '2.28.2'

    buildRequires = [
        'GConf:devel',
        'GConf:runtime',
        'NetworkManager:devel',
        'ORBit2:devel',
        'WebKit:devel',
        'aspell:devel',
        'dbus-glib:runtime',
        'dbus:devel',
        'desktop-file-utils:runtime',
        'enchant:devellib',
        'evolution-data-server:devel',
        'geoclue:devel',
        'gnome-keyring:devel',
        'gnome-panel:devel',
        'gnome-vfs:devel',
        'gst-plugins-base:devellib',
        'iso-codes:devellib',
        'libart_lgpl:devel',
        'libbonobo:devel',
        'libbonoboui:devel',
        'libcanberra:devel',
        'libnotify:devel',
        'popt:devel',
        'pygobject:runtime',
        'pygtk:devel',
        'pygtk:devellib',
        'python:devel',
        'rarian:devel',
        'rarian:runtime',
        'telepathy-farsight:devellib',
        'telepathy-mission-control:devel',
        'unique:devellib',
        'valgrind:devel',
        'valgrind:runtime',
        'libchamplain:devel'
        ]

    GnomePackageRecipe.extraConfig += (
        ' --enable-location=yes'
        ' --enable-map=yes'
        ' --enable-megaphone=yes'
        ' --enable-nothere=yes'
        ' --enable-python=yes'
        ' --enable-spell=yes'
        ' --enable-webkit=yes'
        ' --with-compile-warnings=no'
        ' --with-connectivity=nm'
        )
    # fixes for latest NM
    GnomePackageRecipe.patches = [ 'empathy-broken-nm.patch', 'empathy-broken-pkgconfig.patch']
    
    def unpack(r):
        GnomePackageRecipe.unpack(r)
        # force these to be regenerated
        r.Remove('data/empathy.desktop')
        r.Remove('data/empathy.schemas')
        r.disableParallelMake()
