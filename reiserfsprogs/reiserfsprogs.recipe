#
# Copyright (c) 2004-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class ReiserfsProgs(CPackageRecipe):
    name = 'reiserfsprogs'
    version = '3.6.20'

    # needed for -luuid
    buildRequires = [ 'e2fsprogs:devel' ]

    def setup(r):
        if Arch.BE:
            # only little-endian platforms are supported at the moment;
            # remove this if/when this changes
            return

        r.addArchive('ftp://namesys.com/pub/%(name)s/')

        r.Run('find . -name "config.cache" | xargs rm -f')
        r.ManualConfigure('--prefix=/')
        r.Make()

        r.MakeInstall()
        r.Symlink('mkreiserfs', '%(essentialsbindir)s/mkfs.reiserfs')
        r.Symlink('reiserfsck', '%(essentialsbindir)s/fsck.reiserfs')

        r.Move('/man/*', '%(mandir)s/')
