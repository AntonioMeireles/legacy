class GroupDesktopPlatform(GroupRecipe):
    name = 'group-desktop-platform'
    version = '1.9.0.0.1'

    autoResolve = True

    Flags.local_tools = True
    depCheck = True
    checkPathConflicts = True
#    checkPathConflicts = False
    x86_64FlavorString = 'is: x86(i486,i586,i686) x86_64'
    rPathVersionStr = None

    unwantedComponents = [ 'supdoc' ]

    def startGroup(r, name, parentGroup, depCheck=False, byDefault=True, autoResolve = False):
        # creates group named "name", adds it to the toplevel group,
        # and sets the current group to that name.  calls to r.add()
        # will use the current group by default.

        # note: byDefault applies to whether the group is included by
        # default in its parent group, not whether the troves in
        # the group are added by default. (use the setByDefault() command
        # to get that)

        # get all the the default for the new group from its parent group.
        if parentGroup:
            r.setDefaultGroup(parentGroup)
        r.createGroup(name, autoResolve=autoResolve, depCheck=depCheck,
                      byDefault=True)
        if parentGroup:
            r.addNewGroup(name, groupName=parentGroup, byDefault=byDefault)
        r.setDefaultGroup(name)
        r.removeComponents(r.unwantedComponents)

    def flAddCopy(r, name, origin , flavor=None):
        if Arch.x86_64 and not flavor:
            flavor=GroupDesktopPlatform.x86_64FlavorString
        r.addCopy(name, origin, flavor)

    def setup(r):
        rplBranch = "conary.rpath.com@rpl:devel"
        r.setSearchPath('foresight.rpath.org@fl:2-devel', 'conary.rpath.com@rpl:devel')

        for groupName in ('base',
                          'core',
                          'devel',
                          #                          'gnome',
                          #                          'netserver',
                          #                          'os-devel',
                          #                          'printing',
                          'text-tools',):
            r.flAddCopy('group-'+groupName, rplBranch)

        if Arch.x86_64:
            r.flAddCopy('group-compat32', rplBranch)

        r.replace('distro-release', 'foresight.rpath.org@fl:2-devel')

        #
        # xorg stack
        #
        r.startGroup('group-xorg', parentGroup='group-desktop-platform')

        r.add('xorg-server')

        ## packages built by xorg-proto
        r.add('applewmproto', source='xorg-proto')
        r.add('bigreqsproto', source='xorg-proto')
        r.add('compositeproto', source='xorg-proto')
        r.add('damageproto', source='xorg-proto')
        r.add('dmxproto', source='xorg-proto')
        r.add('evieext', source='xorg-proto')
        r.add('fixesproto', source='xorg-proto')
        r.add('fontcacheproto', source='xorg-proto')
        r.add('fontsproto', source='xorg-proto')
        r.add('glproto', source='xorg-proto')
        r.add('inputproto', source='xorg-proto')
        r.add('kbproto', source='xorg-proto')
        r.add('libpthread-stubs', source='xorg-proto')
        r.add('printproto', source='xorg-proto')
        r.add('randrproto', source='xorg-proto')
        r.add('recordproto', source='xorg-proto')
        r.add('renderproto', source='xorg-proto')
        r.add('resourceproto', source='xorg-proto')
        r.add('scrnsaverproto', source='xorg-proto')
        r.add('trapproto', source='xorg-proto')
        r.add('util-macros', source='xorg-proto')
        r.add('videoproto', source='xorg-proto')
        r.add('vncproto', source='xorg-proto')
        r.add('windowswmproto', source='xorg-proto')
        r.add('xcb-proto', source='xorg-proto')
        r.add('xcliplistproto', source='xorg-proto')
        r.add('xcmiscproto', source='xorg-proto')
        r.add('xextproto', source='xorg-proto')
        r.add('xf86bigfontproto', source='xorg-proto')
        r.add('xf86dgaproto', source='xorg-proto')
        r.add('xf86driproto', source='xorg-proto')
        r.add('xf86miscproto', source='xorg-proto')
        r.add('xf86rushproto', source='xorg-proto')
        r.add('xf86vidmodeproto', source='xorg-proto')
        r.add('xineramaproto', source='xorg-proto')
        r.add('xproto', source='xorg-proto')
        r.add('xproxymanagementprotocol', source='xorg-proto')
        ## end of list of packages built by xorg-proto

        r.add('xcursor-themes')
        r.add('xkeyboard-config')
        r.add('xorg-sgml-doctools')

        ## packages built by xorg-libs
        r.add('libdmx', source='xorg-libs')
        r.add('libFS', source='xorg-libs')
        r.add('liblbxutil', source='xorg-libs')
        r.add('liboldX', source='xorg-libs')
        r.add('libvnc', source='xorg-libs')
        r.add('libXaw', source='xorg-libs')
        r.add('libXcliplist', source='xorg-libs')
        r.add('libXcomposite', source='xorg-libs')
        r.add('libXcursor', source='xorg-libs')
        r.add('libXdamage', source='xorg-libs')
        r.add('libXevie', source='xorg-libs')
        r.add('libXfont', source='xorg-libs')
        r.add('libXfontcache', source='xorg-libs')
        r.add('libXft', source='xorg-libs')
        r.add('libXft1', source='xorg-libs')
        r.add('libXi', source='xorg-libs')
        r.add('libXinerama', source='xorg-libs')
        r.add('libxkbui', source='xorg-libs')
        r.add('libXprintAppUtil', source='xorg-libs')
        r.add('libXrandr', source='xorg-libs')
        r.add('libXres', source='xorg-libs')
        r.add('libXScrnSaver', source='xorg-libs')
        r.add('libXTrap', source='xorg-libs')
        r.add('libXtst', source='xorg-libs')
        r.add('libXvMC', source='xorg-libs')
        r.add('libXxf86dga', source='xorg-libs')
        r.add('libXxf86misc', source='xorg-libs')
        r.add('libXxf86vm', source='xorg-libs')
        r.add('xbitmaps', source='xorg-libs')
        r.add('xcb-util',source='xorg-libs')
        ## end of packages built by xorg-libs
        r.add('libfontenc')
        r.add('libICE')
        r.add('libSM')
        r.add('libX11')
        r.add('libXau')
        r.add('libxcb')
        r.add('libXdmcp')
        r.add('libXext')
        r.add('libXfixes')
        r.add('libxkbfile')
        r.add('libXmu')
        r.add('libXp')
        r.add('libXpm')
        r.add('libXprintUtil')
        r.add('libXrender')
        r.add('libXt')
        r.add('libXv')
        r.add('Mesa')
        r.add('glx-utils', source='Mesa')
        r.add('libdrm')

        ## packages built by xorg-apps
        r.add('appres', source='xorg-apps')
        r.add('bdftopcf', source='xorg-apps')
        r.add('beforelight', source='xorg-apps')
        r.add('bitmap', source='xorg-apps')
        r.add('editres', source='xorg-apps')
        r.add('fonttosfnt', source='xorg-apps')
        r.add('fslsfonts', source='xorg-apps')
        r.add('fstobdf', source='xorg-apps')
        r.add('iceauth', source='xorg-apps')
        r.add('ico', source='xorg-apps')
        r.add('lbxproxy', source='xorg-apps')
        r.add('listres', source='xorg-apps')
        r.add('luit', source='xorg-apps')
        r.add('mkcomposecache', source='xorg-apps')
        r.add('mkfontdir', source='xorg-apps')
        r.add('mkfontscale', source='xorg-apps')
        r.add('oclock', source='xorg-apps')
        r.add('proxymngr', source='xorg-apps')
        r.add('rendercheck', source='xorg-apps')
        r.add('rgb', source='xorg-apps')
        r.add('rstart', source='xorg-apps')
        r.add('scripts', source='xorg-apps')
        r.add('sessreg', source='xorg-apps')
        r.add('setxkbmap', source='xorg-apps')
        r.add('showfont', source='xorg-apps')
        r.add('smproxy', source='xorg-apps')
        r.add('twm', source='xorg-apps')
        r.add('viewres', source='xorg-apps')
        r.add('x11perf', source='xorg-apps')
        r.add('xauth', source='xorg-apps')
        r.add('xbiff', source='xorg-apps')
        r.add('xcalc', source='xorg-apps')
        r.add('xclipboard', source='xorg-apps')
        r.add('xclock', source='xorg-apps')
        r.add('xcmsdb', source='xorg-apps')
        r.add('xconsole', source='xorg-apps')
        r.add('xcursorgen', source='xorg-apps')
        r.add('xcursor-themes', source='xorg-apps')
        r.add('xdbedizzy', source='xorg-apps')
        r.add('xditview', source='xorg-apps')
        r.add('xdm', source='xorg-apps')
        r.add('xdpyinfo', source='xorg-apps')
        r.add('xedit', source='xorg-apps')
        r.add('xev', source='xorg-apps')
        r.add('xeyes', source='xorg-apps')
        r.add('xf86dga', source='xorg-apps')
        r.add('xfd', source='xorg-apps')
        r.add('xfindproxy', source='xorg-apps')
        r.add('xfontsel', source='xorg-apps')
        r.add('xfs', source='xorg-apps')
        r.add('xfsinfo', source='xorg-apps')
        r.add('xfwp', source='xorg-apps')
        r.add('xgamma', source='xorg-apps')
        r.add('xgc', source='xorg-apps')
        r.add('xhost', source='xorg-apps')
        r.add('xinit', source='xorg-apps')
        r.add('xkbcomp', source='xorg-apps')
        r.add('xkbevd', source='xorg-apps')
        r.add('xkbprint', source='xorg-apps')
        r.add('xkbutils', source='xorg-apps')
        r.add('xkill', source='xorg-apps')
        r.add('xload', source='xorg-apps')
        r.add('xlogo', source='xorg-apps')
        r.add('xlsatoms', source='xorg-apps')
        r.add('xlsclients', source='xorg-apps')
        r.add('xlsfonts', source='xorg-apps')
        r.add('xmag', source='xorg-apps')
        r.add('xman', source='xorg-apps')
        r.add('xmessage', source='xorg-apps')
        r.add('xmh', source='xorg-apps')
        r.add('xmodmap', source='xorg-apps')
        r.add('xmore', source='xorg-apps')
        r.add('xplsprinters', source='xorg-apps')
        r.add('xpr', source='xorg-apps')
        r.add('xprehashprinterlist', source='xorg-apps')
        r.add('xprop', source='xorg-apps')
        r.add('xrandr', source='xorg-apps')
        r.add('xrdb', source='xorg-apps')
        r.add('xrefresh', source='xorg-apps')
        r.add('xrx', source='xorg-apps')
        r.add('xset', source='xorg-apps')
        r.add('xsetmode', source='xorg-apps')
        r.add('xsetpointer', source='xorg-apps')
        r.add('xsetroot', source='xorg-apps')
        r.add('xsm', source='xorg-apps')
        r.add('xstdcmap', source='xorg-apps')
        r.add('xtrap', source='xorg-apps')
        r.add('xvidtune', source='xorg-apps')
        r.add('xvinfo', source='xorg-apps')
        r.add('xwd', source='xorg-apps')
        r.add('xwininfo', source='xorg-apps')
        r.add('xwud', source='xorg-apps')
        ## end of packages built by xorg-apps

        r.startGroup('group-xorg-fonts', parentGroup='group-xorg', depCheck=False)
        ## packages built by xorg fonts
        r.add('encodings', source='xorg-fonts')
        r.add('font-adobe-100dpi', source='xorg-fonts')
        r.add('font-adobe-75dpi', source='xorg-fonts')
        r.add('font-adobe-utopia-100dpi', source='xorg-fonts')
        r.add('font-adobe-utopia-75dpi', source='xorg-fonts')
        r.add('font-adobe-utopia-type1', source='xorg-fonts')
        r.add('font-alias', source='xorg-fonts')
        r.add('font-arabic-misc', source='xorg-fonts')
        r.add('font-bh-100dpi', source='xorg-fonts')
        r.add('font-bh-75dpi', source='xorg-fonts')
        r.add('font-bh-lucidatypewriter-100dpi', source='xorg-fonts')
        r.add('font-bh-lucidatypewriter-75dpi', source='xorg-fonts')
        r.add('font-bh-ttf', source='xorg-fonts')
        r.add('font-bh-type1', source='xorg-fonts')
        r.add('font-bitstream-100dpi', source='xorg-fonts')
        r.add('font-bitstream-75dpi', source='xorg-fonts')
        r.add('font-bitstream-speedo', source='xorg-fonts')
        r.add('font-bitstream-type1', source='xorg-fonts')
        r.add('font-cronyx-cyrillic', source='xorg-fonts')
        r.add('font-cursor-misc', source='xorg-fonts')
        r.add('font-daewoo-misc', source='xorg-fonts')
        r.add('font-dec-misc', source='xorg-fonts')
        r.add('font-ibm-type1', source='xorg-fonts')
        r.add('font-isas-misc', source='xorg-fonts')
        r.add('font-jis-misc', source='xorg-fonts')
        r.add('font-micro-misc', source='xorg-fonts')
        r.add('font-misc-cyrillic', source='xorg-fonts')
        r.add('font-misc-ethiopic', source='xorg-fonts')
        r.add('font-misc-meltho', source='xorg-fonts')
        r.add('font-misc-misc', source='xorg-fonts')
        r.add('font-mutt-misc', source='xorg-fonts')
        r.add('font-schumacher-misc', source='xorg-fonts')
        r.add('font-screen-cyrillic', source='xorg-fonts')
        r.add('font-sony-misc', source='xorg-fonts')
        r.add('font-sun-misc', source='xorg-fonts')
        r.add('font-winitzki-cyrillic', source='xorg-fonts')
        r.add('font-xfree86-type1', source='xorg-fonts')
        ## end of packages built by xorg fonts

#        r.startGroup('group-xorg-fonts-extra', parentGroup='group-xorg', depCheck=False)
#        r.add('scim')
#        r.add('scim-anthy')
#        r.add('anthy')
#        r.add('sazanami')

        r.startGroup('group-xorg-drivers', parentGroup='group-xorg', depCheck=False)

        ## packages built by xorg-drivers-input
        r.add('xf86-input-jamstudio', source='xorg-driver-input')
        r.add('xf86-input-ur98', source='xorg-driver-input')
        r.add('xf86-input-citron', source='xorg-driver-input')
        r.add('xf86-input-elo2300', source='xorg-driver-input')
        r.add('xf86-input-dmc', source='xorg-driver-input')
        r.add('xf86-input-evdev', source='xorg-driver-input')
        r.add('xf86-input-digitaledge', source='xorg-driver-input')
        r.add('xf86-input-acecad', source='xorg-driver-input')
        r.add('xf86-input-mutouch', source='xorg-driver-input')
        r.add('xf86-input-mouse', source='xorg-driver-input')
        r.add('xf86-input-dynapro', source='xorg-driver-input')
        r.add('xf86-input-keyboard', source='xorg-driver-input')
        r.add('xf86-input-magellan', source='xorg-driver-input')
        r.add('xf86-input-void', source='xorg-driver-input')
        r.add('xf86-input-aiptek', source='xorg-driver-input')
        r.add('xf86-input-summa', source='xorg-driver-input')
        r.add('xf86-input-penmount', source='xorg-driver-input')
        r.add('xf86-input-elographics', source='xorg-driver-input')
        r.add('xf86-input-microtouch', source='xorg-driver-input')
        r.add('xf86-input-calcomp', source='xorg-driver-input')
        r.add('xf86-input-hyperpen', source='xorg-driver-input')
        r.add('xf86-input-magictouch', source='xorg-driver-input')
        r.add('xf86-input-tek4957', source='xorg-driver-input')
        r.add('xf86-input-fpit', source='xorg-driver-input')
        r.add('xf86-input-spaceorb', source='xorg-driver-input')
        r.add('xf86-input-vmmouse', source='xorg-driver-input')
        r.add('xf86-input-joystick', source='xorg-driver-input')
        r.add('xf86-input-palmax', source='xorg-driver-input')
        ## end of packages built by xorg-drivers-input

        ## packages built by xorg-drivers-video
        r.add('xf86-video-fbdev', source='xorg-driver-video')
        r.add('xf86-video-mga', source='xorg-driver-video')
        r.add('xf86-video-ati', source='xorg-driver-video')
        r.add('xf86-video-trident', source='xorg-driver-video')
        r.add('xf86-video-sisusb', source='xorg-driver-video')
        r.add('xf86-video-cirrus', source='xorg-driver-video')
        r.add('xf86-video-sis', source='xorg-driver-video')
        r.add('xf86-video-vesa', source='xorg-driver-video')
        r.add('xf86-video-suncg3', source='xorg-driver-video')
        r.add('xf86-video-neomagic', source='xorg-driver-video')
        r.add('xf86-video-i128', source='xorg-driver-video')
        r.add('xf86-video-s3', source='xorg-driver-video')
        r.add('xf86-video-v4l', source='xorg-driver-video')
        r.add('xf86-video-chips', source='xorg-driver-video')
        r.add('xf86-video-sunffb', source='xorg-driver-video')
        r.add('xf86-video-imstt', source='xorg-driver-video')
        r.add('xf86-video-savage', source='xorg-driver-video')
        r.add('xf86-video-tseng', source='xorg-driver-video')
        r.add('xf86-video-nsc', source='xorg-driver-video')
        r.add('xf86-video-vga', source='xorg-driver-video')
        r.add('xf86-video-via', source='xorg-driver-video')
        r.add('xf86-video-suncg6', source='xorg-driver-video')
        r.add('xf86-video-s3virge', source='xorg-driver-video')
        r.add('xf86-video-dummy', source='xorg-driver-video')
        r.add('xf86-video-newport', source='xorg-driver-video')
        r.add('xf86-video-voodoo', source='xorg-driver-video')
        r.add('xf86-video-ast', source='xorg-driver-video')
        r.add('xf86-video-intel', source='xorg-driver-video')
        r.add('xf86-video-i810', source='xorg-driver-video')
        r.add('xf86-video-sunbw2', source='xorg-driver-video')
        r.add('xf86-video-cyrix', source='xorg-driver-video')
        r.add('xf86-video-vmware', source='xorg-driver-video')
        r.add('xf86-video-suncg14', source='xorg-driver-video')
        r.add('xf86-video-tdfx', source='xorg-driver-video')
        r.add('xf86-video-tga', source='xorg-driver-video')
        r.add('xf86-video-suntcx', source='xorg-driver-video')
        r.add('xf86-video-glint', source='xorg-driver-video')
        r.add('xf86-video-nv', source='xorg-driver-video')
        r.add('xf86-video-apm', source='xorg-driver-video')
        r.add('xf86-video-sunleo', source='xorg-driver-video')
        r.add('xf86-video-ark', source='xorg-driver-video')
        r.add('xf86-video-rendition', source='xorg-driver-video')
        r.add('xf86-video-siliconmotion', source='xorg-driver-video')
        r.add('xf86-video-i740', source='xorg-driver-video')
        ## end of packages built by xorg-drivers-video

        for moveGroup in (
            'group-base',
            'group-core',
#            'group-netserver',
            'group-devel',
#            'group-os-devel',
#            'group-printing',
            'group-text-tools',):
            r.removeItemsAlsoInNewGroup('group-xorg', groupName= moveGroup)

        for moveGroup in (
          'group-base',
          'group-core',
#          'group-netserver',
#          'group-os-devel',
#          'group-printing',
          'group-text-tools',
          'group-xorg',
          'group-xorg-fonts',
          'group-xorg-drivers',):
            r.moveComponents([':devellib', ':devel'], moveGroup, 'group-devel')

