class SystemConfigUsers(PackageRecipe):
    buildRequires = [ 'desktop-file-utils:runtime', 'intltool:runtime' ]
    name = "system-config-users"
    version = "1.2.28"

    def setup(r):
        r.addArchive('%(name)s-%(version)s.tar.bz2',
            rpm='ftp://ftp.linux.ncsu.edu/pub/fedora/linux/core/test/3.90/SRPMS/%(name)s-%(version)s-1.src.rpm')

	r.addPatch('selinux.patch')
	r.addPatch('sudo.patch')
	r.Replace('RPM_BUILD_ROOT','INSTROOT','po/Makefile')
	r.Replace('python2', 'python', 'src/system-config-users{,.py}')
        r.Replace('Icon=%(name)s.png', 'Icon=%(datadir)s/icons/hicolor/48x48/apps/%(name)s.png','%(name)s.desktop')
        r.Replace('Exec=','Exec=gksudo ','%(name)s.desktop')
        r.Replace('Categories=Application;SystemSetup;','Categories=Application;System;Settings;','%(name)s.desktop')
        r.Replace('gtk.FALSE','False ','src/*Window.py')
        r.Replace('gtk.TRUE','True ','src/*Window.py')
        r.Replace('gtk.FALSE','False ','src/groupProperties.py')
        r.Replace('gtk.TRUE','True ','src/groupProperties.py')
        r.Replace('RPM package','package ','doc/intro.html')
	r.addSource('group-new.png', dir='doc/figs')
	r.addSource('group-properties.png', dir='doc/figs')
	r.addSource('system-config-users.png', dir='doc/figs')
	r.addSource('user-new.png', dir='doc/figs')
	r.addSource('user-properties.png', dir='doc/figs')
        r.Make()
        r.MakeInstall(rootVar='INSTROOT')
	r.Run('echo >> %(destdir)s/%(sysconfdir)s/sysconfig/system-config-users')
	r.Doc('README', 'NEWS', 'AUTHORS', 'doc/*')
