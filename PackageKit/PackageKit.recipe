#
# Copyright (c) 2007 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Packagekit(AutoPackageRecipe):
    name = 'PackageKit'
    version = '0.1.2'

    buildRequires = ['NetworkManager:devel', 'PolicyKit:devel', 'PolicyKit:runtime', 'dbus-glib:devel', 'dbus:devel', 'docbook-utils:runtime', 'glib:devel', 'libstdc++:devel', 'pkgconfig:devel', 'python-sqlite:python', 'libtool:runtime', 'dbus-glib:runtime', 'sqlite:devel', 'xmlto:runtime', 'dbus-python:python', 'pygobject:python']

    def unpack(r):
        r.addArchive('http://people.freedesktop.org/~hughsient/releases/')
        r.Replace('ShutdownTimeout=60','ShutdownTimeout=0','etc/PackageKit.conf.in')

    def configure(r):
        r.Configure('--with-default-backend=conary')

    def policy(r):
        r.Remove('%(localstatedir)s/lib/PolicyKit/.*')
        r.Remove('%(localstatedir)s/db/PackageKit/transactions.db')
        r.ExcludeDirectories(exceptions=['%(localstatedir)s/db/PackageKit'])
