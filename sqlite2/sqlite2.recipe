class Sqlite2(PackageRecipe):

    buildRequires = [ 'glibc:devel', 'ncurses:devel', 'tcl:runtime' ]
    extraConfig = ''

    if Use.readline:
        buildRequires.append('readline:devel')
    if Use.tcl:
        buildRequires.append('tcl:devel')
    else:
        # as far as i can tell, this is the right way to disable TCL;
        # at least, it disables the checks.
        extraConfig += ' --without-tcl'

    name = 'sqlite2'
    version = '2.8.15'

    def setup(r):
        r.mainDir('sqlite')
        r.addArchive('http://sqlite.org/sqlite-%(version)s.tar.gz')

        r.macros.cflags += " -DNDEBUG=1"
        r.Configure(r.extraConfig)
        mflags = ''
        if not Use.readline:
            mflags += 'READLINE_FLAGS= '
        r.Make(mflags)
        r.Make('doc')
        r.MakeInstall('prefix=%(prefix)s')

        r.Doc('doc/*')

