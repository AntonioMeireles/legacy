Description: Compile against 3.6.35
Author: Noel J. Bergman
Bug-Ubuntu: http://launchpad.net/bugs/598542
Last-Update: 2010-07-24
--- a/modules/linux/vmxnet/vmxnet.c
+++ b/modules/linux/vmxnet/vmxnet.c
@@ -2910,7 +2910,7 @@
 {
    struct Vmxnet_Private *lp = netdev_priv(dev);
     volatile u16 *mcast_table = (u16 *)lp->dd->LADRF;
-    struct dev_mc_list *dmi = dev->mc_list;
+    struct netdev_hw_addr *ha;  // struct dev_mc_list *dmi = dev->mc_list;
     u8 *addrs;
     int i, j, bit, byte;
     u32 crc, poly = CRC_POLYNOMIAL_LE;
@@ -2919,10 +2919,11 @@
     lp->dd->LADRF[0] = 0;
     lp->dd->LADRF[1] = 0;
 
+    i = 0;
     /* Add addresses */
-    for (i = 0; i < dev->mc_count; i++){
-	addrs = dmi->dmi_addr;
-	dmi   = dmi->next;
+    netdev_for_each_mc_addr(ha, dev) { // for (i = 0; i < dev->mc_count; i++){
+        addrs = ha->addr; //dmi->dmi_addr;
+	++i; // dmi   = dmi->next;
 
 	/* multicast address? */
 	if (!(*addrs & 1))
