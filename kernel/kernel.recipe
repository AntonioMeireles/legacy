#
# Copyright (c) 2005-2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('kernelpackage.recipe')
class Kernel(KernelPackageRecipe):

    name = 'kernel'
    version = '2.6.27.5'

    def unpack(r):
        r.addPatch('linux-2.6-upstream-reverts.patch', extraArgs='-R')
        r.addPatch('git-cpufreq.patch')
        r.addPatch('linux-2.6-x86-mtrr-kill-bogus-warning.patch')
        r.addPatch('linux-2.6-sysrq-c.patch')
        r.addPatch('linux-2.6.27-ext4-2.6.28-rc3-git6.patch')
        r.addPatch('linux-2.6.27-ext4-2.6.28-backport-fixups.patch')
        r.addPatch('linux-2.6-usb-ehci-hcd-respect-nousb.patch')
        r.addPatch('linux-2.6-crypto-fips_enable.patch')
        r.addPatch('linux-2.6-defaults-acpi-video.patch')
        r.addPatch('linux-2.6-acpi-video-dos.patch')
        r.addPatch('linux-2.6-acpi-handle-ec-init-failure.patch')
        r.addPatch('linux-2.6-acpi-dock-avoid-check-sta-method.patch')
        r.addPatch('linux-2.6-acpi-dock-fix-eject-request-process.patch')
        r.addPatch('linux-2.6-crash-driver.patch')
        r.addPatch('linux-2.6-defaults-pci_no_msi.patch')
        r.addPatch('linux-2.6-pciehp-update.patch')
        r.addPatch('linux-2.6-defaults-pciehp.patch')
        r.addPatch('linux-2.6-scsi-cpqarray-set-master.patch')
        r.addPatch('linux-2.6-squashfs.patch')
        r.addPatch('linux-2.6-net-silence-noisy-printks.patch')
        r.addPatch('linux-2.6-input-kill-stupid-messages.patch')
        r.addPatch('linux-2.6.27-hwmon-applesmc-2.6.28.patch')
        r.addPatch('linux-2.6-serial-460800.patch')
        r.addPatch('linux-2.6-silence-noise.patch')
        r.addPatch('linux-2.6-libata-avoid-overflow-with-large-disks.patch')
        r.addPatch('linux-2.6-iwlagn-downgrade-BUG_ON-in-interrupt.patch')
        r.addPatch('linux-2.6-iwl3945-ibss-tsf-fix.patch')
        r.addPatch('linux-2.6-hostap-skb-cb-hack.patch')
        r.addPatch('linux-2.6-at76.patch')
        r.addPatch('linux-2.6-wireless-iwlagn-avoid-sleep-in-softirq.patch')
        r.addPatch('linux-2.6-nfs-client-mounts-hang.patch')
        r.addPatch('linux-2.6-alsa-ac97-whitelist.patch')
        r.addPatch('linux-2.6-alsa-ac97-whitelist-AD1981B.patch')
        r.addPatch('linux-2.6-default-mmf_dump_elf_headers.patch')
        r.addPatch('linux-2.6.27-lirc.patch')
        r.addPatch('linux-2.6-hdpvr.patch')
        r.addPatch('linux-2.6-cdrom-door-status.patch')
        r.addPatch('linux-2.6-blk-cciss-fix-regression-sysfs-symlink-missing.patch')
        r.addPatch('linux-2.6-e1000-ich9.patch')
        r.addPatch('linux-2.6-netdev-atl2.patch')
        r.addPatch('linux-2.6-e1000e-add-support-for-the-82567LM-4-device.patch')
        r.addPatch('linux-2.6-e1000e-add-support-for-82567LM-3-and-82567LF-3-ICH10D-parts.patch')
        r.addPatch('linux-2.6-e1000e-add-support-for-new-82574L-part.patch')
        r.addPatch('linux-2.6-netdev-r8169-2.6.28.patch')
        r.addPatch('linux-2.6-eeepc-laptop-update.patch')
        r.addPatch('linux-2.6-toshiba-acpi-update.patch')
        r.addPatch('linux-2.6-net-tulip-interrupt.patch')
        r.addPatch('linux-2.6-olpc-speaker-out.patch')
        r.addPatch('linux-2.6-olpc-touchpad.patch')
        r.addPatch('linux-2.6-quieter-mmc.patch')
        r.addPatch('nvidia-agp.patch')
        r.addPatch('drm-next.patch')
        r.addPatch('drm-intel-gem-x86-64-faster.patch')
        r.addPatch('drm-modesetting-radeon.patch')
        r.addPatch('drm-nouveau.patch')
        r.addPatch('linux-2.6-firewire-git-update.patch')
        r.addPatch('linux-2.6-firewire-git-pending.patch')
        r.addPatch('linux-2.6-merge-efifb-imacfb.patch')
        r.addPatch('linux-2.6.27-sony-laptop-suspend-fix.patch')
        r.addPatch('linux-2.6-dmi-autoload.patch')
        r.addPatch('linux-2.6-piix3-silence-quirk.patch')
        r.addPatch('linux-2.6-quiet-iommu.patch')
        r.addPatch('linux-2.6-silence-acpi-blacklist.patch')
        r.addPatch('linux-2.6-amd64-yes-i-know-you-live.patch')
        r.addPatch('linux-2.6.27-pci-hush-allocation-failures.patch')
        r.addPatch('disable-p4-cpufreq-ui.patch')
        # Dropped until they fix it upstream
        # r.addPatch('ftp://download.filesystems.org/pub/unionfs/unionfs-2.x/unionfs-2.5_for_2.6.27-rc6.diff.gz')
        r.addPatch('linux-2.6-open-vm-tools.patch')
        r.addPatch('0001-superreadahead-patch.patch')

    def build(r):
        r.Remove('/lib/firmware', recursive=True)
