--- mkinitrd-4.2.15/mkinitrd.orig	2005-09-21 23:08:55.000000000 -0400
+++ mkinitrd-4.2.15/mkinitrd	2005-09-21 23:14:00.000000000 -0400
@@ -190,7 +190,7 @@
 	    else
 		fstab=$2
 		shift
-	    fi		    
+	    fi
 	    ;;
 
 	--with-usb)
@@ -284,6 +284,11 @@
     shift
 done
 
+if [ ! -r "$fstab" ]; then
+    echo "error: $fstab is not readable"
+    exit 1
+fi
+
 if [ -z "$target" -o -z "$kernel" ]; then
     usage
 fi
@@ -322,6 +327,14 @@
 # if we're not using udev, don't set any of the other bits
 [ -z "$USE_UDEV" ] && UDEV_TMPFS= && UDEV_KEEP_DEV=
 
+if [ ! -d /dev ]; then
+    mkdir /dev
+fi
+
+if [ ! -c /dev/null ]; then
+    mknod /dev/null c 1 3
+fi
+
 # find a temporary directory which doesn't use tmpfs
 TMPDIR=""
 for t in /tmp /var/tmp /root ${PWD}; do
