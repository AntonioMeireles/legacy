class FlashPlayer(PackageRecipe):
    name = "flashplayer"
    version = "11.1.102.63"

    buildRequires = [ 'glibc:devel', 'zlib:devel', 'fontconfig:devel',
                      'freetype:devel', 'glib:devel', 'gtk:devel',
                      'libX11:devel', 'libXext:devel', 'libXt:devel',
                      'libgcc:devellib', 'libstdc++:devel',
                      'desktop-file-utils:runtime',]

    def setup(r):
        r.addArchive('http://fpdownload.macromedia.com/get/flashplayer/pdc/%(version)s/install_flash_player_11_linux.i386.tar.gz', use=Arch.x86)
        r.addArchive('http://fpdownload.macromedia.com/get/flashplayer/pdc/%(version)s/install_flash_player_11_linux.x86_64.tar.gz', use=Arch.x86_64)

        r.Install('../libflashplayer.so','%(libdir)s/mozilla/plugins/')
        r.Install('../usr/bin/flash-player-properties', '%(bindir)s/', mode = 0755)
        r.Install('../usr/share/pixmaps/*', '%(datadir)s/pixmaps/', mode = 0644)
        r.Install('../usr/share/icons/*', '%(datadir)s/icons/', mode = 0644)
        r.Install('../usr/share/applications/*', '%(datadir)s/applications/', mode = 0644)
        
        r.ComponentSpec("runtime", "%(libdir)s/mozilla.*")
        r.Requires('xulrunner:lib', '%(libdir)s/')
        r.Requires('mozilla-filesystem:runtime', '%(libdir)s/')

        # to get hw accel
        r.Requires('libvdpau:lib', '%(libdir)s/')
        # http://www.nvnews.net/vbulletin/showthread.php?s=aa9efb4514edb3f3ff4338679327aac4&t=148409&page=5
        # XXX do not enable hw accel byDefault as it creates more issues
        # than the ones it solves when using at least nvidia drivers...
        # see - http://www.nvnews.net/vbulletin/showthread.php?t=159619
        # 
        r.Create('%(sysconfdir)s/adobe/mms.cfg',
                 contents = ('# enable bellow at your own risk...\n'
                             '# ... specially if using Nvidia cards (see http://www.nvnews.net/vbulletin/showthread.php?t=159619 )\n\n'
                             '# EnableLinuxHWVideoDecode=1')
                 )   
