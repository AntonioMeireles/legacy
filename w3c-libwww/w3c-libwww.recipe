#
# Copyright (c) 2004-2005 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class W3CLibWWW(CPackageRecipe):
    buildRequires = [ 'zlib:devel', 'libtool:runtime', 'autoconf:runtime',
                      'automake:runtime' ]

    name = 'w3c-libwww'
    version = '5.4.0'

    def setup(r):
        srpm = 'ftp://download.fedora.redhat.com/pub/fedora/linux/core/2/SRPMS/%(name)s-%(version)s-9.1.src.rpm'
        r.addArchive('w3c-libwww-%(version)s.tgz', rpm=srpm)
        r.addPatch('w3c-libwww-5.3.2-incdir.patch', rpm=srpm)
        r.addPatch('w3c-libwww-ppc64.patch', rpm=srpm)
        r.addPatch('w3c-libwww-autostar.patch', rpm=srpm)
        r.Run('libtoolize -c -f')
        r.Run('autoreconf -i')
        r.Run('echo timestamp > stamp.h.in')
        r.Run('touch Library/User/Extrnals.html')
        r.Configure('--enable-shared --with-gnu-ld --with-regex --with-zlib')
        r.Environment('tagname', 'CC')
        r.Make('LIBTOOL=%(bindir)s/libtool')
        r.MakeInstall('LIBTOOL=%(bindir)s/libtool')
        r.Symlink('w3c-libwww/xmlparse.h', '%(includedir)s/xmlparse.h')
        r.Move('%(includedir)s/wwwconf.h', '%(includedir)s/w3c-libwww/')
