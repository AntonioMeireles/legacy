loadSuperClass('gnomepackage', label='conary.rpath.com@rpl:devel')
loadInstalled('mozilla')
class Blam(GnomePackageRecipe):

    buildRequires = [ 'GConf:devel', 'GConf:runtime', 'ORBit2:devel', 'dbus-sharp:lib', 'desktop-file-utils:runtime', 'expat:devel', 'gecko-sharp:lib', 'gettext:runtime', 'gnome-keyring:devel', 'gnome-sharp:lib', 'gnome-vfs:devel', 'gtk-sharp:lib', 'libart_lgpl:devel', 'libbonobo:devel', 'libbonoboui:devel', 'libgnome:devel', 'libgnomecanvas:devel', 'libgnomeui:devel', 'libstdc++:devel', 'mono:devel', 'mono:lib', 'mono:runtime', 'nspr:devel', 'popt:devel', 'xulrunner:devel' ]

    name = 'blam'
    version = '1.8.4'
    externalArchive = 'http://www.cmartin.tk/%(name)s/%(name)s-%(version)s.tar.bz2'

    def unpack(r):

        GnomePackageRecipe.unpack(r)
        r.addSource('collection.xml')

    def build(r):
      #  r.macros.mozver = Mozilla.version
      #  r.macros.mozilladir = 'mozilla-%(mozver)s'
      #  r.Requires(rpath='%(libdir)s/%(mozilladir)s')
        r.Configure('--with-mozilla=xulrunner', configureName='./autogen.sh')
        r.Make(r.makeArgs, preMake=r.preMake)

        r.Requires(exceptDeps=r'soname\:\ ELF32\/libgtkembedmoz\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libxpcom\.so\(SysV\ x86\)')
