# Gil Hamlin
# gil@foresightlinux.com
# 10th October 2005

class ccache(PackageRecipe):
    buildRequires = [ 'glibc:devel' ]
    name = "ccache"
    version = "2.4"

    def setup(r):
        r.macros.optflags = "-g -O3"
        r.addArchive('http://ccache.samba.org/ftp/%(name)s/%(name)s-%(version)s.tar.gz')

        r.Configure()
        r.Make()
        r.MakeInstall()

    # set up ccache dir and symlink gcc into it

        r.MakeDirs('%(libdir)s/ccache/bin')
        #r.DanglingSymlinks(exceptions='%(libdir)s/ccache/bin/gcc')
        r.Symlink('/%(bindir)s/ccache','%(libdir)s/ccache/bin/gcc')
        r.addSource('ccache-set-paths.sh')
        r.Replace('/usr/lib','%(libdir)s','ccache-set-paths.sh')
        r.Install('ccache-set-paths.sh','%(sysconfdir)s/profile.d/')
