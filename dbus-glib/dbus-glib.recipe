#
# Copyright (c) 2007-2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadRecipe('rpmpackage')
class DBusGlib(RPMPackageRecipe,AutoPackageRecipe):
    name = 'dbus-glib'
    version = '0.80'
    rpmRelease = '3.fc12'


    buildRequires = [ 'dbus:devel', 'dbus:runtime', 'doxygen:runtime', 'expat:devel', 'gettext:runtime', 'glib:devel',
                      'libtool:runtime', 'pkgconfig:devel', 'xmlto:runtime', 'glib:runtime', 'gtk-doc:runtime', 'gtk-doc:devel',
                      'autoconf:runtime',  'automake:runtime']

    def configure(r):
        # FIXME: do not bump this to 0.82+ until we are positivelly sure that
        # bug bellow is fixed. patches in FDO do not cut it for us ...
        # fdo bug 23297 (PolicyKit et al.) 
        # r.addSource('http://bugs.freedesktop.org/attachment.cgi?id=29445')
        # r.addSource('http://bugs.freedesktop.org/attachment.cgi?id=29446')
        # r.addSource('http://bugs.freedesktop.org/attachment.cgi?id=29447')
       
        r.addSource('dbus-bus-introspect.xml', dir='tools', rpm=r.srpm)

        # r.Run('autoreconf -vfi')
        r.Configure(' --disable-verbose-mode '
                    ' --with-introspect-xml=dbus-bus-introspect.xml'
                    ' --disable-doxygen-docs'
                    ' --disable-tests --disable-asserts --disable-gtk-doc')

    def policy(r):
        r.SetModes('%(sysconfdir)s/bash_completion.d/dbus-bash-completion.sh', 0644)

