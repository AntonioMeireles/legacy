#
# Copyright (c) 2009 Foresight Linux Project
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('rpmpackage')
class XorgDriverInputEvtouch(RPMPackageRecipe, CPackageRecipe):
    name = 'xf86-input-evtouch'
    version = '0.8.7'
    rpmRelease = '7.2'
    rpmName = 'x11-input-evtouch'
    isOPENsuse = True
    isXOrgFactory = False

    buildRequires = [ 'pkgconfig:devel', 'ghostscript:runtime', 'linuxdoc-tools:runtime', 'xorg-server:devel', 'xproto:devel', 'fontsproto:devel', 'autoconf:runtime', 'automake:runtime', 'makedepend:runtime', 'randrproto:devel', 'inputproto:devel', 'kbproto:devel', 'pixman:devel', 'libtool:runtime', 'libtool:devel', 'pkgconfig:devel' , 'm4:runtime', 'expat:devel', 'xextproto:devel', 'util-macros:devel', 'renderproto:devel', 'sysfsutils:devel', 'xorg-sgml-doctools:data', 'sysfsutils:devel', 'xorg-sgml-doctools:data', 'libpciaccess:devel', 'libxkbfile:devel', 'libXi:devel', 'libX11:devel', 'imake:runtime', 'xorg-cf-files:data', 'gccmakedep:runtime', 'texinfo:runtime', 'which:runtime',
                      ]
    def setup(r):
        r.addArchive('%(name)s-%(version)s.tar.bz2', rpm=r.srpm)
        patches = [
            'evtouch-20080829-add_IDEACO_IDC_6680_Touchscreen_to_udev.diff',
            'evtouch-20080901-add_another_Panjit_touchset_device.diff',
            'evtouch-20081023-fix-compiler_warning.diff',
            'evtouch-20090125-memset.diff',
            'evtouch-dont_include_xf86_ansic_h.patch',
            'evtouch-misc-fixes.patch',
            'xorg-server-1.6.diff',
            ]

        for patch in patches:
            r.addPatch(patch, rpm=r.srpm)

        r.addPatch('fix_image.patch')
        r.Configure('--enable-udevinstall --enable-evcalibrate')
        r.Make()
        r.MakeInstall()
