# Copyright (c) 2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class PgPoolII(AutoPackageRecipe):
    name = "pgpool-II"
    version = "2.2"

    buildRequires = [
                      'flex:runtime',
                      'chkconfig:runtime',
                      'bison:runtime',
                      'postgresql:devel',
                    ]

    def unpack(r):
        r.addArchive("http://pgfoundry.org/frs/download.php/2108/%(name)s-%(version)s.tar.gz")
        r.addSource("pgpool.initd", dest="%(initdir)s/%(name)s", mode=0755, macros=1)

    def makeinstall(r):
        r.MakeInstall()
        r.Move("%(sysconfdir)s/pcp.conf.sample", "%(sysconfdir)s/pcp.conf")
        r.Move("%(sysconfdir)s/pgpool.conf.sample", "%(sysconfdir)s/pgpool.conf")
        r.Move("%(sysconfdir)s/pool_hba.conf.sample", "%(sysconfdir)s/pool_hba.conf")
        r.Move("%(bindir)s/pgpool", "%(sbindir)s/pgpool")

