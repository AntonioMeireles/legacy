#
# Copyright (c) 2006 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Oidentd(AutoPackageRecipe):
    name = 'oidentd'
    version = '2.0.8'
    buildRequires = [ 'chkconfig:runtime', 'flex:runtime', ]

    def unpack(r):
        r.addArchive('mirror://sourceforge/ojnk/')
        srpm = 'http://download.fedora.redhat.com/pub/fedora/linux/extras/development/SRPMS/oidentd-2.0.8-2.fc6.src.rpm'
        r.addSource('oidentd.init', rpm=srpm, dir='%(initdir)s/', mode=0755)
        r.addSource('oidentd.sysconfig', rpm=srpm, dest='%(sysconfdir)s/sysconfig/oidentd')

    def policy(r):
        # start initscript by default (RPL-418)
        r.Replace('chkconfig: -', 'chkconfig: 345', '%(initdir)s/*')
        r.UtilizeUser('nobody', '%(sbindir)s/oidentd')
        r.UtilizeGroup('nobody', '%(sbindir)s/oidentd')

