#
# Copyright (c) 2004-2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class MicrocodeCtl(CPackageRecipe):
    name = 'microcode_ctl'
    version = '1.17'

    def setup(r):
        r.addArchive('http://www.urbanmyth.org/microcode/')
        r.addSource('microcode_ctl.init')
        r.addSource('microcode-20080401.dat')
        r.addPatch('microcode_ctl.patch')

        r.Make(forceFlags=True)
        r.MakeDirs('%(sysconfdir)s/firmware')
        r.MakeInstall('PREFIX=%(prefix)s INSDIR=%(essentialsbindir)s')
        r.Install('microcode_ctl.init', '%(initdir)s/microcode_ctl', mode=0755)
        r.Install('microcode-20080401.dat', '%(sysconfdir)s/firmware/microcode.dat', mode=0644)
        r.TagSpec('initscript', '%(initdir)s/')
        r.Config(exceptions='%(sysconfdir)s/firmware/')
