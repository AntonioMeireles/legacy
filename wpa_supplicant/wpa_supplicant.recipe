class WpaSupplicant(CPackageRecipe):

	name = 'wpa_supplicant'
	version = '0.5.1'

	buildRequires = ['openssl:devel']

	def setup(r):
		r.addArchive('http://hostap.epitest.fi/releases/%(name)s-%(version)s.tar.gz')
		# PLEASE READ THIS!
		# These headers are from our version (2006-02-12) version
		# of madwifi-ng.
		# Needed because wpa_supplicant needs madwifi headers to
		# support this card
		r.addSource('madwifi-headers.tar.bz2')
		r.addAction('tar xjf madwifi-headers.tar.bz2')
		# Our .config file, needed for compilation
		r.addSource('wpa_supplicant.config')
		r.addAction('cp wpa_supplicant.config .config')
		# Our .conf file
		r.addSource('wpa_supplicant_foresight.conf')
		r.Make()
		# No make install, so we copy manually
		for x in ['wpa_cli', 'wpa_passphrase', 'wpa_supplicant']:
			r.Install(x, '%(sbindir)s/')
		# Copying conf file to /etc
		r.Install('wpa_supplicant_foresight.conf', '%(sysconfdir)s/wpa_supplicant.conf')
