#
# Copyright (c) 2004-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Expat(AutoPackageRecipe):
    name = 'expat'
    version = '2.0.0'

    srpm='ftp://ftp.redhat.com/redhat/linux/enterprise/5Server/en/os/SRPMS/expat-1.95.8-8.3.el5_5.3.src.rpm'

    def unpack(r):
        r.addArchive('http://downloads.sourceforge.net/project/expat/expat/2.0.0/expat-2.0.0.tar.gz?r=&ts=1297439074')
        #  r.addArchive('mirror://sourceforge/expat/')

        # CVE-2009-3560, RPL-3257
        r.addPatch('expat-1.95.8-CVE-2009-3560-revised.patch', rpm=r.srpm)
        # CVE-2009-3720, RPL-3257
        r.addPatch('expat-1.95.8-CVE-2009-3720.patch', rpm=r.srpm)



    def makeinstall(r):
        r.MakePathsInstall('man1dir=%(destdir)s/%(mandir)s/man1')
        # apr-util needs this file to link against expat
        r.RemoveNonPackageFiles(exceptions='%(libdir)s/libexpat.la')
