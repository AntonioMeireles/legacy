#
# Copyright (c) 2008-2009 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('kernelmodulepackage')
class VirtualboxKernel(KernelModulePackageRecipe):
    name = 'virtualbox-kernel'
    version = '2.0.2'
 
    buildRequires = [
        'autoconf:runtime',
        'file:runtime',
        'make:runtime',
      ]
 
    def unpack(r):
        r.addArchive('vbox-module-%(version)s-x86.tar.gz', use=Arch.x86)
        r.addArchive('vbox-module-%(version)s-x86_64.tar.gz', use=Arch.x86_64)
        r.addSource('vbox.modules', dir='/etc/sysconfig/modules/')
        r.Environment('KERN_DIR', '/lib/modules/%(kver)s/build/')

    def build(r):
        r.Make()

    def policy(r):
        r.ComponentProvides('%(version)s')

        # Kernel module requires sysconfig entry
        r.ComponentRequires({'config': ['lib']})
