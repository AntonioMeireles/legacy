#
# Copyright (c) 2004 Specifix, Inc.
# All rights reserved
#

class Setup(PackageRecipe):
    buildRequires = [ ]

    name = "setup"
    version = "2.5.27"
    
    def setup(r):
        r.macros.rpmrevision = "1"

        r.addArchive("setup-%(version)s.tar.bz2",
	    rpm="ftp://ftp.redhat.com/pub/redhat/linux/enterprise/3/en/os/i386/SRPMS/setup-%(version)s-%(rpmrevision)s.src.rpm")
	# our own versions with more uid/gid's
	r.addPatch('profile.patch')
	r.addSource("passwd")
	r.addSource("group")

        r.Install('*', '%(sysconfdir)s/')
        r.Remove('%(sysconfdir)s/shell.tag*')
        r.Create('%(sysconfdir)s/{shadow,gshadow}', mode=0400)
        r.Create('%(localstatedir)s/log/lastlog', mode=0400)
        r.Remove('/etc/uidgid', '/etc/serviceslint',
                 '/etc/setup.spec', '/etc/Makefile')
	r.Doc('uidgid')

	r.addSource('shell.tagdescription', macros=True)
	r.addSource('shell.taghandler', macros=True)
	r.Install('shell.tagdescription', '%(tagdescriptiondir)s/shell')
	r.Install('shell.taghandler', '%(taghandlerdir)s/shell', mode=0755)
