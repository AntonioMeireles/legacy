--- setup-2.5.47/bashrc.499	2006-01-31 16:24:57.000000000 -0500
+++ setup-2.5.47/bashrc	2006-01-31 16:26:32.000000000 -0500
@@ -37,7 +37,7 @@
     [ "$PS1" = "\\s-\\v\\\$ " ] && PS1="[\u@\h \W]\\$ "
 fi
 
-if ! shopt -q login_shell ; then # We're not a login shell
+if [ "$SHLVL" == "1" ]; then # do not recurse, load only in toplevel shell
         for i in /etc/profile.d/*.sh; do
 	    if [ -r "$i" ]; then
 	        . $i
