#
#
# Antonio Meireles
# 
# sbin.reboot.sh
#
# Copyright (c) 2004-2006 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Emacs(CPackageRecipe):

    buildRequires = [ 
        'alsa-lib:devel', 'atk:devel', 
        'cairo:devel', 'expat:devel', 
        'fontconfig:devel', 'freetype:devel', 
        'glib:devel', 'gtk:devel', 
        'install-info:runtime', 'libICE:devel', 
        'libSM:devel', 'libX11:devel', 
        'libXau:devel', 'libXdmcp:devel', 
        'libXft:devel', 'libXpm:devel', 
        'libXrender:devel', 'libjpeg:devel', 
        'libpng:devel', 'libtiff:devel', 
        'libungif:devel', 'ncurses:devel', 
        'pango:devel', 'perl:lib', 
        'pkgconfig:devel', 'zlib:devel'
        ]

    if Arch.x86:
        buildRequires.append('setarch:runtime')

    name = 'emacs'
    version = '23.0.0cvs09092006'


    def setup(r):
	#
	# this is Foresight. 
	#
	#  cvs -z3 -d:pserver:anonymous@cvs.savannah.gnu.org:/sources/emacs co emacs
	#  cd emacs
	#  cvs up -Pd -r emacs-unicode-2
	#
	# so emacs should have... gtk, pango, xft and so on...
	# http://www.emacswiki.org/cgi-bin/wiki/XftGnuEmacs
	#

	r.addArchive('%(name)s-%(version)s.tar.bz2')
    		
	r.Configure(' --with-x-toolkit=gtk --enable-font-backend '
		    ' --with-xft  --with-xpm'
		    ' --with-jpeg  --with-tiff '
		    ' --with-gif  --with-png  --with-freetype ')

	r.macros.mflags=''

	r.Make('bootstrap')
#	r.Make('bootstrap-clean', dir='lisp')
#	r.Make('compile ', dir='lisp')
#	r.Make('clean')
	r.Make()
	r.MakeInstall()
