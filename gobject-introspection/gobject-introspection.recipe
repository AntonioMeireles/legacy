#
# Copyright (c) 2009 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('gnomepackage')
class GobjectIntrospection(GnomePackageRecipe):

    name = 'gobject-introspection'
    # shot = '2cc97351'
    version = '0.6.10' # + '_' + shot

    buildRequires = [ 'flex:devel', 'libffi:devel',
                      'flex:runtime', 'python:devel', 'bison:runtime', 'Mesa:devel', 'libXfixes:devel']
    makeArgs = 'V=1'
    loadInstalled('python')

    

#    def unpack(r):
#        r.addGitSnapshot('git://git.gnome.org/gobject-introspection', tag = r.shot)
#        r.addAction('NOCONFIGURE=yes ./autogen.sh')

    def policy(r):
        r.Remove('%(bindir)s/barapp')
        # Move the python modules to the correct location
        r.macros.pyver = Python.majversion
        r.Move('%(libdir)s/%(name)s/giscanner', 
               '%(libdir)s/python%(pyver)s/site-packages/')

        r.Requires('gobject-introspection:devel', '%(bindir)s/g-ir-generate') 
        r.Requires('gobject-introspection:runtime', '%(datadir)s/aclocal/introspection.m4')
