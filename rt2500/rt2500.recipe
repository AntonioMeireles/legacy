loadSuperClass('kernelmodulepackage.recipe')
class Rt2500(KernelModulePackageRecipe):
    name = 'rt2500'
    version = '1.1.0_b4'
    buildRequires = [ 'kernel:build-tree' ]

    def unpack(r):
        r.macros.ksrcdir = '/lib/modules/%(kver)s/build'
        r.macros.modpath = '/lib/modules/%(kver)s/kernel/drivers/net/wireless'
        r.macros.version = r.version.replace('_', '-')
        r.addArchive('mirror://sourceforge/rt2400/')
        #Taken from Archlinux
        r.addPatch('http://cvs.archlinux.org/cgi-bin/viewcvs.cgi/*checkout*/network/rt2500/kernel-2.6.20.patch?rev=1.1&cvsroot=Extra&only_with_tag=CURRENT')

    def build(r):
        r.Make('KERNDIR=%(ksrcdir)s', dir='Module')

    def install(r):
        r.Install('Module/rt2500.ko', '%(modpath)s/')
