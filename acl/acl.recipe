#
# Copyright (c) 2004-2005 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('rpmpackage')
class Acl(RPMPackageRecipe,CPackageRecipe):
    name = 'acl'
    version = '2.2.47'
    rpmRelease = '5.fc12'
    rpmPatches = [ 'acl-2.2.3-multilib.patch',
                   'acl-2.2.39-build.patch',
                   'acl-2.2.39-path_max.patch',
                   'acl-2.2.47-params.patch',
                   'acl-2.2.45-exitcode.patch',
                   'acl-2.2.39-segfault.patch']
    tarballName = '%(name)s_%(version)s-1.tar.gz'

    buildRequires = [ 'gettext:runtime', 'libtool:runtime',
                      'attr:devel', 'autoconf:runtime',
                      'makedepend:runtime']

    def setup(r):
        RPMPackageRecipe.unpack(r)
        r.Run('autoconf; touch .census')

        r.Configure('--libdir=/%(lib)s --libexecdir=%(libdir)s')
        r.Make('LIBTOOL="libtool --tag=CC"')
        r.MakeInstall(rootVar='DIST_ROOT',
                      installtarget='install install-dev install-lib')

        # fix links to shared libs and permissions
        r.Remove('%(libdir)s/libacl.so')
        r.Symlink('../../%(lib)s/libacl.so', '%(libdir)s/libacl.so')
