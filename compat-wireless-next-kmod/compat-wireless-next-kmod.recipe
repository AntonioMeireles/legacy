#
# Copyright (c) 2008-2011 The Foresight Linux Project
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('kernelmodulepackage')
class CompatWirelessNext(KernelModulePackageRecipe):
    name = 'compat-wireless-next-kmod'
    version =  '2012_04_08'

    moduleDir = 'updates'
    buildRequires = [ 'which:runtime', ]

    def unpack(r):
        r.macros.version = r.macros.version.replace('_','-')
        r.addArchive('http://linuxwireless.org/download/compat-wireless-2.6/compat-wireless-%(version)s.tar.bz2')
        r.macros.moduledir = r.moduleDir

    def build(r):
        r.Make(' KVER=%(kver)s' 
               ' KLIB=/lib/modules/%(kver)s ')
               
    def install(r):
        r.Make(' KVER=%(kver)s' 
               ' KLIB=/lib/modules/%(kver)s '
               ' KMODDIR=%(moduledir)s'
               ' KMODPATH_ARG=\'INSTALL_MOD_PATH=%(destdir)s\''
               ' install-modules'
               )
