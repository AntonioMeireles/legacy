#
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('cmakepackage', 'foresight.rpath.org@fl:2-devel')
class Qca2(CMakePackageRecipe):

    name = 'qca2'
    version = '2.0.0'

    buildRequires = [
        'gcc-c++:runtime', 'libstdc++:devel', 'libX11:devel', 'libXext:devel',
        'qt4:devel'
    ]

    def unpack(r):

        r.cmakeArgs += ' -DQT_QMAKE_EXECUTABLE="%(bindir)s/qmake-qt4" '
        if Arch.x86_64:
            r.cmakeArgs += ' -DLIB_SUFFIX=64 '

        r.macros.archive_name = 'qca'
        r.addArchive('http://delta.affinix.com/download/qca/%(major_version)s/')

        # Build fix
        r.Replace('add_subdirectory\(plugins\)', '', 'CMakeLists.txt')

    def policy(r):

        r.Move('%(libdir)s/pkgconfig/qca.pc', '%(libdir)s/pkgconfig/qca2.pc')

