#
# Copyright (c) 2007 Paul Scott-Wilson <pscott>
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class NdeskDbusGlib(BuildPackageRecipe):
    name = 'ndesk-dbus-glib'
    version = '0.3'
    buildRequires = [ 'ndesk-dbus:devellib', 'ndesk-dbus:lib', 'mono:devel' ]

    def setup(r):
        r.Environment('MONO_SHARED_DIR', '/tmp')
        r.macros.archive_name = 'dbus-sharp-glib'
        r.addArchive('http://www.ndesk.org/archive/dbus-sharp/')
        r.addSource('include.mk')
        r.Replace('@prefix@', '%(prefix)s', 'ndesk-dbus-glib-1.0.pc.in', lines=1)
        r.Replace('/lib/', '/', 'ndesk-dbus-glib-1.0.pc.in', lines=9)
        r.Install('ndesk-dbus-glib-1.0.pc.in', '%(libdir)s/pkgconfig/ndesk-dbus-glib-1.0.pc')
        r.Replace('NDesk.DBus.dll', '/usr/lib/mono/ndesk-dbus-1.0/NDesk.DBus.dll', 'glib/Makefile')
        r.Replace('include.*', 'include ../include.mk', 'glib/Makefile')
        r.MakeInstall(dir='glib')
