#
# Copyright (c) 2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class CmpiBindings(AutoPackageRecipe):
    name = 'cmpi-bindings'
    svn_revision = '1177'
    version = '0.4.0.svn.' + svn_revision

    buildRequires = [
        'cmake:runtime',
        'gcc-c++:runtime',
        'perl:devel',
        'perl:runtime',
        'python:devel',
        'pywbem:python',
        'ruby:devellib',
        'ruby:runtime',
        'swig:runtime',
    ]

    def unpack(r):
        #r.addArchive('mirror://sourceforge/omc/%(name)s-%(version)s.tar.bz2')
        r.addSvnSnapshot('http://omc.svn.sourceforge.net/svnroot/omc/cmpi-bindings/trunk', revision = r.svn_revision)

    def configure(r):
        r.CMake(objDir = 'build')

    def make(r):
        r.Make(dir = 'build')

    def makeinstall(r):
        r.MakeInstall(dir = 'build')

    def policy(r):
        r.ComponentSpec('perl', 'libplCmpiProvider.so')
        r.ComponentSpec('python', 'libpyCmpiProvider.so')
        r.ComponentSpec('ruby', 'librbCmpiProvider.so')
        # Assume sfcb for now
        r.Requires('sblim-sfcb:runtime', 'lib.*\.so')
