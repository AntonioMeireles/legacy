#
# Copyright (c) 2008 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#
 
 
class zsnes(CPackageRecipe):
    name = 'zsnes'
    version = '1.5.1'
 
    buildRequires = ['Mesa:devel', 'SDL:devel', 'libpng:devel', 'libstdc++:devel', 'nasm:runtime', 'ncurses:devel', 'zlib:devel']
 
    def setup(r):
        r.addArchive('http://prdownloads.sourceforge.net/zsnes/zsnes151src.tar.bz2')
        r.addPatch('zsnes-1.51-pulseaudio.patch', dir = 'src/')
        #r.addPatch('zsnes-1.51-gcc43.patch', dir = 'src/')
        r.addPatch('zsnes-1.51-Makefile.in.FIX.BROKENESS.patch', dir = 'src/')
        r.addPatch('zsnes-1.51-FORTIFY_SOURCE.patch', dir = 'src/')
        r.macros.ldflags += ' -L%(libdir)s/xorg.mesa.3d/ '
    def configure(r):
        r.Configure(dir = 'src/')
        r.addPatch('zsnes-1.51-gcc43.patch', dir = 'src/')
        r.Make(dir = 'src/')
        r.MakeInstall(dir = 'src/')
