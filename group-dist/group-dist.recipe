#
# Copyright (c) 2004-2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Dist(GroupRecipe):
    name = 'group-dist'
    version = 'beta1'

    depCheck = True
    checkOnlyByDefaultDeps = True
    Flags.devel = True
    checkPathConflicts=False

    def startGroup(r, name, parentGroup, depCheck=False, byDefault=True,
                   checkPathConflicts=None, excludeComponents=True):
        # creates group named "name", adds it to the toplevel group,
        # and sets the current group to that name.  calls to r.add()
        # will use the current group by default.

        # note: byDefault applies to whether the group is included by
        # default in its parent group, not whether the troves in
        # the group are added by default. (use the setByDefault() command
        # to get that)

        r.setDefaultGroup(parentGroup)
        r.createGroup(name, autoResolve=False, depCheck=depCheck,
                      byDefault=True, checkPathConflicts=checkPathConflicts)
        r.addNewGroup(name, groupName=parentGroup, byDefault=byDefault)
        r.setDefaultGroup(name)
        if excludeComponents and not Flags.devel:
            r.removeComponents(['devel', 'devellib'])

    def setup(r):
        groupLabel=r.macros.buildlabel
        xenLabel='conary.rpath.com@rpl:2-xen-qa'
        r.setSearchPath(groupLabel)

        if Arch.x86:
            glibcFlavor32 = None # needed so we can control addition of troves with use=
            opensslFlavor = 'is: x86(i486,i586,i686)'
            if Use.xen:
                glibcFlavor = 'xen is: x86(i486,i586,i686)'
                kernelLabel = xenLabel
                if Use.dom0:
                    if Use.domU:
                        print "This recipe may be built with dom0 or domU, but cannot use both.\n"
                        sys.exit(1)
                    kernelFlavor = 'xen,dom0,kernel.smp,kernel.pae is: x86(i486,i586,i686)'
                    kernelFlavorPAE = None
                    mkinitrdFlavor = '!xen,!domU'
                    releaseFlavor = 'xen,dom0'
                if Use.domU:
                    kernelFlavor = 'xen,domU,kernel.smp,kernel.pae is: x86(i486,i586,i686)'
                    kernelFlavorPAE = None
                    mkinitrdFlavor = 'xen,domU'
                    releaseFlavor = 'xen,domU'
            elif Use.vmware:
                glibcFlavor = 'is: x86(i486,i586,i686)'
                kernelFlavor = 'kernel.smp,!kernel.pae is: x86(i486,i586,i686)'
                kernelFlavorPAE = None
                kernelLabel = groupLabel
                mkinitrdFlavor = '!xen,!domU'
                releaseFlavor = 'vmware'
            else:
                glibcFlavor = 'is: x86(i486,i586,i686)'
                kernelFlavor = 'kernel.smp,!kernel.pae is: x86(i486,i586,i686)'
                kernelFlavorPAE = 'kernel.smp,kernel.pae is: x86(i486,i586,i686)'
                kernelLabel = groupLabel
                mkinitrdFlavor = '!xen,!domU'
                releaseFlavor = None
        elif Arch.x86_64:
            kernelFlavorPAE = None
            opensslFlavor = None
            opensslFlavor32 = 'is: x86(i486,i586,i686)'
            if Use.xen:
                glibcFlavor = None
                glibcFlavor32 = 'xen is: x86(i486,i586,i686)'
                kernelLabel = xenLabel
                if Use.dom0:
                    if Use.domU:
                        print "This recipe may be built with dom0 or domU, but cannot use both.\n"
                        sys.exit(1)
                    kernelFlavor = 'xen,dom0,kernel.smp'
                    mkinitrdFlavor = '!xen,!domU'
                    releaseFlavor = 'xen,dom0'
                if Use.domU:
                    kernelFlavor = 'xen,domU,kernel.smp'
                    mkinitrdFlavor = 'xen,domU'
                    releaseFlavor = 'xen,domU'
            elif Use.vmware:
                glibcFlavor = None
                glibcFlavor32 = 'is: x86(i486,i586,i686)'
                kernelFlavor = 'kernel.smp'
                kernelLabel = groupLabel
                mkinitrdFlavor = '!xen,!domU'
                releaseFlavor = 'vmware'
            else:
                glibcFlavor = None
                glibcFlavor32 = 'is: x86(i486,i586,i686)'
                kernelFlavor = 'kernel.smp'
                kernelFlavorPAE = None
                kernelLabel = groupLabel
                mkinitrdFlavor = '!xen,!domU'
                releaseFlavor = None

        # turn off checkPathConflicts bc not everything in group-os can/should
        # coexist on the same system
        r.createGroup('group-os', checkPathConflicts=False, depCheck=True)
        r.addNewGroup('group-dist', groupName='group-os')

        r.startGroup('group-bootable', parentGroup='group-dist', depCheck=True)
        # components necessary to boot a system in any anaconda-supported
        # configuration and to login to said system and talk to a network.
        # specifically, this group does *not* include components necessary to
        # update the installed system using conary, raa, or any other in-band
        # method
        r.add('acl:lib')
        r.add('acl:runtime')
        r.add('amiconfig:config', use=(Use.xen and Use.domU))
        r.add('amiconfig:python', use=(Use.xen and Use.domU))
        r.add('amiconfig:runtime', use=(Use.xen and Use.domU))
        r.add('attr:lib')
        r.add('attr:runtime')
        r.add('audit:config')
        r.add('audit:lib')
        r.add('authconfig:config')
        r.add('authconfig:runtime')
        r.add('authconfig:python')
        r.add('bash:config')
        r.add('bash:runtime')
        r.add('bootman:config')
        r.add('bootman:lib')
        r.add('bootman:runtime')
        r.add('bridge-utils:runtime', use=(Use.xen and Use.dom0))
        r.add('bzip2:lib')
        r.add('chkconfig:runtime')
        r.add('coreutils:config')
        r.add('coreutils:runtime')
        r.add('cpio:runtime')
        r.add('cracklib:data')
        r.add('cracklib:lib')
        r.add('cyrus-sasl:config')
        r.add('cyrus-sasl:lib')
        r.add('db:lib')
        r.add('device-mapper:lib')
        r.add('device-mapper:runtime')
        r.add('dev:runtime', source='MAKEDEV')
        r.add('dhclient:lib', source='dhcp')
        r.add('dhclient:runtime', source='dhcp')
        r.add('distro-boot-config')
        r.add('distro-conary-config', flavor=releaseFlavor)
        r.add('distro-release')
        r.add('e2fsprogs:config')
        r.add('e2fsprogs:data')
        r.add('e2fsprogs:lib')
        r.add('e2fsprogs:runtime')
        r.add('ext3flush:runtime')
        r.add('extlinux:runtime', source='syslinux')
        r.add('filesystem:runtime')
        r.add('findutils:runtime')
        r.add('gawk:data')
        r.add('gawk:runtime')
        r.add('gdbm:lib')
        r.add('glibc:config', flavor=glibcFlavor)
        r.add('glibc:lib', flavor=glibcFlavor)
        r.add('glibc:lib', flavor=glibcFlavor32, use=Arch.x86_64)
        r.add('glibc:runtime', flavor=glibcFlavor)
        r.add('glib:data')
        r.add('glib:lib')
        r.add('grep:runtime')
        r.add('grub:data', flavor='grub.static is: x86')
        r.add('grub:runtime', flavor='grub.static is: x86')
        r.add('gzip:runtime')
        r.add('hwdata:config')
        r.add('info-daemon')
        r.add('info-disk')
        r.add('info-emerge')
        r.add('info-floppy')
        r.add('info-kmem')
        r.add('info-lock')
        r.add('info-lp')
        r.add('info-mail')
        r.add('info-sasldb')
        r.add('info-tty')
        r.add('info-users')
        r.add('info-utmp')
        r.add('info-uucp')
        r.add('info-vcsa')
        r.add('initscripts:config')
        r.add('initscripts:lib')
        r.add('initscripts:runtime')
        r.add('iproute:config')
        r.add('iproute:lib')
        r.add('iproute:runtime')
        r.add('iptables:config')
        r.add('iptables:lib')
        r.add('iptables:runtime')
        r.add('iputils:runtime')
        r.add('jfsutils:runtime')
        r.add('kernel:runtime', kernelLabel, flavor=kernelFlavor)
        r.add('krb5:data')
        r.add('krb5:lib')
        r.add('kudzu:config')
        r.add('kudzu:python')
        r.add('kudzu:runtime')
        r.add('libdhcp4client:lib', source='dhcp')
        r.add('libdhcp6client:lib', source='dhcpv6')
        r.add('libdhcp:lib')
        r.add('libgcc:lib', source='gcc')
        r.add('libnl:lib')
        r.add('libstdc++:lib', source='gcc')
        r.add('libtermcap:lib')
        r.add('libuser:config')
        r.add('libuser:lib')
        r.add('libuser:python')
        r.add('libuser:runtime')
        r.add('lvm2:config')
        r.add('lvm2:runtime')
        r.add('mdadm:config')
        r.add('mdadm:runtime')
        r.add('mingetty:runtime')
        r.add('mkinitrd:lib')
        r.add('mkinitrd:runtime')
        r.add('mktemp:runtime')
        r.add('module-init-tools:config')
        r.add('module-init-tools:runtime')
        r.add('ncurses:data')
        r.add('ncurses:lib')
        r.add('ncurses:runtime')
        r.add('net-tools:runtime')
        r.add('open-iscsi:config')
        r.add('open-iscsi:runtime')
        r.add('openssl:config')
        r.add('openssl:data')
        r.add('openssl:lib')
        r.add('pam:config')
        r.add('pam:data')
        r.add('pam:lib')
        r.add('parted:lib')
        r.add('passwd:config')
        r.add('passwd:runtime')
        r.add('pcre:lib')
        r.add('popt:lib')
        r.add('procps:lib')
        r.add('procps:runtime')
        r.add('psmisc:runtime')
        r.add('python:lib')
        r.add('python:runtime')
        r.add('qla-firmware:config')
        r.add('qla-firmware:lib')
        r.add('readline:lib')
        r.add('reiserfsprogs:runtime')
        r.add('rhpl:python')
        r.add('rootfiles:runtime')
        r.add('sed:runtime')
        r.add('setup:config')
        r.add('setup:runtime')
        r.add('shadow:config')
        r.add('shadow:runtime')
        r.add('slang:lib')
        r.add('sysfsutils:lib')
        r.add('sysfsutils:runtime')
        r.add('rsyslog:config')
        r.add('rsyslog:lib')
        r.add('rsyslog:runtime')
        r.add('sysvinit:runtime')
        r.add('termcap:config')
        r.add('tzdata:data')
        r.add('tzdata:runtime')
        r.add('udev:config')
        r.add('udev:data')
        r.add('udev:lib')
        r.add('udev:runtime')
        r.add('usermode:config')
        r.add('usermode:runtime')
        r.add('util-linux:config')
        r.add('util-linux:data')
        r.add('util-linux:runtime')
        r.add('vim-minimal:runtime', source='vim')
        r.add('wireless-tools:lib')
        r.add('xfsprogs:lib')
        r.add('xfsprogs:runtime')
        r.add('zlib:lib')

        r.startGroup('group-core', parentGroup='group-dist', depCheck=True)
        # Individual components required to boot the system in any
        # anaconda-supported install configuration, to log in to the system,
        # to run Conary including a network connection, and dependencies of
        # those troves.  It is the normal core of a software appliance.
        r.addNewGroup('group-bootable')
        r.add('bzip2:runtime')
        r.add('conary:config')
        r.add('conary:data')
        r.add('conary:python')
        r.add('conary:runtime')
        r.add('DirectFB:lib-core')
        r.add('file:data')
        r.add('file:lib')
        r.add('gmp:lib')
        r.add('hdparm')
        r.add('libelf-lgpl:lib')
        r.add('open-vm-tools:config', use=Use.vmware)
        r.add('open-vm-tools:lib', use=Use.vmware)
        r.add('open-vm-tools:runtime', use=Use.vmware)
        r.add('pycrypto:python')
        r.add('PyXML:python')
        r.add('sgmlop:python')
        r.add('splashy:config')
        r.add('splashy:data')
        r.add('splashy:lib')
        r.add('splashy:runtime')
        r.add('splashy-theme:config')
        r.add('splashy-theme:data')
        r.add('splashy-theme:runtime')
        r.add('sqlite:lib')

        r.startGroup('group-base', parentGroup='group-dist')
        # Adds functionality commonly found on Linux systems meant to
        # support login users; it is the smallest group recommended
        # for installing a general-purpose system.  These are not
        # necessarily required for appliances in general.
        # Also includes important :locale components relative
        # to group-core
        r.add('acpid')
        r.add('amiconfig', use=(Use.xen and Use.domU))
        r.add('ash')
        r.add('avahi')
        r.add('bind-utils', source='bind')
        r.add('bootman')
        r.add('bridge-utils')
        r.add('bzip2-extras', source='bzip2')
        r.add('ConsoleKit')
        r.add('crontabs')
        r.add('dbus')
        r.add('dbus-glib')
        r.add('dosfstools')
        r.add('ext3flush')
        r.add('glib')
        r.add('glibc', flavor=glibcFlavor)
        r.add('gpm')
        r.add('grub', flavor='grub.static is: x86')
        r.add('gzip-extras', source='gzip')
        r.add('hal')
        r.add('hal-info')
        r.add('info', source='texinfo')
        r.add('kbd')
        r.add('kudzu')
        r.add('less')
        r.add('libnfsidmap')
        r.add('logrotate')
        r.add('man')
        r.add('man-pages:doc')
        r.add('microcode_ctl', use=Arch.x86)
        r.add('mkinitrd')
        r.add('nfs-client', source='nfs-utils')
        r.add('nfs-utils')
        r.add('openssh-server', source='openssh')
        r.add('open-vm-tools', use=Use.vmware)
        r.add('PolicyKit')
        r.add('portmap')
        r.add('psmisc')
        r.add('smartmontools')
        r.add('smbios')
        r.add('termcap')
        r.add('tmpwatch')
        r.add('tzdata')
        r.add('udev')
        r.add('vim')
        r.add('vim-minimal', source='vim')
        r.add('vixie-cron')
        r.add('xen', use=(Use.xen and Use.dom0))

        r.startGroup('group-text-tools', parentGroup='group-dist')
        # General-purpose text tools, including general programs that
        # are useful without running X.  Must not pull in X via dependencies.
        r.add('acl')
        r.add('alsa-lib')
        r.add('alsa-utils')
        r.add('anacron')
        r.add('aspell')
        r.add('aspell-en')
        r.add('at')
        r.add('attr')
        r.add('authconfig')
        r.add('authconfig-tui', source='authconfig')
        r.add('autofs')
        r.add('bash')
        r.add('bc')
        r.add('cdda2wav', source='cdrtools')
        r.add('cdrtools')
        r.add('chkconfig')
        r.add('conary')
        r.add('coreutils')
        r.add('cpufrequtils')
        r.add('cracklib')
        r.add('curl')
        r.add('device-mapper')
        r.add('dhclient', source='dhcp')
        r.add('diffutils')
        r.add('distro-conary-config', flavor=releaseFlavor)
        r.add('distro-release')
        r.add('dmidecode')
        r.add('dvd+rw-tools')
        r.add('e2fsprogs')
        r.add('eject')
        r.add('elinks')
        r.add('ethtool')
        r.add('fetchmail')
        r.add('file')
        r.add('filesystem')
        r.add('findutils')
        r.add('finger')
        r.add('ftp')
        r.add('gnupg')
        r.add('grep')
        r.add('hdparm')
        r.add('hwdata')
        r.add('info', source='texinfo')
        r.add('initscripts')
        r.add('install-info', source='texinfo')
        r.add('ipmitool')
        r.add('iproute')
        r.add('iptables')
        r.add('iputils')
        r.add('jwhois')
        r.add('krb5-workstation', source='krb5')
        r.add('less')
        r.add('lftp')
        r.add('lm_sensors')
        r.add('lockdev')
        r.add('logwatch')
        r.add('lsof')
        r.add('lvm2')
        r.add('lynx')
        r.add('mailbase')
        r.add('mailcap')
        r.add('mailx')
        r.add('MAKEDEV')
        r.add('man')
        r.add('man-pages')
        r.add('mdadm')
        r.add('minicom')
        r.add('mkisofs', source='cdrtools')
        r.add('mktemp')
        r.add('module-init-tools')
        r.add('mtr')
        r.add('mutt')
        r.add('nano')
        r.add('nc')
        r.add('netpbm')
        r.add('net-tools')
        r.add('nmap')
        r.add('ntp')
        r.add('ntp-utils', source='ntp')
        r.add('ntsysv', source='mkinitrd')
        r.add('openldap-clients', source='openldap')
        r.add('openssh')
        r.add('openssh-client', source='openssh')
        r.add('openssl')
        r.add('pam')
        r.add('pam_krb5')
        r.add('pam_smb')
        r.add('passwd')
        r.add('patch')
        r.add('pciutils')
        r.add('pcmciautils')
        r.add('pilot-link')
        r.add('pinfo')
        r.add('pm-utils')
        r.add('ppp')
        r.add('procmail')
        r.add('procps')
        r.add('pump')
        r.add('qla-firmware')
        r.add('quota')
        r.add('reiserfsprogs')
        r.add('rootfiles')
        r.add('rp-pppoe')
        r.add('rsh')
        r.add('rsync')
        r.add('rusers')
        r.add('screen')
        r.add('sed')
        r.add('setserial')
        r.add('setup')
        r.add('setuptool')
        r.add('shadow')
        r.add('slocate')
        r.add('sudo')
        r.add('sysfsutils')
        r.add('syslinux')
        r.add('sysstat')
        r.add('sysvinit')
        r.add('talk')
        r.add('tar')
        r.add('tcpdump')
        r.add('tcp_wrappers')
        r.add('telnet')
        r.add('tftp')
        r.add('time')
        r.add('traceroute')
        r.add('urlgrabber')
        r.add('usbutils')
        r.add('utempter')
        r.add('util-linux')
        r.add('vconfig')
        r.add('vim')
        r.add('wget')
        r.add('which')
        r.add('wireless-tools')
        r.add('words')
        r.add('wvdial')
        r.add('wvstreams')
        r.add('x86info')
        r.add('xdelta')
        r.add('xfsprogs')
        r.add('ypbind')
        r.add('yp-tools')

        r.startGroup('group-netserver', parentGroup='group-dist')
        # daemons that provide public services, and their direct dependencies
        r.add('bind')
        r.add('cElementTree') # to speed up conary-repository
        r.add('conary-repository', source='conary')
        r.add('conary-web-common')
        r.add('elementtree')
        r.add('httpd')
        r.add('kid')
        r.add('krb5')
        r.add('mod_dav_svn', source='subversion')
        r.add('mod_python')
        r.add('mod_ssl', source='httpd')
        r.add('neon')
        r.add('nfs-server', source='nfs-utils')
        r.add('openssh-server', source='openssh')
        r.add('php')
        r.add('rdate')
        r.add('rdist')
        r.add('sendmail')
        r.add('sendmail-cf', source='sendmail')
        r.add('xinetd')

        if Arch.x86_64:
            r.startGroup('group-compat32', parentGroup='group-dist')
            # 32-bit libraries on 64-bit systems
            r.add('acl:lib', flavor='is: x86')
            r.add('alsa-lib:lib', flavor='is: x86')
            r.add('aspell:lib', flavor='is: x86')
            r.add('atk:lib', flavor='is: x86')
            r.add('attr:lib', flavor='is: x86')
            r.add('avahi:lib', flavor='is: x86')
            r.add('bzip2:lib', flavor='is: x86')
            r.add('cairo:lib', flavor='is: x86')
            r.add('cracklib:lib', flavor='is: x86')
            r.add('cups:lib', flavor='is: x86')
            r.add('curl:lib', flavor='is: x86')
            r.add('cyrus-sasl:lib', flavor='is: x86')
            r.add('db:lib', flavor='is: x86')
            r.add('dbus:lib', flavor='is: x86')
            r.add('e2fsprogs:lib', flavor='is: x86')
            r.add('expat:lib', flavor='is: x86')
            r.add('fontconfig:lib', flavor='is: x86')
            r.add('freetype:lib', flavor='is: x86')
            r.add('gdbm:lib', flavor='is: x86')
            r.add('glibc:devellib', flavor=glibcFlavor32)
            r.add('glibc:lib', flavor=glibcFlavor32)
            r.add('glib:lib', flavor='is: x86')
            r.add('gmp:lib', flavor='is: x86(sse,sse2)')
            r.add('gtk:lib', flavor='is: x86')
            r.add('icu:lib', flavor='is: x86')
            r.add('krb5:lib', flavor='is: x86')
            r.add('libart_lgpl:lib', flavor='is: x86')
            r.add('libcap:lib', flavor='is: x86')
            r.add('libgcrypt:lib', flavor='is: x86')
            r.add('libglade:lib', flavor='is: x86')
            r.add('libgpg-error:lib', flavor='is: x86')
            r.add('libgssapi:lib', flavor='is: x86')
            r.add('libICE:lib', flavor='is: x86')
            r.add('libidn:lib', flavor='is: x86')
            r.add('libjpeg:lib', flavor='is: x86')
            r.add('libmng:lib', flavor='is: x86')
            r.add('libmspack:lib', flavor='is: x86')
            r.add('libogg:lib', flavor='is: x86')
            r.add('libpng:lib', flavor='is: x86')
            r.add('libSM:lib', flavor='is: x86')
            r.add('libtermcap:lib', flavor='is: x86')
            r.add('libtiff:lib', flavor='is: x86')
            r.add('libtool:lib', flavor='is: x86')
            r.add('libusb:lib', flavor='is: x86')
            r.add('libX11:lib', flavor='is: x86')
            r.add('libXau:lib', flavor='is: x86')
            r.add('libXaw:lib', flavor='is: x86')
            r.add('libXcursor:lib', flavor='is: x86')
            r.add('libXdmcp:lib', flavor='is: x86')
            r.add('libXext:lib', flavor='is: x86')
            r.add('libXfixes:lib', flavor='is: x86')
            r.add('libXft:lib', flavor='is: x86')
            r.add('libXi:lib', flavor='is: x86')
            r.add('libXinerama:lib', flavor='is: x86')
            r.add('libxml2:lib', flavor='is: x86')
            r.add('libXmu:lib', flavor='is: x86')
            r.add('libXpm:lib', flavor='is: x86')
            r.add('libXrandr:lib', flavor='is: x86')
            r.add('libXrender:lib', flavor='is: x86')
            r.add('libxslt:lib', flavor='is: x86')
            r.add('libXt:lib', flavor='is: x86')
            r.add('mysql:lib', flavor='is: x86')
            r.add('ncurses:lib', flavor='is: x86')
            r.add('neon:lib', flavor='is: x86')
            r.add('OpenEXR:lib', flavor='is: x86')
            r.add('openldap:lib', flavor='is: x86')
            r.add('openssl:lib', flavor=opensslFlavor32)
            r.add('pam_krb5:lib', flavor='is: x86')
            r.add('pam:lib', flavor='is: x86')
            r.add('pam_smb:lib', flavor='is: x86')
            r.add('pango:lib', flavor='is: x86')
            r.add('pcre:lib', flavor='is: x86')
            r.add('popt:lib', flavor='is: x86')
            r.add('python:lib', flavor='is: x86')
            r.add('readline:lib', flavor='is: x86')
            r.add('samba:lib', flavor='is: x86')
            r.add('tcl:lib', flavor='is: x86')
            r.add('tcp_wrappers:lib', flavor='is: x86')
            r.add('tk:lib', flavor='is: x86')
            r.add('zlib:lib', flavor='is: x86')

        r.startGroup('group-X', parentGroup='group-dist')
        # Tools that are generally useful only for a graphical
        # desktop but are not specific to GNOME, KDE, or some
        # other desktop environment.  This includes all the
        # component of the x.org components that we build, but
        # does not include applications that belong in
        # group-X-applications.
        r.add('atk')
        r.add('bitmap-fonts')
        r.add('bitstream-vera-fonts')
        r.add('cairo')
        r.add('chkfontpath')
        r.add('encodings')
        r.add('font-adobe-100dpi')
        r.add('font-adobe-75dpi')
        r.add('font-adobe-utopia-100dpi')
        r.add('font-adobe-utopia-75dpi')
        r.add('font-adobe-utopia-type1')
        r.add('font-alias')
        r.add('font-arabic-misc')
        r.add('font-bh-100dpi')
        r.add('font-bh-75dpi')
        r.add('font-bh-lucidatypewriter-100dpi')
        r.add('font-bh-lucidatypewriter-75dpi')
        r.add('font-bh-ttf')
        r.add('font-bh-type1')
        r.add('font-bitstream-100dpi')
        r.add('font-bitstream-75dpi')
        r.add('font-bitstream-speedo')
        r.add('font-bitstream-type1')
        r.add('fontconfig')
        r.add('font-cronyx-cyrillic')
        r.add('font-cursor-misc')
        r.add('font-daewoo-misc')
        r.add('font-dec-misc')
        r.add('font-ibm-type1')
        r.add('font-isas-misc')
        r.add('font-jis-misc')
        r.add('font-micro-misc')
        r.add('font-misc-cyrillic')
        r.add('font-misc-ethiopic')
        r.add('font-misc-meltho')
        r.add('font-misc-misc')
        r.add('font-mutt-misc')
        r.add('font-schumacher-misc')
        r.add('font-screen-cyrillic')
        r.add('font-sony-misc')
        r.add('fonttosfnt')
        r.add('font-util')
        r.add('font-winitzki-cyrillic')
        r.add('font-xfree86-type1')
        r.add('freetype')
        r.add('fslsfonts')
        r.add('gtk')
        r.add('iceauth')
        r.add('luit')
        r.add('Mesa')
        r.add('mkfontdir')
        r.add('mkfontscale')
        r.add('pango')
        r.add('pixman')
        r.add('proxymngr')
        r.add('pyxf86config')
        r.add('rgb')
        r.add('SDL')
        r.add('SDL_image')
        r.add('SDL_net')
        r.add('sessreg')
        r.add('shared-mime-info')
        r.add('smproxy')
        r.add('switchdesk')
        r.add('ttmkfdir')
        r.add('twm')
        r.add('urw-fonts')
        r.add('x11-ssh-askpass')
        r.add('xauth')
        r.add('xbitmaps')
        r.add('xcmsdb')
        r.add('xdm')
        r.add('xdriinfo')
        r.add('xf86-input-acecad')
        r.add('xf86-input-aiptek')
        r.add('xf86-input-calcomp')
        r.add('xf86-input-citron')
        r.add('xf86-input-digitaledge')
        r.add('xf86-input-dmc')
        r.add('xf86-input-dynapro')
        r.add('xf86-input-elo2300')
        r.add('xf86-input-elographics')
        r.add('xf86-input-evdev')
        r.add('xf86-input-fpit')
        r.add('xf86-input-hyperpen')
        r.add('xf86-input-jamstudio')
        r.add('xf86-input-joystick')
        r.add('xf86-input-keyboard')
        r.add('xf86-input-magellan')
        r.add('xf86-input-magictouch')
        r.add('xf86-input-microtouch')
        r.add('xf86-input-mouse')
        r.add('xf86-input-mutouch')
        r.add('xf86-input-palmax')
        r.add('xf86-input-penmount')
        r.add('xf86-input-spaceorb')
        r.add('xf86-input-summa')
        r.add('xf86-input-tek4957')
        r.add('xf86-input-ur98')
        r.add('xf86-input-vmmouse')
        r.add('xf86-input-void')
        r.add('xf86-video-apm')
        r.add('xf86-video-ark')
        r.add('xf86-video-ati')
        r.add('xf86-video-chips')
        r.add('xf86-video-cirrus')
        r.add('xf86-video-cyrix')
        r.add('xf86-video-dummy')
        r.add('xf86-video-fbdev')
        r.add('xf86-video-glint')
        r.add('xf86-video-i128')
        r.add('xf86-video-i740')
        r.add('xf86-video-i810')
        r.add('xf86-video-imstt')
        r.add('xf86-video-mga')
        r.add('xf86-video-neomagic')
        r.add('xf86-video-newport')
        r.add('xf86-video-nsc')
        r.add('xf86-video-nv')
        r.add('xf86-video-rendition')
        r.add('xf86-video-s3')
        r.add('xf86-video-s3virge')
        r.add('xf86-video-savage')
        r.add('xf86-video-siliconmotion')
        r.add('xf86-video-sis')
        r.add('xf86-video-sisusb')
        r.add('xf86-video-tdfx')
        r.add('xf86-video-tga')
        r.add('xf86-video-trident')
        r.add('xf86-video-tseng')
        r.add('xf86-video-v4l')
        r.add('xf86-video-vesa')
        r.add('xf86-video-vga')
        r.add('xf86-video-via')
        r.add('xf86-video-vmware')
        r.add('xf86-video-voodoo')
        r.add('xfindproxy')
        r.add('xfs')
        r.add('xinit')
        r.add('xmodmap')
        r.add('xorg-server')
        r.add('xrandr')
        r.add('xrdb')
        r.add('xset')
        r.add('xsetmode')
        r.add('xsetpointer')
        r.add('xterm')
        r.add('xvinfo')

        r.startGroup('group-X-applications', parentGroup='group-dist')
        # Applications that are generally useful only if you have a graphical
        # desktop but are not specific to GNOME, KDE, or some
        # other desktop environment.
        r.add('glx-utils', source='Mesa')
        r.add('ImageMagick')
        r.add('setxkbmap')
        r.add('xcalc')
        r.add('xcursor-themes')
        r.add('xdpyinfo')
        r.add('xgamma')
        r.add('xhost')
        r.add('xkbcomp')
        r.add('xkeyboard-config')
        r.add('xkill')
        r.add('xlsatoms')
        r.add('xlsclients')
        r.add('xlsfonts')
        r.add('xmessage')
        r.add('xmore')
        r.add('xsetroot')
        r.add('xvidtune')
        r.add('xwd')
        r.add('xwud')

        r.startGroup('group-printing', parentGroup='group-dist')
        # Tools required to implement a direct or indirect print service on the
        # system.  These may not be required to enable talking directly to a
        # remote print queue from applications.
        r.add('a2ps')
        r.add('cups')
        r.add('enscript')
        r.add('ghostscript')
        r.add('foomatic-db')
        r.add('foomatic-db-engine')
        r.add('foomatic-filters')
        r.add('ghostscript-fonts')
        r.add('gutenprint')
        r.add('hplip')
        r.add('psutils')
        r.add('sane-backends') # required by hplip

        r.startGroup('group-dist-base', parentGroup='group-dist')
        # This group contains packages that provide libraries and other files which
        # resolve dependencies.  Components that are not required by
        # other components being installed will be installed only in an "everything"
        # install or if explicitly selected for installation.
        # The only time that components are included without their packages are
        # for the case of packages that are not entirely multilib-safe.
        r.add('audit')
        r.add('avahi-glib', source='avahi')
        r.add('avahi-tools', source='avahi')
        r.add('boost')
        r.add('busybox')
        r.add('db')
        r.add('dialog')
        r.add('distcache')
        r.add('fribidi')
        r.add('fuse')
        r.add('giflib')
        r.add('gmp')
        r.add('gpgme')
        r.add('hesiod')
        r.add('htmlview')
        r.add('icu')
        r.add('idle', source='python')
        r.add('info-adm')
        r.add('info-amanda')
        r.add('info-apache')
        r.add('info-avahi')
        r.add('info-beagleindex')
        r.add('info-bin')
        r.add('info-canna')
        r.add('info-cyrus')
        r.add('info-daemon')
        r.add('info-dbus')
        r.add('info-dip')
        r.add('info-disk')
        r.add('info-dovecot')
        r.add('info-exim')
        r.add('info-fax')
        r.add('info-fcron')
        r.add('info-floppy')
        r.add('info-ftp')
        r.add('info-games')
        r.add('info-gdm')
        r.add('info-gopher')
        r.add('info-haldaemon')
        r.add('info-halt')
        r.add('info-htt')
        r.add('info-ident')
        r.add('info-kmem')
        r.add('info-ldap')
        r.add('info-lock')
        r.add('info-lp')
        r.add('info-mail')
        r.add('info-mailman')
        r.add('info-mailnull')
        r.add('info-man')
        r.add('info-mem')
        r.add('info-mysql')
        r.add('info-named')
        r.add('info-netdump')
        r.add('info-news')
        r.add('info-nfsnobody')
        r.add('info-nobody')
        r.add('info-nscd')
        r.add('info-ntp')
        r.add('info-nut')
        r.add('info-operator')
        r.add('info-pcap')
        r.add('info-polkituser')
        r.add('info-postdrop')
        r.add('info-postfix')
        r.add('info-postgres')
        r.add('info-privoxy')
        r.add('info-pvm')
        r.add('info-quagga')
        r.add('info-quaggavt')
        r.add('info-radiusd')
        r.add('info-radvd')
        r.add('info-rmake')
        r.add('info-rmake-chroot')
        r.add('info-rpc')
        r.add('info-rpcuser')
        r.add('info-sasldb')
        r.add('info-shutdown')
        r.add('info-slocate')
        r.add('info-smmsp')
        r.add('info-squid')
        r.add('info-sshd')
        r.add('info-sync')
        r.add('info-sys')
        r.add('info-tomcat')
        r.add('info-tty')
        r.add('info-users')
        r.add('info-utmp')
        r.add('info-uucp')
        r.add('info-webalizer')
        r.add('info-wheel')
        r.add('info-wnn')
        r.add('info-xfs')
        r.add('ipvsadm')
        r.add('libassuan')
        r.add('libcap')
        r.add('libcroco')
        r.add('libdhcp')
        r.add('libdhcp4client', source='dhcp')
        r.add('libdhcp6client', source='dhcpv6')
        r.add('libdmx')
        r.add('libdrm')
        r.add('libelf', source='elfutils')
        r.add('libevent')
        r.add('libexif')
        r.add('libfontenc')
        r.add('libFS')
        r.add('libgcc', source='gcc')
        r.add('libgcrypt')
        r.add('libgpg-error')
        r.add('libgssapi')
        r.add('libICE')
        r.add('libidn')
        r.add('libieee1284')
        r.add('libjpeg')
        r.add('libksba')
        r.add('liblbxutil')
        r.add('libmal')
        r.add('libmng')
        r.add('libmspack')
        r.add('libnl')
        r.add('libogg')
        r.add('liboldX')
        r.add('libole2')
        r.add('libpcap')
        r.add('libpng')
        r.add('libpthread-stubs')
        r.add('librpcsecgss')
        r.add('libsigc++')
        r.add('libSM')
        r.add('libstdc++', source='gcc')
        r.add('libtermcap')
        r.add('libtiff')
        r.add('libtool')
        r.add('libusb')
        r.add('libuser')
        r.add('libX11')
        r.add('libXau')
        r.add('libXaw')
        r.add('libxcb')
        r.add('libXcomposite')
        r.add('libXcursor')
        r.add('libXdamage')
        r.add('libXdmcp')
        r.add('libXevie')
        r.add('libXext')
        r.add('libXfixes')
        r.add('libXfont')
        r.add('libXfontcache')
        r.add('libXft')
        r.add('libXi')
        r.add('libXinerama')
        r.add('libxkbfile')
        r.add('libxkbui')
        r.add('libXmu')
        r.add('libXpm')
        r.add('libXrandr')
        r.add('libXrender')
        r.add('libXres')
        r.add('libXScrnSaver')
        r.add('libXt')
        r.add('libXTrap')
        r.add('libXtst')
        r.add('libXv')
        r.add('libXvMC')
        r.add('libXxf86dga')
        r.add('libXxf86misc')
        r.add('libXxf86vm')
        r.add('lzo')
        r.add('mingetty')
        r.add('mysql:data')
        r.add('mysql:lib')
        r.add('MySQL-python')
        r.add('net-snmp')
        r.add('net-snmp-client', source='net-snmp')
        r.add('OpenEXR')
        r.add('open-iscsi')
        r.add('openldap')
        r.add('openslp')
        r.add('parted')
        r.add('pdksh')
        r.add('perl-Archive-Zip')
        r.add('perl-Compress-Zlib')
        r.add('perl-DateManip')
        r.add('perl-DBD-MySQL')
        r.add('perl-DBD-Pg')
        r.add('perl-DBD-SQLite')
        r.add('perl-DBI')
        r.add('perl-Digest-HMAC')
        r.add('perl-Digest-SHA1')
        r.add('perl-Filter')
        r.add('perl-Filter-Simple')
        r.add('perl-HTML-Parser')
        r.add('perl-HTML-Tagset')
        r.add('perl-IO-Socket-SSL')
        r.add('perl-IP-Country')
        r.add('perl-libwww-perl')
        r.add('perl-libxml-enno')
        r.add('perl-libxml-perl')
        r.add('perl-Net-DNS')
        r.add('perl-Net-IP')
        r.add('perl-Parse-Yapp')
        r.add('perl-SGMLS')
        r.add('perl-Time-HiRes')
        r.add('perl-URI')
        r.add('perl-XML-Dumper')
        r.add('perl-XML-Encoding')
        r.add('perl-XML-Grove')
        r.add('perl-XML-LibXML')
        r.add('perl-XML-LibXML-Common')
        r.add('perl-XML-NamespaceSupport')
        r.add('perl-XML-Parser')
        r.add('perl-XML-SAX')
        r.add('perl-XML-Simple')
        r.add('perl-XML-Twig')
        r.add('pinentry')
        r.add('postgresql')
        r.add('pwlib')
        r.add('PyPAM')
        r.add('pyparted')
        r.add('python:test')
        r.add('python-sqlite')
        r.add('samba')
        r.add('scgi')
        r.add('taglib')
        r.add('tcsh')
        r.add('umb-scheme')
        r.add('VFlib')
        r.add('w3c-libwww')
        r.add('Xaw3d')
        r.add('xmlsec')
        r.add('xtrans')

        r.startGroup('group-anaconda-deps', parentGroup='group-dist')
        # deps included only for anaconda-templates and their build-time deps
        r.add('at-spi')
        r.add('audiofile')
        r.add('cairomm')
        r.add('dbus')
        r.add('dbus-glib')
        r.add('esound')
        r.add('firstboot')
        r.add('gail')
        r.add('GConf')
        r.add('glib')
        r.add('glibmm')
        r.add('gnome-icon-theme')
        r.add('gnome-keyring')
        r.add('gnome-mime-data')
        r.add('gnome-python')
        r.add('gnome-python-extras')
        r.add('gnome-themes')
        r.add('gnome-vfs')
        r.add('gtk-engines')
        r.add('gtkhtml')
        r.add('gtkmm')
        r.add('gvim', source='vim')
        r.add('hicolor-icon-theme')
        r.add('icon-naming-utils')
        r.add('intltool')
        r.add('libart_lgpl')
        r.add('libbonobo')
        r.add('libbonoboui')
        r.add('libdaemon')
        r.add('libglade')
        r.add('libgnome')
        r.add('libgnomecanvas')
        r.add('libgnomeui')
        r.add('libgtkhtml')
        r.add('libIDL')
        r.add('libxml2')
        r.add('libxslt')
        r.add('ORBit2')
        r.add('pycairo')
        r.add('pygobject')
        r.add('pygtk')
        r.add('reiserfsprogs')
        r.add('rhpxl')
        r.add('system-config-date')
        r.add('system-config-keyboard')

        r.startGroup('group-devel', parentGroup='group-dist', excludeComponents=False)
        # All development tools
        # All development-related components (:devel, :devellib, :perl,
        # :python) from group-dist (automatically)
        # (group-os-devel has other development-related components)
        # This is a significant portion of the OS; the most important
        # difference between a group-devel and everything install is
        # that network services aren't automatically included in a
        # group-devel install.  (Additionally, other runtimes are
        # not automatically included, such as the X server.)
        # XXX: All groups listed below must be defined before group-devel.
        move = [':devellib', ':devel']
        copy = [':perl', ':python', ':java', ':cil', ':ruby']
        for group in ('base', 'text-tools', 'netserver', 'X', 'X-applications',
                      'printing', 'dist-base', 'anaconda-deps'):
            r.moveComponents(move, 'group-%s' % group, 'group-devel')
            r.copyComponents(copy, 'group-%s' % group, 'group-devel')
        r.add('apr')
        r.add('apr-util')
        r.add('autoconf')
        r.add('automake')
        r.add('bigreqsproto')
        r.add('binutils')
        r.add('bison')
        r.add('byacc')
        r.add('bzip2')
        r.add('cdecl')
        r.add('compositeproto')
        r.add('conary-build', source='conary')
        r.add('conary-policy')
        r.add('cpio')
        r.add('cproto')
        r.add('ctags')
        r.add('cvs')
        r.add('cyrus-sasl')
        r.add('damageproto')
        r.add('debugedit')
        r.add('dejagnu')
        r.add('desktop-file-utils')
        r.add('dev86')
        r.add('diffstat')
        r.add('diffutils')
        r.add('DirectFB')
        r.add('distcc')
        r.add('dmalloc')
        r.add('dmxproto')
        r.add('docbook-dsssl')
        r.add('docbook-dtds')
        r.add('docbook-xsl')
        r.add('dos2unix')
        r.add('ed')
        r.add('elfutils')
        r.add('epdb')
        r.add('evieext')
        r.add('expat')
        r.add('expect')
        r.add('expectk', source='expect')
        r.add('fixesproto')
        r.add('flex')
        r.add('fltk')
        r.add('fontcacheproto')
        r.add('fontsproto')
        r.add('gc')
        r.add('gcc')
        r.add('gcc-c++', source='gcc')
        r.add('gcc-fortran', source='gcc')
        r.add('gcc-java', source='gcc')
        r.add('gcc-objc', source='gcc')
        r.add('gdb')
        r.add('gdbm')
        r.add('gettext')
        r.add('git')
        r.add('glproto')
        r.add('gperf')
        r.add('groff')
        r.add('guile')
        r.add('gzip')
        r.add('indent')
        r.add('inputproto')
        r.add('jasper')
        r.add('kbproto')
        r.add('kernel', kernelLabel, flavor=kernelFlavor)
        r.add('latex2html')
        r.add('libelf-lgpl')
        r.add('ltrace')
        r.add('m2crypto')
        r.add('m4')
        r.add('make')
        r.add('mercurial')
        r.add('mercurial-hgk', source='mercurial')
        r.add('mono')
        r.add('monodoc')
        r.add('mpfr')
        r.add('mx')
        r.add('nasm')
        r.add('ncurses')
        r.add('newt')
        r.add('nose')
        r.add('openjade')
        r.add('opensp')
        r.add('oprofile')
        r.add('passivetex')
        r.add('patch')
        r.add('patchutils')
        r.add('pcre')
        r.add('perl')
        r.add('PIL')
        r.add('pkgconfig')
        r.add('poppler')
        r.add('popt')
        r.add('pth')
        r.add('pycrypto')
        r.add('python-setuptools')
        r.add('python') # the rest of python, including the :test component
        r.add('rake')
        r.add('randrproto')
        r.add('readline')
        r.add('recordproto')
        r.add('renderproto')
        r.add('resourceproto')
        r.add('rhpl')
        r.add('rmake')
        r.add('ruby')
        r.add('scrnsaverproto')
        r.add('setarch')
        r.add('sgml-common')
        r.add('sgmlop')
        r.add('sharutils')
        r.add('simplejson')
        r.add('slang')
        r.add('splashy')
        r.add('splashy-theme')
        r.add('splint')
        r.add('sqlite')
        r.add('strace')
        r.add('subversion')
        r.add('swig')
        r.add('tar')
        r.add('tcl')
        r.add('texi2html')
        r.add('texinfo')
        r.add('tk')
        r.add('trapproto')
        r.add('unifdef')
        r.add('unix2dos')
        r.add('unzip')
        r.add('usermode')
        r.add('userspace-kernel-headers')
        r.add('util-macros')
        r.add('videoproto')
        r.add('xcb-proto')
        r.add('xcmiscproto')
        r.add('xextproto')
        r.add('xf86bigfontproto')
        r.add('xf86dgaproto')
        r.add('xf86driproto')
        r.add('xf86miscproto')
        r.add('xf86rushproto')
        r.add('xf86vidmodeproto')
        r.add('xhtml1-dtds')
        r.add('xineramaproto')
        r.add('xmlto')
        r.add('xproto')
        r.add('xproxymanagementprotocol')
        r.add('zip')
        r.add('zlib')

        r.startGroup('group-rails', parentGroup='group-devel')
        r.add('rails')
        r.add('actionmailer')
        r.add('actionwebservice')
        r.add('actionpack')
        r.add('activerecord')
        r.add('activesupport')

        # The rest of this file is for group-os contents that are outside
        # of group-dist, and so these groups are not included on the
        # installation media

        r.startGroup('group-os-devel', parentGroup='group-os')
        # All development-related components (:devel, :devellib, :perl,
        # :python) from group-dist (automatically).  In addition, packages
        # which are build requirements but which we do not include on the
        # media.
        r.add('asciidoc')
        r.add('bdftopcf')
        r.add('docbook-utils')
        r.add('docbook-utils-pdf', source='docbook-utils')
        r.add('gccmakedep')
        r.add('imake')
        r.add('jadetex')
        r.add('linuxdoc-tools')
        r.add('makedepend')
        r.add('rcs')
        r.add('tetex')
        r.add('tetex-afm', source='tetex')
        r.add('tetex-dvips', source='tetex')
        r.add('tetex-fonts', source='tetex')
        r.add('tetex-latex', source='tetex')
        r.add('tetex-xdvi', source='tetex')
        r.add('xcursorgen')
        r.add('xorg-cf-files')
        r.add('xorg-sgml-doctools')

        r.startGroup('group-os-extras', parentGroup='group-os')
        # Maintained packages that are not included on the media but are included
        # in the distribution for some reason and do not best fit in some other
        # subgroup of group-os, such as group-os-devel.  This group may contain
        # path conflicts.
        r.setByDefault(False)
        r.add('acct')
        r.add('am-utils')
        r.add('anaconda')
        r.add('apmd', use=Arch.x86)
        r.add('appres')
        r.add('arpwatch')
        r.add('aspell-de')
        r.add('audit')
        r.add('authconfig-gtk', source='authconfig')
        r.add('bind')
        r.add('bitmap')
        r.add('bogl')
        r.add('booty')
        r.add('busybox')
        r.add('chkconfig-alternatives', source='chkconfig')
        r.add('cyrus-sasl-server', source='cyrus-sasl')
        r.add('devlabel')
        r.add('dhcp')
        r.add('dhcpv6')
        r.add('distcache')
        r.add('dmraid')
        r.add('dovecot')
        r.add('dump')
        r.add('editres')
        r.add('epic')
        r.add('fbset')
        r.add('finger-server', source='finger')
        r.add('floppy')
        r.add('fonts-chinese')
        r.add('fstobdf')
        r.add('gd')
        r.add('gparted')
        r.add('gpm')
        r.add('groff-x11', source='groff')
        r.add('ico')
        r.add('icon-slicer')
        r.add('inn')
        r.add('irda-utils')
        r.add('irqbalance')
        r.add('iso-codes')
        r.add('jfsutils')
        r.add('joe')
        r.add('kernel', kernelLabel, flavor=kernelFlavorPAE, use=(Arch.x86 and not Use.xen and not Use.vmware))
        r.add('krb5-server', source='krb5')
        r.add('krb5-services', source='krb5')
        r.add('lbxproxy')
        r.add('libaio')
        r.add('lighttpd')
        r.add('listres')
        r.add('longrun')
        r.add('lrzsz')
        r.add('mailman')
        r.add('mtools')
        r.add('mt-st')
        r.add('mysql')
        r.add('mysql-server', source='mysql')
        r.add('net-snmp-client', source='net-snmp')
        r.add('net-snmp-server', source='net-snmp')
        r.add('nmapfe', source='nmap')
        r.add('oclock')
        r.add('oidentd')
        r.add('openssl-scripts', source='openssl')
        r.add('pax')
        r.add('perl-Algorithm-Diff')
        r.add('perl-Archive-Tar')
        r.add('perl-IO-Zlib')
        r.add('perl-IP-Country')
        r.add('perl-Mail-SpamAssassin')
        r.add('perl-Mail-SPF-Query')
        r.add('perl-Net-CIDR-Lite')
        r.add('perl-Net-Ident')
        r.add('perl-Sys-Hostname-Long')
        r.add('perl-Text-Diff')
        r.add('php-mysql', source='php')
        r.add('php-pgsql', source='php')
        r.add('postfix')
        r.add('postgresql')
        r.add('pxelinux', source='syslinux')
        r.add('pyblock')
        r.add('PyGreSQL')
        r.add('pykickstart')
        r.add('quagga')
        r.add('radvd')
        r.add('rmt', source='dump')
        r.add('rstart')
        r.add('run')
        r.add('rusers-server', source='rusers')
        r.add('rwho')
        r.add('samba')
        r.add('samba-server', source='samba')
        r.add('samba-swat', source='samba')
        r.add('sane-frontends')
        r.add('scripts')
        r.add('shapecfg')
        r.add('showfont')
        r.add('squashfs')
        r.add('statserial')
        r.add('stunnel')
        r.add('symlinks')
        r.add('sysklogd') # includes pgsql and mysql bits
        r.add('tclx')
        r.add('ttfprint')
        r.add('units')
        r.add('util-linux-extras', source='util-linux')
        r.add('viewres')
        # FIXME: add back once vnc has been fixed.
        #r.add('vnc')
        r.add('vsftpd')
        r.add('x11perf')
        r.add('xbiff')
        r.add('xclipboard')
        r.add('xclock')
        r.add('xdbedizzy')
        r.add('xditview')
        r.add('xedit')
        r.add('xev')
        r.add('xeyes')
        r.add('xf86dga')
        r.add('xfd')
        r.add('xfontsel')
        r.add('xfsinfo')
        r.add('xfwp')
        r.add('xgc')
        r.add('xkbevd')
        r.add('xkbprint')
        r.add('xkbutils')
        r.add('xload')
        r.add('xlogo')
        r.add('xmag')
        r.add('xman')
        r.add('xmh')
        r.add('xmltex')
        r.add('xorg-docs')
        r.add('xplc')
        r.add('xpr')
        r.add('xprop')
        r.add('xrefresh')
        r.add('xrx')
        r.add('xsane')
        r.add('xsm')
        r.add('xstdcmap')
        r.add('xtrap')
        r.add('xwininfo')
        r.add('ypserv')
        r.add('zisofs-tools')

        # Group appliance platform
        r.startGroup('group-appliance-platform', parentGroup='group-os', depCheck=True)
        r.addNewGroup('group-core')
        r.add('device-mapper:lib')
        r.add('lvm2:runtime')
        r.add('acpid:config')
        r.add('acpid:runtime')
        r.add('curl:lib')
        r.add('crontabs:config')
        r.add('crontabs:runtime')
        r.add('dmidecode:runtime')
        r.add('ethtool:runtime')
        r.add('info-ntp')
        r.add('info-rpc')
        r.add('info-rpcuser')
        r.add('libelf:lib')
        r.add('libevent:lib')
        r.add('libgssapi:lib')
        r.add('librpcsecgss:lib')
        r.add('libnfsidmap:lib')
        r.add('libusb:lib')
        r.add('lm_sensors:config')
        r.add('lm_sensors:lib')
        r.add('logrotate:config')
        r.add('logrotate:lib')
        r.add('logrotate:runtime')
        r.add('net-snmp:data')
        r.add('net-snmp:lib')
        r.add('net-snmp:runtime')
        r.add('nfs-client:runtime')
        r.add('nfs-utils:runtime')
        r.add('ntp:config')
        r.add('ntp:runtime')
        r.add('openldap:config')
        r.add('openldap:lib')
        r.add('openssl:runtime')
        r.add('pciutils:runtime')
        r.add('perl:runtime')
        r.add('perl:lib')
        r.add('portmap:runtime')
        r.add('tcp_wrappers:lib')
        r.add('usbutils:data')
        r.add('usbutils:runtime')
        r.add('vixie-cron:config')
        r.add('vixie-cron:runtime')
        r.add('w3c-libwww:data')
        r.add('w3c-libwww:lib')

        if Use.dom0:
            # A fairly small dom0 group which can be used for ISO images.
            r.startGroup('group-dom0-server', parentGroup='group-os', depCheck=True,
                          byDefault=False)

            # What we need...
            r.addNewGroup('group-core')

            r.startGroup('group-dom0', parentGroup='group-dom0-server')

            # What we want...
            r.add('bridge-utils')
            r.add('dmidecode:runtime')
            r.add('ethtool:runtime')
            r.add('httpd:config')
            r.add('httpd:lib')
            r.add('httpd:runtime')
            r.add('jfsutils:runtime')
            r.add('lvm2:runtime')
            r.add('openssh:config')
            r.add('openssh:data')
            r.add('openssh:runtime')
            r.add('openssh-client:config')
            r.add('openssh-client:runtime')
            r.add('openssh-server:config')
            r.add('openssh-server:runtime')
            r.add('pciutils:runtime')
            r.add('reiserfsprogs:runtime')
            # r.add('vnc:runtime')
            r.add('wget')
            r.add('xen')
            r.add('xfsprogs:lib')
            r.add('xfsprogs:runtime')

            # The deps to make it all work...
            r.add('alsa-lib:data')
            r.add('alsa-lib:lib')
            r.add('apr:lib')
            r.add('apr-util:lib')
            r.add('device-mapper:lib')
            r.add('device-mapper:runtime')
            r.add('expat:lib')
            r.add('fontconfig:config')
            r.add('fontconfig:lib')
            r.add('fontconfig:runtime')
            r.add('freetype:lib')
            r.add('info-apache')
            r.add('info-sshd')
            r.add('libgssapi:lib')
            r.add('libjpeg:lib')
            r.add('libpng:lib')
            r.add('libX11:data')
            r.add('libX11:lib')
            r.add('libXau:lib')
            r.add('libXdmcp:lib')
            r.add('libXext:lib')
            r.add('libxml2:lib')
            r.add('libXrandr:lib')
            r.add('libXrender:lib')
            r.add('libxml2:lib')
            r.add('mailcap:config')
            r.add('make:runtime')
            r.add('mod_python')
            r.add('openldap:config')
            r.add('openldap:lib')
            r.add('perl:lib')
            r.add('perl:runtime')
            r.add('PyPAM:python')
            r.add('SDL:lib')
            r.add('tcp_wrappers:lib')
