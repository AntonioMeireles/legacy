#
# Copyright (c) 2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('rpmpackage')
class X11InputWacom(RPMPackageRecipe, AutoPackageRecipe):
    name = 'x11-input-wacom'
    version = '0.8.1'
    rpmRelease = '33.9'
    isOPENsuse = True
    isXOrgFactory = True

    buildRequires = [  'libICE:devel', 'ncurses:devel', 'tcl:runtime',
                       'libX11:devel', 'libXi:devel', 'pkgconfig:devel',
                       'autoconf:runtime', 'libtool:runtime',
                       'libtool:devel', 'libtool:runtime', 'util-macros:devel',]

    tarballName = 'linuxwacom-%(version)s-4.tar.bz2'

    rpmPatches = [ 'linuxwacom-20080901-fix-find_devices.diff',  ]
    rpmSources = [ '65-wacom.rules' ]

    def unpack(r):
        RPMPackageRecipe.unpack(r)
        r.Run('libtoolize --force; autoreconf -fi')
        r.Install('65-wacom.rules', '%(sysconfdir)s/udev/rules.d/', mode = 0644)

    def configure(r):
        r.macros.optflags += ' -fno-strict-aliasing  '

        configureArgs =  '--enable-wacdump --enable-libwacomcfg --enable-dlloader  '
        configureArgs += '--with-xmoduledir=/usr/%(lib)s/xorg/modules/input --with-xlib=/usr/%(lib)s'
        if Arch.x86_64:
            configureArgs += ' --enable-xserver64 '

        r.Configure(configureArgs)
        
