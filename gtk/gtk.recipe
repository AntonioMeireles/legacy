#
# Copyright (c) 2004-2005 rpath, Inc.
# All rights reserved
#

class Gtk2(PackageRecipe):

    buildRequires = [ 'atk:devel', 'pango:devel', 'glib:devel',
		      'libtiff:devel', 'libjpeg:devel', 'libpng:devel',
		      'automake:runtime' ]
    if Use.builddocs:
	buildRequires.append('gtk-doc:runtime')
    name = 'gtk'
    version = '2.8.3'

    def setup(r):
        r.addArchive('http://ftp.gnome.org/pub/GNOME/sources/gtk+/2.8/gtk+-%(version)s.tar.bz2')

	r.addSource('gtk-input-method.tagdescription', macros=True)
	r.addSource('gtk-input-method.taghandler', macros=True)
	r.addSource('gdk-pixbuf-loader.tagdescription', macros=True)
	r.addSource('gdk-pixbuf-loader.taghandler', macros=True)

	extraConfigure = ''
	if not Use.builddocs:
	    extraConfigure += ' --disable-gtk-doc'
	r.Configure('--with-xinput=xfree' + extraConfigure)
	r.Make()

	r.MakeInstall('RUN_QUERY_IMMODULES_TEST=false'
		      ' RUN_QUERY_LOADER_TEST=false')
	r.MakeDirs('%(sysconfdir)s/gtk-2.0')

	r.Install('gtk-input-method.tagdescription',
	          '%(tagdescriptiondir)s/gtk-input-method')
	r.Install('gdk-pixbuf-loader.tagdescription',
		  '%(tagdescriptiondir)s/gdk-pixbuf-loader')

	r.Install('gtk-input-method.taghandler',
	          '%(taghandlerdir)s/gtk-input-method', mode=0755)
	r.Install('gdk-pixbuf-loader.taghandler',
		  '%(taghandlerdir)s/gdk-pixbuf-loader', mode=0755)

	r.Doc('AUTHORS', 'COPYING', 'ChangeLog', 'NEWS', 'README',
	      'docs/tutorial', 'docs/faq', 'examples')
