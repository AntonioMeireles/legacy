#
# Copyright (c) 2007 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('gnomepackage')
class Seahorse(GnomePackageRecipe):
    name = 'seahorse'
    version = '1.0.1'
    buildRequires = [ 'GConf:devel', 'GConf:runtime', 'ORBit2:devel', 'avahi-glib:devel', 'avahi:devel', 'dbus-glib:runtime', 'desktop-file-utils:runtime', 'epiphany:devel', 'gcc-c++:runtime', 'gedit:devel', 'gnome-keyring:devel', 'gnome-panel:devel', 'gnome-vfs:devel', 'gnupg:runtime', 'gpgme:devel', 'gtksourceview:devel', 'libart_lgpl:devel', 'libbonobo:devel', 'libbonoboui:devel', 'libglade:devel', 'libgnome:devel', 'libgnomecanvas:devel', 'libgnomeprint:devel', 'libgnomeprintui:devel', 'libgnomeui:devel', 'libgpg-error:devel', 'libnotify:devel', 'libsoup:devel', 'nautilus:devel', 'nspr:devel', 'openldap:devel', 'openssh-client:runtime', 'openssh:runtime', 'popt:devel', 'scrollkeeper:runtime', 'shared-mime-info:runtime', 'xulrunner:devel', 'gnome-doc-utils:runtime', 'gnome-doc-utils:devel']

    def unpack(r):
        GnomePackageRecipe.unpack(r)
        r.addPatch('fix_context_menu_crash.patch') # (FL-318)
        r.Replace('accepted_versions=\"1.2 1.4\"',' accepted_versions=\"1.2 1.4 2.0\"','configure')
        r.extraConfig='--disable-update-mime-database --disable-scrollkeeper --with-gecko=xulrunner'
        r.disableParallelMake()

    def policy(r):
        if Arch.x86:
            r.Requires(exceptDeps=r'soname\:\ ELF32\/libgtkembedmoz\.so\(SysV\ x86\)')
            r.Requires(exceptDeps=r'soname\:\ ELF32\/libxpcom\.so\(SysV\ x86\)')
        else:
            r.Requires(exceptDeps=r'soname\:\ ELF64\/libgtkembedmoz\.so\(SysV\ x86\_64\)')
            r.Requires(exceptDeps=r'soname\:\ ELF64\/libxpcom\.so\(SysV\ x86\_64\)')

