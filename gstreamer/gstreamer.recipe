#
# Copyright (c) 2004-2005 Specifix, Inc.
# All rights reserved
#

loadRecipe('gnomepackage.recipe')
class Gstreamer(GnomePackageRecipe):

    buildRequires = [ 'glib:devel', 'libxml2:devel', 'bison:runtime',
                      'zlib:devel', 'popt:devel', 'gettext:runtime',
                      'flex:runtime' ]
                     
    extraConfig  = '--disable-plugin-builddir --disable-tests --disable-examples'
    extraConfig += ' --with-cachedir=%(localstatedir)s/cache/gstreamer-%(majversion)s'
    
                      
    if Use.builddocs:
        buildRequires.extend([ 'openjade:runtime', 'python:runtime',
                               'docbook-dsssl:runtime', 'transfig:runtime',
                               'docbook-xsl:runtime', 'netpbm:runtime',
                               'docbook-dtds:runtime', 'docbook-utils:runtime',
                               'transfig:runtime' ])
        extraConfig += ' --enable-docs-build '\
            '--with-html-dir=$RPM_BUILD_ROOT%(datadir)s/gtk-doc/html'
                               
    name = 'gstreamer'
    version = '0.8.9'
    
    docs = ['AUTHORS', 'COPYING', 'README', 'TODO',
            'ABOUT-NLS', 'REQUIREMENTS', 'DOCBUILDING']

    def unpack(r):
	r.macros.majver = '0.8'
        GnomePackageRecipe.unpack(r)
	r.addSource('gstreamerplugin.tagdescription', macros=True)
	r.addSource('gstreamerplugin.taghandler', macros=True)
		    
    def install(r):
        GnomePackageRecipe.install(r)
	r.Install('gstreamerplugin.tagdescription',
		  '%(tagdescriptiondir)s/gstreamerplugin')
	r.Install('gstreamerplugin.taghandler',
		  '%(taghandlerdir)s/gstreamerplugin', mode=0755)
        r.ComponentSpec('runtime', '/usr/lib/%(name)s-%(majversion)s/')
	r.Provides(exceptions=['/usr/lib/%(name)s-%(majversion)s/'])
        r.Remove('/usr/lib/%(name)s-%(majversion)s/*.a')
