#
# Copyright (c) 2004-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('gnomepackage')
loadSuperClass('rpmpackage')
class Libbonobo(RPMPackageRecipe,GnomePackageRecipe):
    name = 'libbonobo'
    version = '2.20.0'
    isOPENsuse = True
    rpmRelease = '5'
    rpmPatches = [ 'libbonobo-strict-aliasing.patch',
                   'libbonobo-includes.patch',
                   'bonobo-activation-config.patch'
                   ]

    buildRequires = [ 'libxml2:devel', 'ORBit2:devel', 
        'intltool:runtime', 'glib:devel', 'popt:devel',
        'bison:runtime', 'flex:runtime', 'gettext:runtime',
        'glib:runtime', 'perl:lib', 'perl:runtime',
        'procps:runtime' ]

    docs = ['doc/NAMESPACE']

    def unpack(r):
        RPMPackageRecipe.unpack(r)

        if Arch.x86_64:
            r.Replace('/lib/', '/lib64/', 'utils/bonobo-slay.in')
            r.Replace('/usr/local/lib/bonobo/servers','/usr/local/lib64/bonobo/servers','bonobo-activation-config.xml')

    def install(r):
        r.disableParallelMake()
        GnomePackageRecipe.install(r)
        r.Remove('%(libdir)s/bonobo-2.0/samples/bonobo-echo-2',
                 '%(bindir)s/echo-client-2',
                 '%(libdir)s/bonobo/monikers/*.a',
                 '%(libdir)s/orbit-2.0/*.a')
