#
# Copyright (c) 2005-2006 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('rpmpackage.recipe', label='conary.rpath.com@rpl:devel')
class SystemConfigNetwork(RPMPackageRecipe):
    name = 'system-config-network'
    version = '1.3.91'

    buildRequires = [ 'desktop-file-utils:runtime', 'intltool:runtime',
        'newt:python', 'rhpl:python', 'gawk:runtime', 'glibc:runtime',
        'perl:runtime', 'gettext:runtime', 'gnome-python:python',
        'kudzu:python', 'pygtk:python', 'perl-XML-Parser:perl', ]

    def setup(r):
        r.unpack()
        # patch from redhat bugzilla #146291, fixes rPath bug #615
        r.addPatch('system-config-network-1.3.17-modprobe.patch', level=0)

        r.Configure()
        r.Make()
        r.MakeInstall()
        for desktopfile in ('neat.desktop', 'neat-control.desktop'):
            r.Desktopfile(desktopfile)
            r.Remove('%%(datadir)s/applications/%s' % desktopfile)

        for trove in ('rhpl:python', 'pygtk:python', 'gnome-python:python'):
            r.Requires(trove, '%(bindir)s/system-config-network')

        # :runtime should not depend on GUI elements
        r.ComponentSpec(catchall='gtk')
        r.ComponentSpec('runtime', '.*-(tui|cmd)')
        r.ComponentSpec('runtime', '.*-(tui|cmd).py')
        # :runtime, therefore, should not depend on :data, but :gtk should
        r.ComponentRequires({'data': set(('gtk',))})

