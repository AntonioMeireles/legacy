#
# Copyright (c) 2007-2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('gnomepackage')
loadSuperClass('rpmpackage')
class FSpot(RPMPackageRecipe,GnomePackageRecipe):
    name = 'f-spot'
    version = '0.6.1.2'
    rpmRelease = '2.fc12'
    rpmPatches = [ # http://bugzilla.gnome.org/show_bug.cgi?id=593243
                   '0001-fix-parallel-build.patch',
                   # Use system mono-addins
                   '0001-use-system-Mono.Addins-if-available.patch',
                   # unmount cameras before importing
                   '0002-enhance-the-f-spot-import-script.patch',
                   # upstream patch to fix crash in facebook exporter:
                       # commit 807dab4344ecdadc7e46793369821de8b49692e5
                   # commit b87604bc9782bf92f053aaf3ceb739a32f44ea13
                   'facebook-exporter-duplicate-label-fix.patch',        ]

    buildRequires = [ 'GConf:runtime', 'desktop-file-utils:runtime', 'gnome-sharp:devellib',
                      'gnome-sharp:cil', 'gtk-sharp:devellib', 'gtk-sharp:cil',
                      'gtk:devellib', 'lcms:devel', 'libexif:devel',
                      'libgnome:devellib', 'libgnomeui:devel', 'libjpeg:devel',
                      'libusb:devellib', 'mono:devel', 'mono:cil',
                      'mono:runtime', 'rarian:runtime', 'rarian:devel',
                      'libxslt:runtime', 'gnome-doc-utils:devel', 'gnome-doc-utils:runtime',
                      'libgphoto2:devel', 'libgphoto2:devellib',  'gnome-desktop-sharp:cil', 
                      'ndesk-dbus:cil', 'ndesk-dbus:devellib', 'gnome-desktop-sharp:devellib',
                      'ndesk-dbus-glib:cil', 'ndesk-dbus-glib:devellib','beagle:devel',
                      'mono-addins:cil', 'mono-addins:devellib', 'gtk-sharp:runtime']

    extraConfig = ' --disable-scrollkeeper'
    
    def unpack(r):
        RPMPackageRecipe.unpack(r)
        r.Environment('MONO_SHARED_DIR', '/tmp')
        r.disableParallelMake()

    def policy(r):
        r.Requires('libgphoto2:lib', '%(bindir)s/%(name)s')
