#
# Copyright (c) 2004-2006 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('rpmpackage')
class Pciutils(RPMPackageRecipe,CPackageRecipe):
    name = 'pciutils'
    version = '2.2.3'

    rpmRelease = '4'
    rpmPatches = [
                   'pciutils-strip.patch',
                   'pciutils-2.1.10-scan.patch',
                   'pciutils-havepread.patch',
                   'pciutils-devicetype.patch',
                   'pciutils-2.2.1-idpath.patch',
                   'pciutils-2.1.99-gcc4.patch',
                   'pciutils-2.2.3-multilib.patch',
                   'pciutils-2.2.3-sata.patch'
                 ]

    def setup(r):
        r.disableParallelMake()

        r.unpack()

        r.Make('PREFIX=%(prefix)s OPT="%(cflags)s"')

        r.Install('lspci', 'setpci', '%(essentialsbindir)s/', mode=0755)
        r.Install('lspci.8', 'setpci.8', '%(mandir)s/man8/')
        r.Install('lib/libpci.a', '%(libdir)s/')
        r.Install('lib/{pci,header,config,types}.h', '%(includedir)s/pci/')
