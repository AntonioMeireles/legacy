#
# Copyright (c) 2012 The Foresight Linux Project
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('binarypackage')
class AdobeReader(BinaryPackageRecipe):
    name = 'adobe-reader'
    version = '9.5.1'
 
    buildRequires = [
        'Mesa:devel', 
        'atk:devel', 
        'desktop-file-utils:runtime', 
        'fontconfig:devel', 
        'gdk-pixbuf:devel', 
        'glib:devel', 
        'gtk:devel', 
        'libX11:devel', 
        'libXext:devel', 
        'libXt:devel', 
        'libgcc:devellib', 
        'libidn:devel', 
        'libstdc++:devel', 
        'libxml2:devel', 
        'pango:devel', 
        'zlib:devel',
            ]
 
    archive = 'http://ardownload.adobe.com/pub/adobe/reader/unix/9.x/9.5.1/enu/AdbeRdr9.5.1-1_i486linux_enu.tar.bz2'

    installPath = "/opt/"

    def unpack(r):
        r.addArchive(r.archive)

    def setup(r):
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libACE\.so\(SysV\ VERSION\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libAGM\.so\(SysV\ VERSION\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libBIB\.so\(SysV\ VERSION\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libCoolType\.so\(SysV\ VERSION\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libBIBUtils\.so\(SysV\ VERSION\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libResAccess\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libWRServices\.so\(SysV\ x86\)')

        r.unpack()

        #r.MakeDirs(r.installPath)
        r.Run("tar -xf COMMON.TAR")
        r.Run("tar -xf ILINXR.TAR")

        r.Copy("Adobe",r.installPath)

        r.addSource('adobe-reader.desktop')
        r.Desktopfile('adobe-reader.desktop')
        
	#r.addSource('acroread')
	#r.Install('acroread','%(bindir)s/acroread')        

        #r.Run("./INSTALL --install_path=/opt/Adobe/Reader")

        r.Symlink("/opt/Adobe/Reader9/bin/acroread","/usr/bin/acroread")
