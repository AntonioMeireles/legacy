#
# Copyright (c) 2004-2005 rpath, Inc.
# All rights reserved
#

loadSuperClass('kernelmodulepackage')
class Ipw2100(KernelModulePackageRecipe):

    name = 'ipw2100'
    version = '1.1.2'

    buildRequires = [ 'ieee80211:devel' ]

    def unpack(r):
        r.addArchive('http://unc.dl.sourceforge.net/sourceforge/%(name)s/%(name)s-%(version)s.tgz')

        # Fix compilation error.
        r.Replace(('ieee80211_header_data', 'ieee80211_hdr_3addr'), 'ipw2100.h')

        # Remove depmod from the Makefile.
        r.Replace(('/sbin/depmod.*', '@/bin/true'), 'Makefile')

    def build(r):
        r.MakeInstall('KVER=%(kver)s'
                      ' IEEE80211_INC=/lib/modules/%(kver)s/build/include'
                      ' KMISC=%(destdir)s/lib/modules/%(kver)s/kernel/drivers/net/wireless/')
        r.AutoDoc('CHANGES')
        r.Requires('ieee80211:lib', '/lib/modules/.*')
