#
# Copyright (c) 2005-2008 rPath, Inc.
# This file is distributed under the terms of the MIT License
# For a copy visit http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('phpapppackage=contrib.rpath.org@rpl:devel')
class phpMyAdmin(PHPAppPackageRecipe):
    name = 'phpMyAdmin'
    version = '2.11.4'

    buildRequires =  [ 'perl:lib', 'perl:runtime', ]

    def unpack(r):
        r.extractArchive('mirror://sourceforge/phpmyadmin/phpMyAdmin-%(version)s-all-languages.tar.bz2')
        r.MakeWriteableDirs('%(approot)s/config')

        r.macros.dirconf = '''
        AllowOverride FileInfo Options
        php_admin_flag safe_mode off
        php_value   memory_limit 16M

        AuthType Basic
        AuthName "MySQL admin area"
        AuthShadow on
        require user web
        '''

        r.Requires('php-mysql:lib','%(approot)s/index.php')
        r.Requires('php:lib','%(approot)s/index.php')
        r.Requires('mod_auth_shadow:lib','%(approot)s/index.php')

