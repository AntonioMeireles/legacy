#
# Copyright (c) 2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

import datetime
loadSuperClass('cmakepackage')
class Quassel(CMakePackageRecipe):

    name = 'quassel'
    version = '0.3.0+'+datetime.date.today().strftime("%Y%m%d")

    buildRequires = [
        'libstdc++:devel', 'openssl:devel', 'qt4:devel'
    ]

    def unpack(r):

        r.cmakeArgs += ' -DCMAKE_SKIP_RPATH=TRUE '

        r.addGitSnapshot('git://git.quassel-irc.org/quassel.git')

        r.addSource('quassel.desktop', dir='%(datadir)s/applications/')
        r.addSource('quassel-client.desktop', dir='%(datadir)s/applications/')

    def makeinstall(r):

        for app in ('quassel', 'quasselclient',  'quasselcore'):
            r.Install(app, '%(bindir)s/')

        r.Install(
            'src/icons/quassel/connected/128.png',
            '%(datadir)s/icons/hicolor/128x128/apps/quassel.png'
        )

    def policy(r):

        r.Doc('dev-notes/*')
        r.AutoDoc(exceptions='/.+/')

        r.TagSpec('desktop-file', '%(datadir)s/applications/')
        r.TagSpec('gtk-update-icon-cache', '%(datadir)s/icons/')

