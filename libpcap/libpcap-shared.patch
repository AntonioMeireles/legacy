--- libpcap-0.8.3/Makefile.in.shared	2003-12-14 20:42:23.000000000 -0500
+++ libpcap-0.8.3/Makefile.in	2004-10-11 14:29:33.135139024 -0400
@@ -22,6 +22,10 @@
 #
 # Various configurable paths (remember to edit Makefile.in, not Makefile)
 #
+MAJOR=%(major)s
+MINOR=%(minor)s
+SUBMINOR=%(subminor)s
+VERSION = $(MAJOR).$(MINOR).$(SUBMINOR)
 
 # Top level hierarchy
 prefix = @prefix@
@@ -48,7 +52,7 @@
 LIBS = @V_LIBS@
 
 # Standard CFLAGS
-CFLAGS = $(CCOPT) $(INCLS) $(DEFS)
+CFLAGS = $(CCOPT) $(INCLS) $(DEFS) -fPIC -DPIC
 
 INSTALL = @INSTALL@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
@@ -94,9 +98,14 @@
 TAGFILES = \
 	$(SRC) $(HDR) $(TAGHDR)
 
-CLEANFILES = $(OBJ) libpcap.a $(GENSRC) $(GENHDR) lex.yy.c
 
-all: libpcap.a
+
+CLEANFILES = $(OBJ) libpcap.a $(GENSRC) $(GENHDR) lex.yy.c libpcap.so.$(VERSION)
+
+all: libpcap.a libpcap.so.$(VERSION)
+
+libpcap.so.$(VERSION):
+	gcc -shared -Wl,-soname -Wl,libpcap.so.$(VERSION) -o libpcap.so.$(VERSION) $(OBJ) -lc
 
 libpcap.a: $(OBJ)
 	@rm -f $@
@@ -155,6 +164,10 @@
 	[ -d $(DESTDIR)$(libdir) ] || \
 	    (mkdir -p $(DESTDIR)$(libdir); chmod 755 $(DESTDIR)$(libdir))
 	$(INSTALL_DATA) libpcap.a $(DESTDIR)$(libdir)/libpcap.a
+	$(INSTALL_DATA) libpcap.so.$(VERSION)  $(DESTDIR)$(libdir)/libpcap.so.$(VERSION)
+	ln -s libpcap.so.$(VERSION) $(DESTDIR)$(libdir)/libpcap.so
+	ln -s libpcap.so.$(VERSION) $(DESTDIR)$(libdir)/libpcap.so.$(MAJOR)
+	ln -s libpcap.so.$(VERSION) $(DESTDIR)$(libdir)/libpcap.so.$(MAJOR).$(MINOR)
 	$(RANLIB) $(DESTDIR)$(libdir)/libpcap.a
 	[ -d $(DESTDIR)$(includedir) ] || \
 	    (mkdir -p $(DESTDIR)$(includedir); chmod 755 $(DESTDIR)$(includedir))
