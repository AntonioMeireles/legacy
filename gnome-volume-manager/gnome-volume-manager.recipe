loadRecipe('gnomepackage.recipe')
class Gvm(GnomePackageRecipe):

    buildRequires = GnomePackageRecipe.buildRequires
    buildRequires.extend([ 'hal:devel', 'dbus:devel' ])

    name = 'gnome-volume-manager'
    version = '1.3.4'

    externalArchive = 'http://primates.ximian.com/~fejj/gvm/%(name)s-%(version)s.tar.gz'
        
    def unpack(r):
	GnomePackageRecipe.unpack(r)
	r.extraConfig += ' --with-mount-command="/usr/bin/pmount-hal %%h" --with-unmount-command="/usr/bin/pumount %%d"'

	r.addPatch('defaults.patch')
	r.addPatch('multiseat.patch')
	#r.addPatch('01_fix_nonmountable_media.patch')
	#r.addPatch('03_kernel_hint.patch')
	r.addPatch('04_reconnect_on_dbus_exit.patch')
	r.addPatch('05_mount_at_start.patch')
	#r.addPatch('06_pmount_crypt.patch')
	#r.addPatch('07_automount_enabled_hint.patch')
	#r.addPatch('99_autotools.patch')

    def install(r):
	GnomePackageRecipe.install(r)
	r.Requires('pmount:runtime','%(bindir)s/gnome-volume-manager')
