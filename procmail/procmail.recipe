#
# Copyright (c) 2004-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Procmail(CPackageRecipe):
    name = 'procmail'
    version = '3.22'

    def setup(r):
        r.addArchive('ftp://ftp.procmail.org/pub/procmail/')
        r.addSource('http://www.linux.org.uk/~telsa/BitsAndPieces/procmailrc',
            dest='%(thisdocdir)s/telsa_procmailrc')
        # from RH config, modified for local conventions
        r.addPatch('procmail-3.22-config.patch')

        r.Replace('/var/spool/mail', '%(servicedir)s/spool/mail',
            'src/{autoconf,authenticate.c}')

        r.MakeInstall('BASENAME=%(destdir)s%(prefix)s'
                      ' MANDIR=%(destdir)s%(mandir)s')

        r.SetModes('%(bindir)s/{lockfile,procmail}', 02755)
        r.Ownership('root', 'mail', '%(bindir)s/lockfile',
                    '%(bindir)s/procmail')

        r.Doc('Artistic', 'FEATURES', 'HISTORY',
              'KNOWN_BUGS', 'examples')
