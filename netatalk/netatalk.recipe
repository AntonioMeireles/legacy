#
# Copyright (c) 2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Netatalk(CPackageRecipe):
    name = 'netatalk'
    version = '2.0.3'

    buildRequires = ['db:devel=:1-compat', 'openssl:devel', 'pam:devel',
        'perl:devel', 'perl:runtime', 'procps:runtime', 'chkconfig:runtime']

    def setup(r):
        r.addArchive('mirror://sourceforge/%(name)s/')
        
        r.Configure()
        r.Make()
        r.MakeInstall()

        r.Make('rc.atalk.redhat', dir = 'distrib/initscripts/')
        r.Install('distrib/initscripts/rc.atalk.redhat', '%(initdir)s/atalk', mode = 0755)

        # plan9 shell not supported, removing this script
        r.Remove('%(bindir)s/acleandir.rc')

        # removing file shipped with glibc
        r.Remove('%(includedir)s/netatalk/at.h')

        r.Config(exceptions = '%(sysconfdir)s/netatalk/uams/.*')
