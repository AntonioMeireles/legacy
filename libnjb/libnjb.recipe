# Original by Gil Hamlin
# Modified by Cesar Cardoso

class libnjb(CPackageRecipe):
    buildRequires = ['binutils:runtime', 'doxygen:runtime', 'glibc:devel', 'libusb:devel', 'ncurses:devel', 'zlib:devel']
    name = "libnjb"
    version = "2.2.5"

    def setup(r):
	r.addSource('10-usb-music-players-libnjb.fdi')
	r.addSource('20-usb-player-libnjb-policy.fdi')
        r.addArchive('http://kent.dl.sourceforge.net/sourceforge/%(name)s/%(name)s-%(version)s.tar.gz')
	r.Configure()
	r.Make()
	r.MakeInstall()
# Needed to let user control the music player
# Copied from SUSE's libnjb package
	r.Install('10-usb-music-players-libnjb.fdi', '%(datadir)s/hal/fdi/information/10freedesktop/')
# Inspired by gphoto's tutorial in http://www.gphoto.org/doc/manual/permissions-usb.html
	r.Install('20-usb-player-libnjb-policy.fdi', '%(datadir)s/hal/fdi/policy/20thirdparty/')
# Depending on setprocperm so HAL can make its magic and let the user fill their player
	r.Requires('setprocperm:runtime', '10-usb-music-players-libnjb.fdi')
	r.Requires('setprocperm:runtime', '20-usb-player-libnjb-policy.fdi')
