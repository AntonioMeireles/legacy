
loadSuperClass('rpmpackage')
class DeviceKitDisks(RPMPackageRecipe,AutoPackageRecipe):
    buildRequires = [ 'dbus-glib:devel', 'dbus:devel', 'glib:devel',
                      'libxslt:runtime', 'pkgconfig:devel', 'udev:devel',
                      'DeviceKit:devel', 'polkit:devel', 'gettext:runtime',
                      'intltool:runtime', 'libusb:devel', 'sg3_utils:devel',
                      'parted:devel', 'device-mapper:devel', 'udev:devel',
                      'libatasmart:devel', 'sqlite:devel', 'zlib:devel']

    name = "DeviceKit-disks"
    version = '009'
    rpmRelease = '3.fc12'
    rpmPatches = [ '0001-Update-udev-rules-to-cope-better-with-device-mapper.patch',
                   '0001-Bug-24885-LVM-LVs-now-have-NOPOLICY-0.patch', ]

    def configure(r):
        r.Replace('-Werror', '', 'configure')
        # FIXME: get manpages generation to work inside mooks
        r.Configure('--disable-gtk-doc --disable-man-pages')

    def policy(r):
        # add runtime Requires - see RH srpm
        r.SetModes('%(sysconfdir)s/profile.d/devkit-disks-bash-completion.sh', 0644)
        r.NonBinariesInBindirs(exceptions = '%(sysconfdir)s/profile.d/devkit-disks-bash-completion.sh')
        r.SetModes('%(localstatedir)s/run/DeviceKit-disks', 0770)
        r.SetModes('%(localstatedir)s/lib/DeviceKit-disks', 0770)
        
