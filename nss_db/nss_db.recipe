#
# Copyright (c) 2013 The Foresight Linux Project
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

# This will conflict with newer versions of glibc that use a different
# format for the db files (not berkeley db).
#
# http://sourceware.org/git/?p=glibc.git;a=commitdiff;h=2666d441c2d8107b1987b869714189af64b954c6
# http://sourceforge.net/p/nssdb/home/Home/
#
# The makedb command here is optional, in that any bindings may be
# correctly used to create db files that can be read by this version
# of nss_db, but in the future versions of glibc, the makedb command
# will be required in order to create the glibc-specific database
# format that will be required.
#
# Therefore, this package should not be included in Foresight Linux 3
# unless collisions with glibc are somehow resolved.

class Nss_db(AutoPackageRecipe):
    name = 'nss_db'
    version = '2.5'
 
    buildRequires = [ 'db:devel', ]
 
    def unpack(r):
        r.macros.localstatedir = '%(localstatedir)s/db'
        r.addArchive('mirror://sourceforge/nssdb/')
        r.addPatch('destdir.patch')
        # derived from https://bugzilla.redhat.com/show_bug.cgi?id=751461
        r.addPatch('supplemental-group-fix.patch')
