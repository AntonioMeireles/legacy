#
# Copyright (c) 2004 Specifix, Inc.
# All rights reserved
#

class FirstBoot(PackageRecipe):
    buildRequires = [ 'intltool:runtime', 'libuser:python',
	'newt:python', 'pygtk:python' ]
    name = "firstboot"
    version = "1.3.42"

    def setup(r):
        r.addArchive('%(name)s-%(version)s.tar.bz2')
	r.addPatch('sudo.patch')
	r.addPatch('firstboot-1.3.33-race.patch')

        r.Replace('RPM_BUILD_ROOT', 'INSTROOT', 'po/Makefile')
        r.Replace('python2', 'python',
                  'src/{firstboot,runTextWindow}.py', 'src/firstboot')
        # needs to run before prefdm!
        r.Replace('chkconfig: 35 95 95',
                  'chkconfig: 35 17 95', 'firstboot.init')
        r.Remove('src/pixmaps/rhn*png')
        r.Remove('src/modules/additional_cds.py')
	r.addSource('splash.png')
        r.Make()
        r.MakeInstall(rootVar='INSTROOT')
	r.Install('splash.png', '%(datadir)s/firstboot/pixmaps/splash.png')
	r.Install('splash.png', '%(datadir)s/firstboot/pixmaps/splash-small.png')
