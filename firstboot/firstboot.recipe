#
# Copyright (c) 2004-2006 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#


class FirstBoot(PackageRecipe):
    buildRequires = [ 'intltool:runtime', 'libuser:python',
	'newt:python', 'pygtk:python', 'kudzu:python',
	'pyxf86config:python', 'rhpl:python' ]

    name = "firstboot"
    version = "1.3.42"

    def setup(r):
       r.addArchive('%(name)s-%(version)s.tar.bz2')
       r.addPatch('sudo.patch')
       r.addPatch('firstboot-1.3.33-race.patch')

       r.Replace('RPM_BUILD_ROOT', 'INSTROOT', 'po/Makefile')
       r.Replace('python2', 'python',
                  'src/{firstboot,runTextWindow}.py', 'src/firstboot')
       r.Replace('7e8ea0','679167','src/firstbootWindow.py')
       # needs to run before prefdm!
       r.Replace('chkconfig: 35 95 95',
                  'chkconfig: 35 03 95', 'firstboot.init')
       r.Replace('/etc/X11/X','/usr/X11R6/bin/Xorg','src/firstboot.py')
       r.Remove('src/pixmaps/rhn*png')
       r.Remove('src/modules/additional_cds.py')
       r.addSource('splash.png')
       r.Make()
       r.MakeInstall(rootVar='INSTROOT')
       r.Install('splash.png', '%(datadir)s/firstboot/pixmaps/splash.png')
       r.Install('splash.png', '%(datadir)s/firstboot/pixmaps/splash-small.png')
