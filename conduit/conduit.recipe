#
# Copyright (c) 2007-2008 Foresight Linux Project
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadRecipe('gnomepackage')
class Conduit(GnomePackageRecipe):

    name = 'conduit'
    version = '0.3.16'

    buildRequires = [ 'dbus-python:python', 'dbus:devel', 'desktop-file-utils:runtime', 'gettext:runtime', 'gnome-python:python', 'libgmail:python', 'perl:runtime', 'pkgconfig:devel', 'pygobject:python', 'pygoocanvas:devellib', 'pygoocanvas:python', 'pygtk:devel', 'pygtk:python', 'python-sqlite:python', 'vobject:python', 'perl-XML-Parser:perl', 'gtk:devel', 'pygtk:devel', 'evolution-python:devellib', 'evolution-python:python', 'gnome-common:runtime', 'python-dateutil:python', 'PIL:python', 'gnome-python-extras:python', 'libgpod:python', 'rarian:devel', 'rarian:runtime', 'simplejson:python', 'gnome-doc-utils:devel', 'python:devel', 'pycairo:python', 'libxslt:runtime', 'gdata-python:python', 'gst-python:python', 'python-feedparser:python',  ]

    extraConfig = ' --enable-evolution --disable-scrollkeeper'
    def unpack(r):
        GnomePackageRecipe.unpack(r)
        r.Replace('\"GnomeVfs\"','\"GIO\"', 'conduit/defs.py.in')
        # get rid of any shebangs
        r.Run(""" for file in `find conduit/{dataproviders,hildonui,modules} -type f -print`; do  
sed -i '/#!/d' $file 
done
 """)
    def policy(r):
        r.Requires('python-dateutil:python','%(bindir)s/start_conduit')
        r.Requires('PyXML:python','%(bindir)s/start_conduit')
        r.Requires('gdata-python:python','%(bindir)s/start_conduit')
