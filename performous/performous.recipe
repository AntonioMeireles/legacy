#
# Copyright (c) 2010 - 2012 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#
import datetime
class Performous(AutoPackageRecipe):
    name = 'performous'
    version = 'cbc51ff6b75f81dcc3ff045f5f158387e21a0748' + '+' + datetime.date.today().strftime("%Y.%m.%d")
 
    buildRequires = ['ImageMagick:devel', 'Mesa:devel', 'SDL:devel', 'alsa-lib:devel', 'boost:devel', 'cairo:devel', 'cmake:runtime', 'desktop-file-utils:runtime', 'ffmpeg:devel', 'freetype:devel', 'gcc-c++:runtime', 'gettext:runtime', 'glew:devel', 'glib:devel', 'glibmm:devel', 'gstreamer:devel', 'gtk:devel', 'jack:devel', 'libjpeg:devel', 'libpng:devel', 'librsvg:devel', 'libsigc++:devel', 'libstdc++:devel', 'libtiff:devel', 'libxml++:devel', 'libxml2:devel', 'pango:devel', 'pkgconfig:devel', 'portaudio:devel', 'pulseaudio:devel', 'zlib:devel']
 
    def unpack(r):
        r.addGitSnapshot('git://git.performous.org/gitroot/performous/performous')
        r.macros.ldflags +='-L%(libdir)s/xorg.mesa.3d/ '
        r.MakeDirs('Build')

    def configure(r):
        r.Run('cmake -DCMAKE_BUILD_TYPE=None -DCMAKE_INSTALL_PREFIX=%(prefix)s -DCMAKE_LIBRARY_PATH=%(libdir)s -DLibDA_PLUGIN_GSTREAMER=1 -DLibDA_PLUGIN_JACK=1 -DLibDA_PLUGIN_PULSE=1 ..', dir='Build')
        
    def make(r):
        r.Make(dir='Build')
    
    def makeinstall(r):
        r.MakeInstall(dir='Build')
