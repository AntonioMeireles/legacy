#
# Copyright (c) 2004-2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('binarypackage=conary.rpath.com@rpl:devel')
class Skype(BinaryPackageRecipe):

    name = 'skype'
    version = '2.1.0.81'

    def unpack(r):

        r.addArchive('http://download.skype.com/linux/')

        files = [
            ('skype', '%(bindir)s/skype.bin'),
            ('skype.desktop', '%(datadir)s/applications/'),
            ('skype.conf', '%(sysconfdir)s/dbus-1/system.d/'),
            ('icons/SkypeBlue_48x48.png', '%(datadir)s/icons/skype.png'),
            ('{avatars,lang,sounds}', '%(datadir)s/skype/'),
            ('{LICENSE,README}', '%(thisdocdir)s/')
        ]
        for file in files:
            r.Install(*file)

        # hooks for proper webcam support and theming support
        r.addSource('skype.wrapper', dest = '%(bindir)s/skype', mode = 0755)

        r.TagSpec('desktop-file', '%(datadir)s/applications/')

        r.Requires('soname: libv4lconvert.so.0(SysV x86)', '%(bindir)s/skype.bin')
        r.Requires('soname: /usr/lib/qt4/plugins/styles/libgtkstyle.so(SysV x86)', '%(bindir)s/skype.bin')
        r.Requires('soname: /usr/lib/bug-buddy/libbreakpad.so.0(SysV x86)', '%(bindir)s/skype.bin')
        r.Requires('soname: libcanberra-gtk.so.0(SysV x86)', '%(bindir)s/skype.bin')

