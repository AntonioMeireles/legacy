#
# Copyright (c) 2004-2006 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Gdbm(CPackageRecipe):
    name = 'gdbm'
    version = '1.8.3'

    def setup(r):
        r.addArchive('http://ftp.gnu.org/gnu/gdbm/gdbm-%(version)s.tar.gz')
        r.addPatch('gdbm-1.8.0-jbj.patch')
        r.Replace((r'-o \$\(BINOWN\)', ''),
                  (r'-g \$\(BINGRP\)', ''),
                  'Makefile.in')

        r.Configure('--includedir=%(includedir)s/gdbm')
        r.Make('libdir=%(libdir)s')
        r.MakeInstall(rootVar='INSTALL_ROOT')
        r.Symlink('gdbm/gdbm.h', '%(includedir)s/')

        # avoid buildreq loop that would be created by requiring
        # install-info:runtime would create, since install-info
        # needs gdbm to build
        r.TagSpec('info-file', '%(infodir)s/gdbm.info.gz')
