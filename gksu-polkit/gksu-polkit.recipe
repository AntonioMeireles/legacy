#
# Copyright (c) 2010 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#
class GksuPolkit(AutoPackageRecipe):
    name = 'gksu-polkit'
    version = '20101022'
 
    buildRequires = [
    'atk:devel', 'cairo:devel', 'dbus-glib:devel', 
    'dbus-glib:runtime', 'dbus:devel',
    'fontconfig:devel', 'freetype:devel', 'gettext:runtime',
    'glib:devel', 'gtk-doc:runtime', 'gtk:devel', 
    'intltool:runtime', 'libgee:devel', 'pango:devel',
    'pkgconfig:devel', 'polkit:devel', 'startup-notification:devel',
    'automake:runtime','autoconf:runtime',  'autoconf:data',
       'intltool:runtime', 'libtool:runtime','gtk-doc:devel','m4:runtime',
       'intltool:devel','vala:runtime','vala:devel'
    ]
 
    def unpack(r):
        #r.addArchive('http://people.debian.org/~kov/gksu/')
        r.addGitSnapshot("git://git.debian.org/~kov/gksu-polkit.git/")
        r.addPatch('gksu-polkit-fix-environment-whitelisting.patch')

    def configure(r):
        r.Configure(configureName='autogen.sh')

    def policy(r):
        # be backwards compatible with plain old gksu
        r.Symlink('%(bindir)s/gksu-polkit', '%(bindir)s/gksu')
        r.Symlink('%(bindir)s/gksu-polkit', '%(bindir)s/gksudo')
