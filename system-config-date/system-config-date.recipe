#
# Copyright (c) 2004 Specifix, Inc.
# All rights reserved
#

class SystemConfigDate(PackageRecipe):
    buildRequires = [ 'desktop-file-utils:runtime', 'intltool:runtime' ]
    name = "system-config-date"
    version = "1.7.99.3"

    def setup(r):
        r.addArchive('%(name)s-%(version)s.tar.bz2',
            rpm='ftp://ftp.linux.ncsu.edu/pub/fedora/linux/core/development/SRPMS/%(name)s-%(version)s-1.src.rpm')

        r.Replace('python2', 'python', 'system-config-date', 'timeconfig',
                  'src/system-config-date.py', 'src/timeconfig.py')
	r.Replace('Exec=','Exec=gksudo ','system-config-date.desktop.in')
	r.Replace('Categories=Application;SystemSetup;','Categories=Application;System;Settings','system-config-date.desktop.in')
        r.Make()
        r.MakeInstall()
        # fix up packaging error
        r.Remove('%(bindir)s/timetool')
        # we depend on ntp, which provides this file
        r.Remove('%(sysconfdir)s/ntp/ntpservers')
        r.Symlink('system-config-date', '%(bindir)s/timetool')

        for trove in ('ntp:runtime', 'rhpl:python', 'chkconfig:runtime',
                      'pygtk:python', 'newt:python', 'htmlview:runtime'):
            r.Requires(trove, '%(bindir)s/system-config-date')

	r.Remove('%(datadir)s/applications/system-config-date.desktop')
