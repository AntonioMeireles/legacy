#
# Copyright (c) 2004-2006 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#
loadSuperClass('rpmpackage.recipe', label='conary.rpath.com@rpl:devel')

class SystemConfigDisplay(RPMPackageRecipe):
    buildRequires = [ 'desktop-file-utils:runtime', 'intltool:runtime',
        'gtk:runtime', 'pygtk:python', 'pyxf86config:python', 'rhpl:python', 
        'rhpxl:python', 'make:runtime','kudzu:python', 'pygobject:python' ]

    name = "system-config-display"
    version = "1.0.42"

    def setup(r):

    	r.unpack()

        r.Run("sed -i '/xsri/d' src/xconf.py")
        r.Replace('python2', 'python',
                  'src/system-config-display', 'src/xconf.py')
        r.Replace('Exec=','Exec=gksudo ','system-config-display.desktop')
        r.Replace('Categories=System;Application;SystemSetup;GTK;','Categories=Application;System;Settings','system-config-display.desktop')

        r.Make()
        r.MakeInstall(rootVar='INSTROOT')

        r.Remove('%(datadir)s/system-config-display/pixmaps/lightrays.png')
        r.Requires('pyxf86config:python', '%(bindir)s/system-config-display')
        r.Requires('rhpl:python', '%(bindir)s/system-config-display')
        # this is probably the only thing that *does* require rhpl:runtime
        r.Requires('rhpxl:python', '%(bindir)s/system-config-display')
        r.Requires('pygtk:python', '%(bindir)s/system-config-display')
        r.Requires('kudzu:python', '%(bindir)s/system-config-display')
