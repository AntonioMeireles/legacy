diff -r 6ec104e7ef3d cgi-bin/search.c
--- a/cgi-bin/search.c	Sun Mar 09 17:05:16 2008 -0800
+++ b/cgi-bin/search.c	Sun Mar 09 17:05:57 2008 -0800
@@ -167,7 +167,9 @@ cgiCompileSearch(const char *query)	/* I
       * string + RE overhead...
       */
 
-      wlen = (sptr - s) + 4 * wlen + 2 * strlen(prefix) + 4;
+      wlen = (sptr - s) + 2 * 4 * wlen + 2 * strlen(prefix) + 11;
+      if (lword)
+        wlen += strlen(lword);
 
       if (wlen > slen)
       {
