#
# Copyright (c) 2006-2009 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Recipe(CPackageRecipe):
    name = 'fuse'
    version = '2.7.4'

    def setup(r):
        r.addArchive('mirror://sourceforge/%(name)s/')
        r.addSource('fuse-no-install-hooks.patch')

        r.Configure('--disable-kernel-module --without-kernel --without-kernel-build')

        # the util/Makefile.am install hooks do things such as
        # call chmod and mknod, so let's disable that and handle it
        # package-like.
        #r.Run('patch -p1 < fuse-no-install-hooks.patch')
        r.Make()
        r.MakeInstall()
        r.MakeDevices('/dev/fuse', 'c', 10, 229, 'root', 'root', mode = 0666)
        r.SetModes('%(bindir)s/fusermount', 04755)
        r.Remove('%(initdir)s/*')
        r.ComponentSpec('dev', '/dev/')
