#
# Copyright (c) 2009 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadInstalled('perl')
class mobiperl(PackageRecipe):
    name = 'mobiperl'
    version = '0.0.41'

    buildRequires = [
        'perl:devel', 'perl:perl', 'perl:runtime',
        'perl-Palm-PDB:perl',
        'perl-XML-Parser-Lite-Tree:perl',
        'perl-GD:perl',
        'perl-Image-BMP:perl',
        'perl-Image-Size:perl',
        'perl-HTML-Tree:perl',
        'perl-Getopt-Mixed:perl',
        'perl-TimeDate:perl',
        'perl-DateManip:perl',
    ]

    def setup(r):
        r.macros.perlver = Perl.version

        r.addArchive('http://dev.mobileread.com/dist/tompe/mobiperl/'
                     'mobiperl-%(version)s.tar')
        r.Install('*mobi*', '%(bindir)s/')
        r.Run('for f in *mobi*; do pod2man $f > $f.1; done')
        r.Install('*.1', '%(mandir)s/man1/')
        r.Install('MobiPerl', 'Palm',
                  '%(prefix)s/lib/perl5/vendor_perl/%(perlver)s/')
