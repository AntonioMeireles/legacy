#
# Copyright (c) 2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class XalanC(AutoPackageRecipe):
    name = 'xalan-c'
    version = '1.10.0'

    buildRequires = [ 'autoconf:runtime', 'libstdc++:devel', 'xerces-c:devel' ]

    def unpack(r):
        r.macros.archive_version = r.version.replace('.', '_')+'-src'
        r.addArchive('http://www.mirrorgeek.com/apache.org/xml/xalan-c/'
                     'Xalan-C_%(archive_version)s.tar.gz')

        # not a completely normal use of autoconf
        r.mainDir('xml-xalan/c')
        r.Environment('XALANCROOT', '%(builddir)s')
        r.Environment('XALAN_LOCALE_SYSTEM', 'inmem')
        r.Environment('XALAN_LOCALE', 'en_US')
        r.Environment('LIBS', ' -lpthread ')
        if Arch.bits64:
            r.Environment('BITSTOBUILD', '64')
        else:
            r.Environment('BITSTOBUILD', '32')

        r.macros.cflags = ' -DNDEBUG'
