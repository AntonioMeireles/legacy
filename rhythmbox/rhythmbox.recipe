#
# Copyright (c) 2009 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('gnomepackage')
class RhythmBox(GnomePackageRecipe):

    name = 'rhythmbox'
    version = '0.12.4'
    #svnUrl = 'http://svn.gnome.org/svn/rhythmbox/trunk'

    buildRequires = [
        'GConf:devel',
        'GConf:runtime',
        'ORBit2:devel',
        'avahi-glib:devel',
        'avahi:devel',
        'dbus-glib:devel',
        'dbus-glib:runtime',
        'dbus:devel',
        'desktop-file-utils:runtime',
        'expat:devel',
        'gettext:runtime',
        'libgpod:devel',
        'libmtp:devel',
        'gnome-keyring:devel',
        'gnome-media:devel',
        'gnome-python:python',
        'gnome-vfs:devel',
        'gst-plugins-base:devel',
        'gst-python:devellib',
        'gstreamer:devel',
        'hal:devel',
        'libart_lgpl:devel',
        'libbonobo:devel',
        'libbonoboui:devel',
        'libglade:devel',
        'libgnome:devel',
        'libgnomecanvas:devel',
        'libgnomeui:devel',
        'libmtp:devel',
        'libmusicbrainz:devel',
        'libnotify:devel',
        'libsexy:devel',
        'libsoup:devel',
        'libusb:devel',
        'libxml2:devel',
        'brasero:devel',
        'popt:devel',
        'pygobject:python',
        'pygtk:devel',
        'pygtk:python',
        'python:devel',
        'rarian:devel',
        'rarian:runtime',
        'totem:devellib',
        'lirc:devel',
        'gnome-doc-utils:runtime',
        'gnome-doc-utils:devel',
        'glitz:devel',
        'totem-pl-parser:devel',
        'xcb-util:devel'
    ]

    docs = ['AUTHORS', 'DOCUMENTERS', 'INTERNALS', 'THANKS' ]

    extraConfig = GnomePackageRecipe.extraConfig
    extraConfig += '--with-ipod ' \
        ' --with-mdns=avahi ' \
        ' --disable-scrollkeeper ' \
        ' --enable-daap ' \
        ' --enable-libnotify ' \
        ' --enable-python ' \
        ' --with-libbrasero-media ' \
        ' --enable-browser-plugin' \
        ' --with-help-formats ' \
        ' --with-mtp ' \
        ' --with-gnome-keyring '

    def unpack(r):
        GnomePackageRecipe.unpack(r)
        r.Run('automake || autoconf')

    def policy(r):

        # install missing artwork image (Gnome BZ#387413)
        r.Install('plugins/artdisplay/rhythmbox-missing-artwork.svg', '%(libdir)s/rhythmbox/plugins/artdisplay/', mode = 0644)
