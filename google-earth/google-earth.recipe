class GoogleEarth(PackageRecipe):
    name = 'google-earth'
    version = '4.2.205.5730'


    buildRequires = ['bash:runtime', 'fontconfig:devel', 'freetype:devel', 
		'glibc:devel', 'perl:lib', 'perl:runtime', 
		'desktop-file-utils:runtime','atk:devel', 
		'glib:devel', 'gtk:devel', 'pango:devel',
		'libICE:devel', 'libSM:devel', 'libX11:devel', 
		'libXcursor:devel', 'libXext:devel', 'perl:devel',
		'libXft:devel', 'libXrender:devel', 'Mesa:devel' ]

    installPath = "/opt/"
    installPath2 = "/opt/google-earth/"

    def setup(r):

        r.addSource('http://dl.google.com/earth/client/current/GoogleEarthLinux.bin')

        r.Run(r"""
        sh GoogleEarthLinux.bin --nox11  --nochown --noexec --target %(builddir)s/ 
        """)
        r.Run("mkdir google-earth")
        r.Run("tar -xf googleearth-data.tar -C google-earth")
        r.Run("tar -xf googleearth-linux-x86.tar -C google-earth")

        r.Replace('Categories=Application;Network',
                  'Categories=GNOME;3DGraphics;Network;',
                  'googleearth.desktop')

        r.MakeDirs('/opt/%(name)s')
        r.Copy("google-earth",r.installPath)
        r.Copy("bin/googleearth",r.installPath2)
        r.Copy("googleearth-icon.png",r.installPath2)

        r.addSource('googleearth.desktop')
        r.Desktopfile('googleearth.desktop')

        r.addSource('googleearth')
        r.Install('googleearth','%(bindir)s/googleearth')
        r.Symlink('%(bindir)s/googleearth', '%(bindir)s/google-earth')
