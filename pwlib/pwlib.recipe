#
# Copyright (c) 2004-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Pwlib(CPackageRecipe):
    name = 'pwlib'
    version = '1.10.10'

    buildRequires = [ 'expat:devel', 'pkgconfig:devel', 'krb5:devel',
                      'autoconf:runtime', 'bison:runtime', 'alsa-lib:devel',
                      'cyrus-sasl:devel', 'libstdc++:devel', 'SDL:devel',
                      'flex:runtime', 'openssl:devel', 'openldap:devel', ]

    def setup(r):
        r.addArchive('http://www.ekiga.org/admin/downloads/latest/sources/sources/')
        r.macros.cflags += ' -DLDAP_DEPRECATED'
        r.Configure('--enable-plugins')
        r.Make('OPTCCFLAGS="%(cflags)s"')

        r.MakeInstall()
        r.Replace('PWLIBDIR.*=.*', 'PWLIBDIR = %(datadir)s/pwlib', '%(datadir)s/pwlib/make/ptbuildopts.mak')
        r.Doc('History.txt', 'ReadMe.txt', 'mpl-1.0.htm')
        r.Symlink('%(datadir)s/pwlib/make/ptlib-config', '%(bindir)s/')

        r.ComponentSpec('devel', '%(datadir)s/pwlib/make/.*')
        r.ComponentSpec('runtime', '%(libdir)s/pwlib/.*')
