class TwistedConch(PackageRecipe):

    name = "python-twisted-conch"
    version = "0.5.0"

    buildRequires = [ 'pycrypto:python', 'python:runtime',
                      'python-twisted:python' ]

    def setup(r):
        twisted_name = r.name.split('-')[1]
        conch_name = r.name.split('-')[2]
        r.macros.namesim = twisted_name + conch_name
        twisted_cap_name = twisted_name[0].upper() + twisted_name[1:]
        conch_cap_name = conch_name[0].upper() + conch_name[1:]
        r.macros.namecap = twisted_cap_name + conch_cap_name
        r.macros.majver = '.'.join(r.version.split('.')[0:2])

        baseurl = 'http://tmrc.mit.edu/mirror/' + twisted_name + \
                  '/' + conch_cap_name + '/%(majver)s'
        r.macros.baseurl = baseurl
        r.addArchive('%(baseurl)s/%(namecap)s-%(version)s.tar.bz2')

        r.Run('python setup.py build')
        r.Run('python setup.py install --prefix=%(destdir)s%(prefix)s')
