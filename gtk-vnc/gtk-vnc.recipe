#
# Copyright (c) 2007-2008 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#
loadSuperClass('rpmpackage')
class GtkVnc(RPMPackageRecipe,AutoPackageRecipe):
    name = 'gtk-vnc'
    version = '0.3.8'
    rpmRelease = '8.fc11'
    rpmPatches = [ '%(name)s-%(version)s-relative-mouse.patch',
                   '%(name)s-%(version)s-sasl-auth.patch',
                   '%(name)s-%(version)s-sasl-auth-tunnel.patch',
                   '%(name)s-%(version)s-ungrab.patch',
                   '%(name)s-%(version)s-ungrab-2.patch',]

    buildRequires = ['atk:devel', 'cairo:devel', 'expat:devel', 'fontconfig:devel', 'freetype:devel', 'glib:devel', 'gnutls:devel', 'gtk:devel', 'libX11:devel', 'libXrender:devel', 'libpng:devel', 'pango:devel', 'pkgconfig:devel', 'zlib:devel', 'pygtk:devel', 'python:devel', 'xextproto:devel', 'nspr:devel', 'Mesa:devel', 'gtkglext:devel', 'libICE:devel', 'libSM:devel', 'libXmu:devel', 'libXt:devel', 'xulrunner:devel', 'pygobject:runtime', 'pygobject:devel', 'cyrus-sasl:devel', 'autoconf:runtime', 'automake:runtime', 'libtool:runtime']

    def configure(r):
        r.macros.ldflags += ' -L%(libdir)s/xorg.mesa.3d/ '
        r.Run(" libtoolize --copy --force; aclocal -I gnulib/m4 ; autoheader ; automake --add-missing --copy ; autoconf ")
        r.Configure()

    def makeinstall(r):
        r.MakeInstall('DESTDIR=%(destdir)s')
