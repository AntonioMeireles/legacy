#
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class RapidSVN(AutoPackageRecipe):

    name = 'rapidsvn'
    version = '0.10'

    buildRequires = [
        'apr-util:devel', 'apr:devel', 'e2fsprogs:devel', 'expat:devel',
        'krb5:devel', 'libstdc++:devel', 'libxml2:devel', 'neon:devel',
        'openldap:devel', 'openssl:devel', 'subversion:devel',
        'wxGTK:devel', 'zlib:devel', 'desktop-file-utils:runtime', 'util-linux:devel'
    ]

    def unpack(r):
        r.addArchive('http://www.rapidsvn.org/download/release/%(version)s/rapidsvn-%(version)s.0-1.tar.gz')
        r.Create('rapidsvn.desktop', contents="""[Desktop Entry]
Encoding=UTF-8
Name=RapidSVN
GenericName=Subversion client
Comment=Manage Subversion repositories
Exec=rapidsvn
Icon=rapidsvn.png
Terminal=false
Type=Application
Categories=Application;Development;GNOME;
""")
        r.Desktopfile('%(name)s.desktop')
    def configure(r):
        r.Configure( ' --disable-static '
                     ' --disable-no-exceptions'
                     ' --with-svn-lib=%(libdir)s'
                     ' --with-apr-config=%(bindir)s/apr-1-config'
                     ' --with-apu-config=%(bindir)s/apu-1-config'
                     ' --with-neon-config=/bin/true'
                     )

    def policy(r):
        r.PackageSpec('svncpp', '%(libdir)s/', '%(includedir)s/')

