#
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class RapidSVN(AutoPackageRecipe):

    name = 'rapidsvn'
    version = '0.9.4'

    buildRequires = [
        'apr-util:devel', 'apr:devel', 'e2fsprogs:devel', 'expat:devel',
        'krb5:devel', 'libstdc++:devel', 'libxml2:devel', 'neon:devel',
        'openldap:devel', 'openssl:devel', 'subversion:devel',
        'wxWidgets:devel', 'zlib:devel'
    ]

    def unpack(r):

        r.addArchive('http://www.rapidsvn.org/download/release/%(version)s/')

        for p in ('162/wx28.diff', '166/wx28.diff2'):
            r.addPatch(
                'http://rapidsvn.tigris.org'
                '/nonav/issues/showattachment.cgi/'+p, dir='src/'
            )

    def configure(r):

        r.Configure(
            ' --with-svn-lib=%(libdir)s'
            ' --with-apr-config=%(bindir)s/apr-1-config'
            ' --with-apu-config=%(bindir)s/apu-1-config'
        )

    def policy(r):

        r.PackageSpec('svncpp', '%(libdir)s/', '%(includedir)s/')

