#
# Copyright (c) 2006-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('phpapppackage', label='contrib.rpath.org@rpl:devel')
class phpPgAdmin(PHPAppPackageRecipe):
    version = '4.1.3'
    name = 'phpPgAdmin'

    def unpack(r):
        r.extractArchive('http://easynews.dl.sourceforge.net/sourceforge/phppgadmin/%(name)s-%(version)s.tar.bz2')
        r.Replace('extra_login_security\'\] = true', 'extra_login_security\'] = false',
            '../_ROOT_/srv/www/phpPgAdmin/conf/config.inc.php')

        # Require mod_auth_shadow
        r.Requires('mod_auth_shadow:runtime', '%(sysconfdir)s/')

        r.macros.dirconf = '''
        AllowOverride FileInfo Options
        php_admin_flag safe_mode off
        php_value   memory_limit 16M

        AuthType Basic
        AuthName "PostgreSQL admin area"
        AuthShadow on
        require user web
        '''
