#
# Copyright (c) 2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class PamKeyring(CPackageRecipe):
        name = 'pam-keyring'
        version = '0.0.8'
        buildRequires = ['glib:devel', 'gnome-keyring:devel', 'gnome-keyring:runtime', 'pam:devel', 'pkgconfig:devel']

        def setup(r):
            r.addArchive('http://www.hekanetworks.com/opensource/pam_keyring/pam_keyring-%(version)s.tar.gz')

            r.addPatch('http://librarian.launchpad.net/7423914/pam-keyring_0.0.8-6.diff.gz')
            ubuntuPatches = [
                '02pam_keyring.dpatch',
                '01compat.dpatch',
                '03makefile.dpatch',
                '04sigchild_dfl.dpatch',
                '05pam-keyring_kfreebsd.dpatch',
                ]
            for p in ubuntuPatches:
                r.Run(""" patch -p1  < debian/patches/%s """ % p )

            r.Configure()
            r.Make()
            r.MakeInstall()
