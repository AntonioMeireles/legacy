#
# Copyright (c) 2004 Specifix, Inc.
# All rights reserved
#

loadRecipe('gnomepackage.recipe')
class EvolutionDataServer(GnomePackageRecipe):

    name = 'evolution-data-server'
    version = '1.4.1'

    buildRequires = [ 'glib:devel', 'gnome-vfs:devel', 'GConf:devel',
		'openldap:devel', 'intltool:runtime', 'libsoup:devel', 'ORBit2:devel', 'libgnome:devel',
		'libgnomeui:devel', 'atk:devel', 'cairo:devel', 'e2fsprogs:devel', 'fontconfig:devel',
		'freetype:devel', 'gnome-keyring:devel', 'libart_lgpl:devel', 'libbonobo:devel',
		'libbonoboui:devel', 'libglade:devel', 'libgnomecanvas:devel', 'libpng:devel',
		'libxml2:devel', 'pango:devel', 'popt:devel', 'mozilla-nspr:devel', 'mozilla-nss:devel' ]

    # add krb5 support
    if Use.krb:
        extraConfig = ' --with-krb5=/usr/kerberos'
        buildRequires.append('krb5:devel')
    else:
        extraConfig = ' --without-krb5'

    # add ldap support
    if Use.ldap:
        extraConfig += ' --with-openldap=yes'
        buildRequires.append('openldap:devel')
    else:
        extraConfig += ' --without-openldap'


    def unpack(r):
	GnomePackageRecipe.unpack(r)
	r.Replace('/var/spool/mail','%(servicedir)s/spool/mail','configure*')
    def setup(r):
	r.disableParallelMake()
	GnomePackageRecipe.setup(r)

