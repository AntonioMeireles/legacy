#
# Copyright (c) 2005-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Mailbase(PackageRecipe):
    name = 'mailbase'
    version = '1.0'  #no upstream version number

    # Based on Gentoo's mailbase-1
    # http://www.gentoo.org/cgi-bin/viewcvs.cgi/net-mail/mailbase/mailbase-1.ebuild?rev=1.4&hideattic=1&content-type=text/vnd.viewcvs-markup

    def setup(r):
        r.addSource('aliases')
        r.addSource('aliases.5')
        r.addSource('common-pamd-include')

        r.Install('aliases', '%(sysconfdir)s/')
        r.Create('%(sysconfdir)s/aliases.db')
        r.Install('aliases.5', '%(mandir)s/man5/')

        r.Install('common-pamd-include', '%(sysconfdir)s/pam.d/pop')
        r.Symlink('pop', '%(sysconfdir)s/pam.d/pop3')
        r.Symlink('pop', '%(sysconfdir)s/pam.d/pop3s')
        r.Symlink('pop', '%(sysconfdir)s/pam.d/pops')

        r.Install('common-pamd-include', '%(sysconfdir)s/pam.d/imap')
        r.Symlink('imap', '%(sysconfdir)s/pam.d/imap4')
        r.Symlink('imap', '%(sysconfdir)s/pam.d/imap4s')
        r.Symlink('imap', '%(sysconfdir)s/pam.d/imaps')

        r.Install('common-pamd-include', '%(sysconfdir)s/pam.d/smtp')
        r.Symlink('smtp', '%(sysconfdir)s/pam.d/smtps')

        #/etc/aliases is a config file, not inital contents
        r.InitialContents('%(sysconfdir)s/aliases.db')
