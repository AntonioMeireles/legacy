#
# Copyright (c) 2006-2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('binarypackage=conary.rpath.com@rpl:devel')
class Opera(BinaryPackageRecipe):

    buildRequires = [ 'desktop-file-utils:runtime', 'libICE:lib',
                      'libSM:lib', 'libXext:lib', 'libXt:lib',
                      'libX11:lib', 'qt:lib', 'icedtea-jre:runtime' ]
    name = 'opera'
    version = '9.63'

    def unpack(r):

        r.macros.snapshot = r.version.split('.')[-1]
        r.macros.site = 'http://ftp.opera.com/pub/opera/linux/963/final/en/'

        dist = [
            ('i386/shared/opera-9.63.gcc4-shared-qt3.i386.rpm', Arch.x86),
            ('x86_64/opera-9.63.gcc4-shared-qt3.x86_64.rpm', Arch.x86_64),
        ]
        for (rpm, arch) in dist:
            r.addArchive('%(site)s/'+rpm, dir='/', use=(arch==True))

        r.Symlink('%(datadir)s/icons/hicolor/32x32/apps/opera.png', '%(datadir)s/pixmaps/opera.png')
        r.addSource('opera.desktop')
        r.Desktopfile('opera.desktop')

        # Probably better to s/lib/lib64/
        r.FixupMultilibPaths(exceptions='.*')

