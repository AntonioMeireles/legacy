#
# Copyright (c) 2010 Foresight Linux Project
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#
loadSuperClass('rpmpackage')
class SEAbios(RPMPackageRecipe,AutoPackageRecipe):
    name = 'seabios'
    version = '0.5.1'
    rpmRelease = '3.fc13'
    rpmPatches = [ '0001-Go-back-to-using-0xf0000000-for-PCI-memory-start.patch',
                   '0002-Fix-PkgLength-calculation-for-the-SSDT.patch',
                   'seabios-Set-CONFIG_S3_RESUME_VGA_INIT-to-1.patch',
                   'seabios-smbios-avoid-counting-io-hole-as-ram.patch',
                   'seabios-Support-for-booting-from-virtio-disks.patch',
                   'seabios-zero-memory-before-use.patch',
                   'seabios-do-not-advertise-hpet-to-a-guest-OS.patch',
                   'seabios-fix-resume-from-S3-with-QXL-device.patch']


    def setup(r):
        RPMPackageRecipe.unpack(r)
        r.Replace('VERSION=%(version)s.*', 'VERSION=%(version)s', 'Makefile')

        r.Make()

        r.Install('out/bios.bin', '%(datadir)s/seabios/', mode = 0644)
