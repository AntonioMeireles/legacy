#
# Copyright (c) 2008 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadRecipe('gnomepackage')
class Jd(GnomePackageRecipe):
        buildRequires = [
                'automake:runtime','autoconf:runtime',
                'gcc-c++:runtime',
                'libstdc++:devel',
                'gtkmm:devel','glibmm:devel',
                'libsigc++:devel',
                'openssl:devel',
                'desktop-file-utils:runtime','cairomm:devel',
                'gnutls:devel','libgcrypt:devel',
                'libgpg-error:devel',
                'libtool:runtime',
                ]

        name='jd'
        version='2.4.2_rc090921'
        #rpmRelease = '0.1.svn2360_trunk.fc10'
        #tarballName = '%(name)s-%(version)s-svn2360_trunk.tgz'
        def setup(r):
                r.macros.relnum='43681'
                r.macros.upstreamVersion=r.macros.version.replace('_','-')
		r.addArchive('http://osdn.dl.sourceforge.jp/jd4linux/%(relnum)s/'
			'%(name)s-%(upstreamVersion)s.tgz')
                r.Run(r""" mkdir giomm;  sed -e '/interface\.h/s|^\(.*\)$|\1\n#undef HOST_NOT_FOUND|'  %(includedir)s/giomm-2.4/giomm/error.h > giomm/error.h """)
                r.Run('./autogen.sh')
                r.Configure()
                r.Environment('TZ', 'Asia/Tokyo')
                # r.Make('CXXFLAGS="%(cxxflags)s %(excxxflags)s"')
                r.Make()
                r.MakeInstall()
                r.Install('%(name)s.desktop',
                          '/usr/share/applications/%(name)s.desktop')
                r.Install('%(name)s.png',
                          '/usr/share/pixmaps/%(name)s.png')
