#
# Copyright (c) 2008 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadRecipe('gnomepackage.recipe')
class Jd(GnomePackageRecipe):
	buildRequires = [
		'glibc:devel','atk:devel',
		'automake:runtime','autoconf:runtime',
		'cairo:devel','pango:devel',
		'glib:devel','libpng:devel',
		'fontconfig:devel','freetype:devel',
		'gcc-c++:runtime','gtk:devel',
		'libstdc++:devel',
		'gtkmm:devel','glibmm:devel',
		'libsigc++:devel',
		'expat:devel','openssl:devel',
		'desktop-file-utils:runtime','cairomm:devel',
		'gnutls:devel','libgcrypt:devel',
		'libgpg-error:devel','subversion:runtime',
		'libtool:runtime'
		]
	if Use.krb:
		buildRequires.extend(['krb5:devel'])
	name='jd'
	version='1.9.8_beta071218'
	def setup(r):
		r.macros.relnum='28544'
		r.macros.upstreamVersion=r.macros.version.replace('_','-')
		if Use.krb:
			r.macros.cxxflags+=' -I%(krbprefix)s/include'
		else:
			r.macros.cxxflags+=' -DOPENSSL_NO_KRB5'
		r.addArchive('http://osdn.dl.sourceforge.jp/jd4linux/%(relnum)s/'
			'%(name)s-%(upstreamVersion)s.tgz')
		r.Run('./autogen.sh')
		r.Configure()
		#r.Make('CXXFLAGS="%(cxxflags)s %(excxxflags)s"')
		r.Make()
		r.MakeInstall()
		r.Install('%(name)s.desktop',
			'/usr/share/applications/%(name)s.desktop')
		r.Install('%(name)s.png',
			'/usr/share/pixmaps/%(name)s.png')
