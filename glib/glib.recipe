#
# Copyright (c) 2004-2009 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Glib(CPackageRecipe):
    name = 'glib'
    version = '2.14.6'

    buildRequires = [ 'gettext:runtime', 'indent:runtime', 'perl:runtime',
        'pkgconfig:devel', 'pcre:devel', ]
    #if Use.builddocs:
    #    buildRequires.append('gtk-doc:runtime')

    def setup(r):
        r.addArchive('mirror://gnome/%(name)s/%(major_version)s/')

        # RPL-2990
        r.addPatch('glib2-CVE-2008-4316.patch')

        for profile in ('glib2.sh', 'glib2.csh'):
            r.addSource(profile, dest='%(sysconfdir)s/profile.d/', mode=0755)

        extraConfigure = ' --with-pic --enable-static --enable-shared --disable-gtk-doc --with-pcre=system'

        r.Configure(extraConfigure)
        r.Make()
        r.MakeInstall()

        r.ComponentSpec('devel', '%(bindir)s/glib-.*')
