class Mod_Auth_Shadow(CPackageRecipe):

	name = 'mod_auth_shadow'
	version = '2.1'
	
	buildRequires = ['httpd:runtime', 'pam:devel', 'httpd:devel', 'apr-util:devel']

	def setup(r):	
		r.addArchive('mirror://sourceforge/mod-auth-shadow/')
		r.addSource('makefile')

		r.Make(preMake="BINDIR='%(sbindir)s'")

		r.Install('.libs/mod_auth_shadow.so', '%(libdir)s/httpd/modules/', mode=0755)
		r.Install('validate', '%(sbindir)s/validate', mode=04755)
		r.Ownership('root', 'root', '%(sbindir)s/validate')
		# r.SetModes('%(sbindir)s/validate', 04755)

		r.Create('%(sysconfdir)s/httpd/conf.d/auth_shadow.conf', contents='# '
'\n# mod_auth_shadow can be used to limit access to documents by checking'
'\n# the login information against the /etc/shadow. '
'\n# '
'\n'
'\nLoadModule auth_shadow_module modules/mod_auth_shadow.so')

		r.Requires('httpd:runtime', '%(libdir)s/httpd/modules/*.so')

