#
# Copyright (c) 2004-2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Wine(CPackageRecipe):
    name = 'wine'
    version = '0.9.60'

    buildRequires = [ 'alsa-lib:devel', 'flex:runtime', 'freeglut:devel',
        'freetype:devel', 'glib:devel', 'libieee1284:devel', 'libjpeg:devel',
        'libusb:devel', 'libxml2:devel', 'libxslt:devel', 'openldap:devel',
        'pkgconfig:devel', 'sane-backends:devel', 'zlib:devel',
        'audiofile:devel', 'esound:devel', 'nas:devel', 'esound:devel',
        'perl:lib', 'fontconfig:runtime', 'fontforge:runtime', 'bison:runtime',
        'hal:devel', 'dbus:devel', 'cups:devel', 'ncurses:devel',
        'giflib:devel', 'libICE:devel', 'libSM:devel', 'libX11:devel',
        'libXau:devel', 'libXext:devel', 'libXt:devel', 'libXxf86vm:devel',
        'perl:devel']

    def setup(r):
        r.addArchive('http://ibiblio.org/pub/linux/system/emulators/wine/')

        r.Configure('--sysconfdir=%(sysconfdir)s/wine')
        r.Make()
        r.MakePathsInstall('includedir=%(destdir)s%(includedir)s/wine '
                           'sysconfdir=%(destdir)s%(sysconfdir)s/wine '
                           'dlldir=%(destdir)s%(libdir)s/wine '
                           'LDCONFIG=/bin/true UPDATE_DESKTOP_DATABASE=/bin/true')

        r.CheckSonames(exceptions='%(libdir)s/libwine.*')

        r.TagSpec('desktop-file', '%(datadir)s/applications/wine.desktop')
