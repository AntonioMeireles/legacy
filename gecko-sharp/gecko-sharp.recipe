#
# Copyright (c) 2004-2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class GeckoSharp(AutoPackageRecipe):
    name = 'gecko-sharp'
    version = '2.0_0.13'

    buildRequires = [ 'mono:runtime', 'mono:cil', 'which:runtime',
                      'gtk-sharp:devellib', 'gtk-sharp:runtime', 'gtk-sharp:cil',
                      'mono:devellib', 'gawk:runtime', 'pkgconfig:devel',
                      'automake:runtime', 'autoconf:runtime', 'libtool:runtime',
                      'monodoc:runtime', 'gecko-sharp:cil', 'gettext:runtime',
                      'intltool:runtime', 'gtk:devel']

    def unpack(r):
        r.macros.majver = r.version.split('_')[0]
        r.macros.archive_version = r.version.replace('_', '-')
        r.Environment('MONO_SHARED_DIR', '/tmp')
        r.addArchive('http://go-mono.com/sources/gecko-sharp-%(majver)s/')
        r.addPatch('http://cvs.fedoraproject.org/viewcvs/*checkout*/devel/gecko-sharp2/gecko-sharp-2.0-0.12-xulrunner.patch')
        r.addPatch('http://cvs.fedoraproject.org/viewcvs/*checkout*/devel/gecko-sharp2/gecko-sharp-libdir.patch')
        r.Run('autoreconf --force --install')

    def makeinstall(r):
        r.MakeInstall('GACUTIL_FLAGS="/package gecko-sharp-2.0 /gacdir %(libdir)s /root %(destdir)s%(libdir)s"')
        r.Remove('/usr/lib/monodoc/sources/', recursive = True)
