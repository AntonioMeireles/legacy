#
# Copyright (c) 2006 rPath, Inc.
# Copyright (c) 2007 - 2011 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#
loadSuperClass('xfcepackage')
class xfce4Session(XfcePackageRecipe):

    name = 'xfce4-session'
    version = '4.8.1'

    XfcePackageRecipe.buildRequires.extend([
        'libxfce4util:devel', 'desktop-file-utils:runtime', 'iceauth:runtime',
        'libXres:devel', 'libwnck:devel', 'libxfce4ui:devel', 'libexo:runtime',
        'startup-notification:devel', 'xfconf:devel', 'xfce4-panel:devel',
        'atk:devel', 'libgnome-keyring:devel', 'GConf:devel'
    ])
    patches = ['xfce4-session.xml.patch',
               'fix_crash_if_timeout_is_triggered.patch',
               'fix_manpage.patch',
               'start_kde4_services_instead_of_kde3.patch',
               # prepare for gdm > 2.9x
               'xfce4-session-4.8.1-gdmlang.patch',
              ]
    extraConfig = '--enable-libgnome-keyring --enable-gnome '

    def setup(r):
        XfcePackageRecipe.setup(r)
        r.addSource('themerc', dir='%(datadir)s/themes/Foresight/balou/', mode = 0644)
        r.addSource('logo.png', dir='%(datadir)s/themes/Foresight/balou/', mode = 0644)
        r.Remove('%(sysconfdir)s/xdg/autostart/xfce4-tips-autostart.desktop')
