#
# Copyright (c) 2011 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class xpra(CPackageRecipe):
    name = 'xpra'
    version = '0.3.2'

    buildRequires = [
        'cython:runtime', 'PIL:python', 'atk:devel',
        'cairo:devel', 'dbus-python:python', 'fontconfig:devel',
        'freetype:devel', 'gdk-pixbuf:devel', 'glib:devel', 'gtk:devel',
        'ipython:python', 'libX11:devel', 'libXcomposite:devel',
        'libXdamage:devel', 'libXfixes:devel', 'libXrandr:devel',
        'libXtst:devel', 'libpng:devel', 'notify-python:python',
        'pango:devel', 'pkgconfig:devel',
        'pycairo:python', 'pygobject:python', 'pygobject:devel',
        'pygtk:python', 'pygtk:devel', 'python:devel',

        'ffmpeg:devel', 'libappindicator:python', 'libvpx:devel', 'x264:devel',
        'desktop-file-utils:runtime',
    ]

    def setup(r):
        r.addArchive('http://xpra.org/src/')

        r.Remove('build', recursive = True)
        r.Remove('install', recursive = True)
        r.Run('python%(pyver)s make_constants_pxi.py wimpiggy/lowlevel/constants.txt wimpiggy/lowlevel/constants.pxi')
        r.PythonSetup(data = '')
        
        # parti and xpra both depend on wimpiggy, but xpra does not depend on parti
        r.PackageSpec('parti', '.*parti.*')
        r.PackageSpec('wimpiggy', '.*wimpiggy.*')
