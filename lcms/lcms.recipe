

loadSuperClass('rpmpackage')
class LittleCMS(RPMPackageRecipe,AutoPackageRecipe):

    buildRequires = ['zlib:devel', 'libtiff:devel', 'libjpeg:devel', 'libstdc++:devel', 'python:devel', 'swig:runtime', 'libtool:runtime']
    name = "lcms"
    version = "1.17"
    rpmRelease = '4.fc9'
    rpmPatches = ['lcms-1.16-python-lib64.patch']

    def configure(r):
        r.Run("""
cd doc
mkdir -p __temp
for f in LCMSAPI.TXT TUTORIAL.TXT ;do
cp -p $f __temp/$f
iconv -f ISO-8859-1 -t UTF-8 __temp/$f > $f
touch -r __temp/$f $f
done
rm -rf __temp
""")

        r.Configure(' --with-python --disable-static' )
        r.Run('cd python; ./swig_lcms')

    def makeinstall(r):
        r.MakeInstall('INSTALL=\"install -p\"')
        if Arch.x86_64:
            r.Move('/usr/lib/python2.6/site-packages/lcms.py', '%(libdir)s/python2.6/site-packages/lcms.py')
