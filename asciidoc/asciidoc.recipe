#
# Copyright (c) 2005 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class AsciiDoc(PackageRecipe):
    name = 'asciidoc'
    version = '8.1.0'

    def setup(r):
        r.addArchive('http://www.methods.co.nz/%(name)s/')
        r.addPatch('latex.conf-newline.patch')

        # loosely based on install.sh included with package
        r.Install('asciidoc.py', '%(bindir)s/asciidoc', mode=0755)
        r.Install('a2x', '%(bindir)s/', mode=0755)
        r.Install('doc/*.1', '%(mandir)s/man1/')
        r.Install('*.conf', '%(sysconfdir)s/asciidoc/')
        r.Symlink('%(datadir)s/asciidoc/stylesheets', '%(sysconfdir)s/asciidoc/')
        r.Install('filters/*.{conf,py}',
                  '%(datadir)s/asciidoc/filters/')
        r.Install('stylesheets', '%(datadir)s/asciidoc/')
        r.Install('javascripts', '%(datadir)s/asciidoc/')
        r.Install('images', '%(datadir)s/asciidoc/')
        # documentation examples have too many symlinks for me to
        # fix up right now for installation into %(thisdocdir)s,
        # so just remove them instead after cherry-picking a few
        # example source files.
        r.Doc('doc/*.{txt,conf}')
        r.Remove('examples', 'doc', 'images', recursive=True)
