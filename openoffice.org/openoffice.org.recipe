#
# Copyright (c) 2004-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadSuperClass('binarypackage=conary.rpath.com@rpl:devel')
class OpenOffice(BinaryPackageRecipe):
    name = 'openoffice.org'
    version = '2.2.0'

    buildRequires = [ 'desktop-file-utils:runtime', 'gtk:runtime', 'perl:lib',
        'shared-mime-info:runtime', 'PyXML:python','python:tk', 'perl:runtime' ]

    def unpack(r):
        # From http://www.openoffice.org
        rpms = [ 'openoffice.org-core01-2.2.0-9134.i586.rpm',
                 'openoffice.org-core02-2.2.0-9134.i586.rpm',
                 'openoffice.org-core03-2.2.0-9134.i586.rpm',
                 'openoffice.org-core03u-2.2.0-9134.i586.rpm',
                 'openoffice.org-core04-2.2.0-9134.i586.rpm',
                 'openoffice.org-core04u-2.2.0-9134.i586.rpm',
                 'openoffice.org-core05-2.2.0-9134.i586.rpm',
                 'openoffice.org-core05u-2.2.0-9134.i586.rpm',
                 'openoffice.org-core06-2.2.0-9134.i586.rpm',
                 'openoffice.org-core07-2.2.0-9134.i586.rpm',
                 'openoffice.org-core08-2.2.0-9134.i586.rpm',
                 'openoffice.org-core09-2.2.0-9134.i586.rpm',
                 'openoffice.org-core10-2.2.0-9134.i586.rpm',
                 'openoffice.org-base-2.2.0-9134.i586.rpm',
                 'openoffice.org-draw-2.2.0-9134.i586.rpm',
                 'openoffice.org-calc-2.2.0-9134.i586.rpm',
                 'openoffice.org-emailmerge-2.2.0-9134.i586.rpm',
                 'openoffice.org-freedesktop-menus-2.2-9119.noarch.rpm',
                 'openoffice.org-gnome-integration-2.2.0-9134.i586.rpm',
                 'openoffice.org-graphicfilter-2.2.0-9134.i586.rpm',
                 'openoffice.org-impress-2.2.0-9134.i586.rpm',
                 'openoffice.org-javafilter-2.2.0-9134.i586.rpm',
                 'openoffice.org-kde-integration-2.2.0-9134.i586.rpm',
                 'openoffice.org-math-2.2.0-9134.i586.rpm',
                 #'openoffice.org-onlineupdate-2.2.0-9134.i586.rpm',
                 'openoffice.org-pyuno-2.2.0-9134.i586.rpm',
                 'openoffice.org-testtool-2.2.0-9134.i586.rpm',
                 'openoffice.org-writer-2.2.0-9134.i586.rpm',
                 'openoffice.org-xsltfilter-2.2.0-9134.i586.rpm',
                 ]

        for rpm in rpms:
            r.addArchive('mirror://rpath/autosource/%s'%rpm, dir='/')

        r.Symlink('/opt/openoffice.org2.2','%(sysconfdir)s/openoffice.org2.2')

        r.Requires(exceptDeps=r'soname\:\ ELF32\/libXaw\.so\.7\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libagg680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libavmedia680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libbasegfx680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libbf\_go680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libbf\_ofa680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libbf\_svx680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libbf\_xo680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libcanvastools680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libcomphelp4gcc3\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libcppcanvas680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libcrypto\.so\.0\.9\.6\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libdb\-3\.1\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libdbtools680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libembobj\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libfile680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libfwe680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libfwi680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libgo680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libhunspell\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libi18nisolang1gcc3\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libi18nregexpgcc3\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libi18nutilgcc3\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libj680li\_g\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libjawt\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libkabc\.so\.1\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libkdecore\.so\.4\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libkdeui\.so\.4\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libkio\.so\.4\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/liblng680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libodbcbase2\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libsb680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libsd680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libsfx680li\.so\(SysV\ x86\)')

        r.Requires(exceptDeps=r'soname\:\ ELF32\/libso680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libsot680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libspa680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libssl\.so\.0\.9\.6\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libstlport\_gcc\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libsvl680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libsvt680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libsvx680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libsw680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libtk680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libtl680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libucbhelper3gcc3\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libutl680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libvcl680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libvclplug\_gen680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libvos3gcc3\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libxcr680li\.so\(SysV\ x86\)')
        r.Requires(exceptDeps=r'soname\:\ ELF32\/libxo680li\.so\(SysV\ x86\)')

        #  upstream RPMs were packaged with foots...

        r.SetModes('/opt',0755)
        r.SetModes('/usr/share',0755)
        r.SetModes('/usr/bin',0755)
        r.SetModes('/usr/share/icons',0755)
        r.SetModes('/usr/share/mime',0755)
        r.SetModes('/usr/share/applications',0755)
        r.SetModes('/usr/share/icons/hicolor',0755)
        r.SetModes('/usr/share/icons/gnome',0755)
        r.SetModes('/usr/share/icons/locolor',0755)
        r.SetModes('/usr/share/icons/hicolor/16x16',0755)
        r.SetModes('/usr/share/icons/hicolor/32x32',0755)
        r.SetModes('/usr/share/icons/hicolor/48x48',0755)
        r.SetModes('/usr/share/icons/hicolor/16x16/apps',0755)
        r.SetModes('/usr/share/icons/hicolor/16x16/mimetypes',0755)
        r.SetModes('/usr/share/icons/hicolor/32x32/apps',0755)
        r.SetModes('/usr/share/icons/hicolor/32x32/mimetypes',0755)
        r.SetModes('/usr/share/icons/hicolor/48x48/apps',0755)
        r.SetModes('/usr/share/icons/hicolor/48x48/mimetypes',0755)
        r.SetModes('/usr/share/icons/gnome/16x16',0755)
        r.SetModes('/usr/share/icons/gnome/32x32',0755)
        r.SetModes('/usr/share/icons/gnome/48x48',0755)
        r.SetModes('/usr/share/icons/gnome/16x16/apps',0755)
        r.SetModes('/usr/share/icons/gnome/16x16/mimetypes',0755)
        r.SetModes('/usr/share/icons/gnome/32x32/apps',0755)
        r.SetModes('/usr/share/icons/gnome/32x32/mimetypes',0755)
        r.SetModes('/usr/share/icons/gnome/48x48/apps',0755)
        r.SetModes('/usr/share/icons/gnome/48x48/mimetypes',0755)
        r.SetModes('/usr/share/icons/locolor/16x16',0755)
        r.SetModes('/usr/share/icons/locolor/32x32',0755)
        r.SetModes('/usr/share/icons/locolor/16x16/apps',0755)
        r.SetModes('/usr/share/icons/locolor/16x16/mimetypes',0755)
        r.SetModes('/usr/share/icons/locolor/32x32/apps',0755)
        r.SetModes('/usr/share/icons/locolor/32x32/mimetypes',0755)
        r.SetModes('/usr/share/mime/packages',0755)

        r.DanglingSymlinks(exceptions='/usr/bin/unopkg_gui')

        r.Requires(exceptDeps=r'java\:\ com\.*')
        r.Requires(exceptDeps=r'java\:\ org\.*')






