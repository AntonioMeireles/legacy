#
# Copyright (c) 2011-2013 Openfiler Ltd
#               2012-2013 The Foresight Linux Project
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#


loadSuperClass('rpmpackage')
class Mcelog(RPMPackageRecipe, CPackageRecipe):
    name = 'mcelog'
    version = '1.0pre3'
    distroVersion = '6Server'
    rpmRelease = '0.2.el6'
    isRHEL = True

    buildRequires = [ 'chkconfig:runtime' ]
 
    def setup(r):
        r.unpack()
        r.addPatch('mcelog-initscript.patch', rpm=r.srpm)
        r.Make()
        r.MakeDirs('%(sysconfdir)s/cron.hourly')
        r.MakeDirs('%(sysconfdir)s/mcelog')
        r.MakeDirs('%(mandir)s/man8')
        r.Install('mcelog','%(sbindir)s/',mode=0755)
        r.Install('mcelog.cron', '%(sysconfdir)s/cron.hourly/mcelog.cron')
        r.Install('mcelog.init', '%(initdir)s/mcelogd', mode=0755)
        r.Install('mcelog.sysconfig', '%(sysconfdir)s/sysconfig/mcelogd')
        r.Install('mcelog.8', '%(mandir)s/man8/')
