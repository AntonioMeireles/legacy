#
# Copyright (c) 2004-2005 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Openh323(CPackageRecipe):
    name = 'openh323'
    version = '1.15.6'

    buildRequires = [ 'expat:devel', 'pkgconfig:devel', 'openldap:devel',
                      'pwlib:devel', 'pwlib:runtime', 'cyrus-sasl:devel',
                      'openssl:devel', 'speex:devel', 'gcc:devel' ]

    def setup(r):
        r.disableParallelMake()
        r.macros.tarversion = r.version.replace('.', '_')

        srpm = 'http://download.fedora.redhat.com/pub/fedora/linux/core/development/SRPMS/openh323-1.15.6-1.src.rpm'
        r.addArchive('openh323-%(version)s.tar.gz', rpm=srpm)
        r.addPatch('gcc4.patch', rpm=srpm)

        r.macros.cflags += ' -I%(includedir)s/speex '
        r.Configure('--enable-localspeex=no --enable-plugins')
        r.Make('optshared OPTCCFLAGS="%(cflags)s"')

        r.MakeInstall()
        r.Doc('ReadMe.txt', 'mpl-1.0.htm')

