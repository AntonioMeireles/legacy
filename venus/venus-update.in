#!/bin/bash

# older (pre-hpa) versions of flock don't create the lock file if it doesn't exist
[ -f /var/lock/venus-update ] || touch /var/lock/venus-update

flock --timeout=1 %(localstatedir)s/lock/venus-update \
    find %(servicedir)s/%(name)s/planets.d -name *.ini -exec \
        python %(servicedir)s/%(name)s/planet.py {} ';'

