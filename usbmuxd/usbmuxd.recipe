#
# Copyright (c) 2010 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Usbmuxd(CPackageRecipe):
    name = 'usbmuxd'
    version = '1.0.4'
 
    buildRequires = ['cmake:runtime', 'libusb1:devel', 'pkgconfig:devel', 'gcc-c++:runtime']
 
    def setup(r):
        r.addArchive('http://marcansoft.com/uploads/usbmuxd/')
        r.Run(""" sed -i.owner 's/ATTR{idVendor}=="05ac"/OWNER="usbmuxd", ATTR{idVendor}=="05ac"/' udev/85-usbmuxd.rules.in """)
        r.Run(""" sed -i.user 's/-U usbmux/-U usbmuxd/' udev/85-usbmuxd.rules.in """)
        r.CMake()
        r.Make()
        r.MakeInstall()

    def policy(r):
        r.Requires("usbmuxd:user", "%(sbindir)s/%(name)s")
