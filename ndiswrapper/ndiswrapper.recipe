loadSuperClass('kernelmodulepackage')
class Ndiswrapper(KernelModulePackageRecipe):

    buildRequires = [ 'perl:lib', 'perl:runtime' ]
    name = 'ndiswrapper'
    version = '1.39'

    def unpack(r):
        r.macros.ksrcdir = '/lib/modules/%(kver)s/build'
        r.addArchive('mirror://sourceforge/%(name)s/')
        r.Replace('.*depmod.*', '', 'driver/Makefile')

    def build(r):
        r.Make('KBUILD=%(ksrcdir)s')

    def install(r):
        r.MakeDirs('%(essentialsbindir)s')
        r.MakeDirs('%(sbindir)s')
        r.MakeDirs('%(mandir)s/man8')
        r.MakeInstall('KBUILD=%(ksrcdir)s')

