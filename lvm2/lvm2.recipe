#
# Copyright (c) 2005-2007 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class LVM2(CPackageRecipe):
    name = 'lvm2'
    version = '2.02.24'

    buildRequires = [ 'device-mapper:devel', 'ncurses:devel', 'readline:devel',
        'userspace-kernel-headers:devel', ]

    def setup(r):
        r.addArchive('ftp://sources.redhat.com/pub/lvm2/old/LVM2.%(version)s.tgz', keyid='567E2C17')

        r.Configure('--enable-static_link --enable-readline'
            ' --with-cluster=internal --with-pool=internal'
            ' --enable-lvm1_fallback --with-staticdir=%(essentialsbindir)s'
            ' --with-user= --with-group=')
        r.Make()
        r.MakeInstall()

        for x in ('lvm', 'pvscan', 'vgchange', 'vgscan'):
            r.Symlink('lvm.static', '%(essentialsbindir)s/' + x)
        r.Doc('VERSION', 'WHATS_NEW')
        r.ComponentProvides('dm-prefix')
