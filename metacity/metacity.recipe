#
# Copyright (c) 2004-2008 rPath, Inc.
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadRecipe('rpmpackage')
loadRecipe('gnomepackage')
class Metacity(RPMPackageRecipe,GnomePackageRecipe):
    buildRequires = [ 'gtk:devel', 'pango:devel', 'fontconfig:devel',
                      'GConf:devel', 'desktop-file-utils:runtime', 'GConf:runtime',
                      'libglade:devel', 'startup-notification:devel', 'intltool:runtime',
                      'ORBit2:devel', 'atk:devel', 'cairo:devel', 'freetype:devel',
                      'glib:devel', 'libpng:devel', 'gettext:runtime', 'perl:runtime',
                      'libXcursor:devel', 'libXfixes:devel', 'libXrandr:devel',
                      'expat:devel', 'libXcomposite:devel', 'libXdamage:devel',
                      'libXinerama:devel', 'gettext:devel', 'libcanberra:devel',
                      'zenity:runtime']

    name = 'metacity'
    version = '2.27.1'
    rpmRelease = '1.fc12'
    rpmPatches = [ # http://bugzilla.gnome.org/show_bug.cgi?id=558723
                   'stop-spamming-xsession-errors.patch',
                   'dnd-keynav.patch',
                   'Should-set-RestartStyleHint-to-RestartIfRunning-when.patch',
                   '0001-bell-increase-bell-rate-limit-from-1-s-to-1-100ms.patch',
                   '0001-sound-ask-libcanberra-to-cache-alert-desktop-switch-.patch',
                   '0001-tooltip-set-window-type-hint-for-self-drawn-tooltips.patch'
                   ]

    docs = ['README', 'AUTHORS', 'COPYING', 'NEWS', 'HACKING',
            'doc/theme-format.txt', 'doc/metacity-theme.dtd']

    def unpack(r):
        RPMPackageRecipe.unpack(r)
        r.Remove('src/metacity.schemas')
        r.Run('autoreconf -if')
        r.addPatch('metacity-2.4.13.90-ctrlaltdel.patch')

        r.addPatch('font.patch')
        r.Replace('Clearlooks','Foresight','src/metacity.schemas*')

