#
# Copyright (c) 2009 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

class Libffi(AutoPackageRecipe):
    name = 'libffi'
    version = '3.0.8'
 
    buildRequires = ['install-info:runtime']
 
    def unpack(r):
        r.addArchive('ftp://sourceware.org/pub/%(name)s/')
	r.addPatch('libdir.patch')

    def configure(r):
        r.Configure('--disable-static')

    def policy(r):
        # gcc-4.1.x had this builtin
        # so we mv libs around ...
        r.Move('%(libdir)s/*.so*','%(libdir)s/%(name)s-%(version)s/lib/')
        # ... and then we make sure they get picked 
        r.Create('%(sysconfdir)s/ld.so.conf.d/%(name)s-%(target)s.conf', mode = 0644, 
                 contents = '%(libdir)s/%(name)s-%(version)s/lib/')
        
