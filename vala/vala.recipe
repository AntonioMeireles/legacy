# Copyright (c) 2007-2009 Foresight Linux
# This file is distributed under the terms of the MIT License.
# A copy is available at http://www.rpath.com/permanent/mit-license.html
#

loadRecipe('gnomepackage')
class Vala(GnomePackageRecipe):
    name = 'vala'
    version = '0.7.5'
    buildRequires = ['flex:runtime', 'glib:devel', 'pkgconfig:devel',
                     'bison:runtime']

    # FIXME - does  --enable-gen-project add value ?
    extraConfig = ' --enable-vapigen --enable-gen-project  '


    def build(r):
        r.Configure(r.extraConfig,
                    configureName = r.configureName,
                    preConfigure = r.preConfigure)
        # Don't use rpath!
        r.Replace(('^hardcode_libdir_flag_spec=.*',
                   'hardcode_libdir_flag_spec=""'),
                  ('^runpath_var=LD_RUN_PATH',
                   'runpath_var=DIE_RPATH_DIE'),
                  'libtool')
        r.Make(r.makeArgs, preMake=r.preMake)
        # FIXME - consider to add/pkgSpec emacs modes (as RH)
        # will add reliance on emacs
